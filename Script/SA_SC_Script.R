library(sf)
library(readr)
library(tidyverse)
library(hydroGOF)
library(lubridate)
library(gt)
library(patchwork)

rsq_r2 <-  function(x, y , na.rm = TRUE) cor(x, y, use="complete.obs")^2  # Function to calculate coefficient of determination



# This script might serve as example of how the work has been done.
# The raw simulations can be found in a ZENODO Repository: 

## LINK TO THE LATEST VERSION IN THE README FILE ##

# Processed data can be found in the Data folder of the repository



#### 1 MODEL GEOLOGICAL ZONIFICATION #####

#### 1.1. Preparation for model zonification Defining the dominant geology for each LSU   ####

# Steps:

# 1. Creating a raster with the classes of lithology of the basin. 
# 4 classes +  water. 

# 2. Using the Zonal histogram tool (Raster analysis, QGIS) to evaluate the area of each lithology class within each LSUs. 
# Save results as csv file

lsus_lith_zonalhist <- read_csv("Data/lsus_lithology_spatial_analysis/zonal_histogram_LSUs_lithology.csv")

# Taking the following columns: lsu_id, area and the number of pixels for each lithology classes
# Class 1 (HISTO_1) --> IMP     Class 2 -->  CRB   Class 3 -->  DTH    Class 4 --> DTL
# HISTO_10 --> Water. HISTO_NODATA --> Unfortunately the used lithology map does not exactly match with the delineated basin.
# Water and No_data will not be taken into account to determine the main lithology for each LSU

# Creating a table that contains the dominant lithology for each LSU
lsus_lit_table <- lsus_lith_zonalhist %>% select(LSUID, HISTO_1, HISTO_2, HISTO_3, HISTO_4) %>% 
  arrange(., LSUID) %>% mutate(lsu_id = seq(1:length(lsus_lith_zonalhist$LSUID))) %>% 
  pivot_longer(., -c(lsu_id, LSUID)) %>% 
  filter(., value != 0)  %>%
  mutate(region = case_when(name == "HISTO_1" ~ "IMP",
                            name == "HISTO_2" ~ "CRB",
                            name == "HISTO_3" ~ "DTH",
                            name == "HISTO_4" ~ "DTL")) %>%
  group_by(., LSUID) %>% filter(., value == max(value))

# Some of the HRUs (7) has the same number of pixels of 2 lithologies (number LSUs --> 1450, length table --> 1453)
# Let see which are those cases

lsus_dupli_evaluation <- ungroup(lsus_lit_table) %>% mutate(row_number = seq(1, length(lsus_lit_table$name),1))

dupli <- duplicated(lsus_dupli_evaluation$lsu_id)

dup_rows <- lsus_dupli_evaluation[dupli,6]
dup_rows_init <- lsus_dupli_evaluation[dup_rows$row_number-1,6]

duplicated_cases <- lsus_dupli_evaluation[c(dup_rows$row_number, dup_rows_init$row_number),] %>% arrange(., LSUID, row_number)


# One of the lithologies will be preserved, the one with more influence in the water balance. Based on previous studies, 
# a IMP or CRB lithology will be preserved against a DTH or DTL one, and a DTL permeability will be preserved against a DTH one.
# Taking into account the number of repeated cases (7 of 1450), this gross modification can be assumed.

dupli <- duplicated(lsus_dupli_evaluation$lsu_id)

# Take the unique values od LSUID
final_lsu_tb <- ungroup(lsus_lit_table) %>% .[!dupli,]

# Adjusting those where the lithology group must be changed according to the criteria
final_lsu_tb[c(740),]$region <- "DTL"
final_lsu_tb[c(850),]$region <- "DTL"
final_lsu_tb[c(1114),]$region <- "DTL"

join_lsu_lith_tab <- final_lsu_tb[, c("LSUID", "lsu_id", "region")]

# Joining this information with the LSUS shapefile

lsus_shp <- read_sf("Data/lsus_lithology_spatial_analysis/lsus2.shp") %>% select(Area, Channel, LSUID, Subbasin) 

lsus_shp <- lsus_shp %>% left_join(., join_lsu_lith_tab, by  = "LSUID")

# Representing the spatial configuration performed
modeled_basin <- read_sf("Data/lsus_lithology_spatial_analysis/modeled_basin.shp")
lsus_shp <- lsus_shp %>% mutate(region = factor(region, levels = c("IMP", "CRB", "DTH", "DTL")))  %>% arrange(., lsu_id)


ggplot()+geom_sf(data = modeled_basin, fill = "black")+
  geom_sf(data = lsus_shp, aes( fill = region))+
  scale_fill_manual(values = c("red", "blue", "orange", "grey"))

# Save this shapefile and create a csv for following steps

#  sf::st_write(obj = lsus_shp, dsn = "Data/lsus_lithology_spatial_analysis/lsus_lithology_configuration.shp", driver="ESRI Shapefile")

# read_sf( "Data/lsus_lithology_spatial_analysis/lsus_lithology_configuration.shp") %>% st_drop_geometry() %>% 
#   write.csv(., "Data/csv_files/lsus_configuration.csv", quote = F)



#### 1.2. Preparation for model zonification: Defining the hrus for each of the regions####
# In order to parameterize the HRUs at region scale, it is neccessary to determine 
# which HRUs are within each of the geological zone

lsus_conf <-  read_sf("Data/lsus_lithology_spatial_analysis/lsus_lithology_configuration.shp") %>%
  st_drop_geometry(.) %>% arrange(., lsu_id)
# with the geological region for each LSU
lsus_def <-  read_table("Data/TxtInOut_data/ls_unit.def", skip = 2) # File with the hrus within each LSU    

lsus_id_reg <-  select(lsus_conf, lsu_id, region, Area) %>% mutate(id = lsu_id) %>% .[,c(4,2:3)]

hrus_lsus <- select(lsus_def, id, elements, X6) # Elements and X6 columns are the HRUs that each LSU contain (from element to X6)


lsus_hrus_def <- left_join(hrus_lsus, lsus_id_reg, "id") %>% .[,c(1,4,2,3)] %>% 
  mutate(hrus = paste(as.character(hrus_lsus$elements), as.character(hrus_lsus$X6), sep = ":") %>% str_remove(., "-") %>% str_remove(., ":NA")) %>% 
  .[,c(1:2,5)]


#For creating a tibble with the parameterization, a simplification of the hru lists should be done, as the tibble function has a length limit
# For this purpose, the next loop group the hrus of the contiguous lsus


lsus_hrus_def$region <- factor(lsus_hrus_def$region, levels = c("IMP", "CRB", "DTH", "DTL")) #Factor with the different geological groups
hrus_reg <- list()

for(lev in 1:length(levels(lsus_hrus_def$region))){
  
  lsus_order <-  lsus_hrus_def %>% filter(region == levels(lsus_hrus_def$region)[lev]) %>% separate(., hrus, into = c("ini", "end"),sep = ":") %>% 
    mutate(ini = as.numeric(ini), end = as.numeric(end)) %>% arrange(., ini)   #preparing the hru ids for each LSU
  NAS <- is.na(lsus_order$end)     #Some of them only have 1 hru
  lsus_order[NAS,4] <- lsus_order[NAS,3]
  
  # First part : check contiguous lsus at the beggining and end of the list
  r <- 0 # number of contiguous lsus at the beginning
  q <- 0 # number of contiguous lsus at the end
  g <- 1 # compensation if q = 0 (look below) 
  
  for(i in 1:length(lsus_order$id)){
    if(i == 1){
      while(lsus_order$end[i+r]+1 == lsus_order$ini[i+1+r]){
        r <-  r+1}
    }
    if(i == length(lsus_order$id)){
      while(lsus_order$ini[i-q]-1 == lsus_order$end[i-1-q]){
        q <- q+1 
        g <- 0}
    }
    else{}
  }
  # First and last simplificated hrus
  nni <- paste(lsus_order$ini[1], lsus_order$end[1+r], sep = ":")
  nnend <- paste(lsus_order$ini[length(lsus_order$id)-q], lsus_order$end[length(lsus_order$id)], sep = ":")
  # Second part: for the rest of the list of lsus-hrus, excluding the first and last items (with r and q)
  n <- 0
  nns <- c()
  is <- c()
  for(i in (2+r):(length(lsus_order$id)-(1*g+q))){ # If q = 0, g = 1, avoiding an error in next line when i = length(lsus_order$id)
    if(lsus_order$ini[i+1] == (lsus_order$end[i]+1)){
      n <- n+1
      i <- i+1
    }
    else{
      nn <- paste(lsus_order$ini[i-(n)], lsus_order$end[i], sep = ":")
      n <- 0 
      nns <- c(nns, nn)
    }
  }
  
  hrus_reg[[lev]] <- c(nni, nns, nnend)
}
names(hrus_reg) <- levels(lsus_hrus_def$region)


#In the hrus_reg list, a list for each region contains the different hrus grouped


hrus_characters <- list()
for(n in 1:length(hrus_reg)){
  combs <- c()
  for(i in 1:length(hrus_reg[[n]])){
    comb <- paste(hrus_reg[[n]][i])
    combs <- paste(combs, comb, sep = ",")
  }
  hrus_characters[[n]] <- combs
}
names(hrus_characters) <- levels(lsus_hrus_def$region)


# The list "hrus_characters" contains for each geological region all the hrus that are located within it. Easily, 
#its content can be copy-paste into the tibble function to create the different parameters sets


#### 2. PARAMETERS SETS ####

#### 2.1. Creating parameters sets for SOFT CALIBRATION ####

library(lhs)
library(purrr)
library(tibble)


#Parameters ranges for the first round
par_bound_zonal <- tibble(
  'IMP_esc::esco.hru | change = absval | unit =    c(53:67,97:229,432:466,493:537,600:606,626:676,697:716,757:770,1277:1414,1421:1428,1446:1454,1459:1478,1529:1532,1789:1876,2059:2339,2347:2352,2361:2384,3299:3459,5420:5443,5900:5950,5963:5976,5991:6086,7311:7366,7375:7449,7458:7530,8425:8494,8507:8533,8537:8557,9233:9368,9687:9817,10017:10147,11027:11069,11085:11100,11115:11122,11135:11141,11338:11483,11847:12117,12275:12446,13061:13125,13154:13188,15748:15772,15795:15818,15835:15847,15877:15913,15962:15972,16484:16514,17368:17399,17523:17629,17693:17721,18613:18639,19239:19254,19574:19588,19593:19638,19794:19853,19876:19918,19975:20043,20073:20191,20344:20666,20850:21100,21168:21202,21313:21322,21338:21353,21390:21441,21462:21479,21925:21955,21989:22001,22006:22044,22069:22089)' = c(0.001 , 0.999),       # 'IMP_esc::esco.hru | change = absval             
  'IMP_epc::epco.hru | change = absval | unit =    c(53:67,97:229,432:466,493:537,600:606,626:676,697:716,757:770,1277:1414,1421:1428,1446:1454,1459:1478,1529:1532,1789:1876,2059:2339,2347:2352,2361:2384,3299:3459,5420:5443,5900:5950,5963:5976,5991:6086,7311:7366,7375:7449,7458:7530,8425:8494,8507:8533,8537:8557,9233:9368,9687:9817,10017:10147,11027:11069,11085:11100,11115:11122,11135:11141,11338:11483,11847:12117,12275:12446,13061:13125,13154:13188,15748:15772,15795:15818,15835:15847,15877:15913,15962:15972,16484:16514,17368:17399,17523:17629,17693:17721,18613:18639,19239:19254,19574:19588,19593:19638,19794:19853,19876:19918,19975:20043,20073:20191,20344:20666,20850:21100,21168:21202,21313:21322,21338:21353,21390:21441,21462:21479,21925:21955,21989:22001,22006:22044,22069:22089)' = c(0.001 , 0.999),       # 'IMP_epc::epco.hru | change = absval  
  'IMP_cnn::cn2.hru | change = pctchg | unit =     c(53:67,97:229,432:466,493:537,600:606,626:676,697:716,757:770,1277:1414,1421:1428,1446:1454,1459:1478,1529:1532,1789:1876,2059:2339,2347:2352,2361:2384,3299:3459,5420:5443,5900:5950,5963:5976,5991:6086,7311:7366,7375:7449,7458:7530,8425:8494,8507:8533,8537:8557,9233:9368,9687:9817,10017:10147,11027:11069,11085:11100,11115:11122,11135:11141,11338:11483,11847:12117,12275:12446,13061:13125,13154:13188,15748:15772,15795:15818,15835:15847,15877:15913,15962:15972,16484:16514,17368:17399,17523:17629,17693:17721,18613:18639,19239:19254,19574:19588,19593:19638,19794:19853,19876:19918,19975:20043,20073:20191,20344:20666,20850:21100,21168:21202,21313:21322,21338:21353,21390:21441,21462:21479,21925:21955,21989:22001,22006:22044,22069:22089)' = c(-29.999  ,  29.999),  # 'IMP_cnn::cn2.hru | change = pctchg     
  'IMP_awc::awc.sol | change = pctchg | unit =     c(53:67,97:229,432:466,493:537,600:606,626:676,697:716,757:770,1277:1414,1421:1428,1446:1454,1459:1478,1529:1532,1789:1876,2059:2339,2347:2352,2361:2384,3299:3459,5420:5443,5900:5950,5963:5976,5991:6086,7311:7366,7375:7449,7458:7530,8425:8494,8507:8533,8537:8557,9233:9368,9687:9817,10017:10147,11027:11069,11085:11100,11115:11122,11135:11141,11338:11483,11847:12117,12275:12446,13061:13125,13154:13188,15748:15772,15795:15818,15835:15847,15877:15913,15962:15972,16484:16514,17368:17399,17523:17629,17693:17721,18613:18639,19239:19254,19574:19588,19593:19638,19794:19853,19876:19918,19975:20043,20073:20191,20344:20666,20850:21100,21168:21202,21313:21322,21338:21353,21390:21441,21462:21479,21925:21955,21989:22001,22006:22044,22069:22089)' = c(-59.999 , 59.999),    # 'IMP_awc::awc.sol | change = pctchg    
  'IMP_per::perco.hru | change = absval | unit =   c(53:67,97:229,432:466,493:537,600:606,626:676,697:716,757:770,1277:1414,1421:1428,1446:1454,1459:1478,1529:1532,1789:1876,2059:2339,2347:2352,2361:2384,3299:3459,5420:5443,5900:5950,5963:5976,5991:6086,7311:7366,7375:7449,7458:7530,8425:8494,8507:8533,8537:8557,9233:9368,9687:9817,10017:10147,11027:11069,11085:11100,11115:11122,11135:11141,11338:11483,11847:12117,12275:12446,13061:13125,13154:13188,15748:15772,15795:15818,15835:15847,15877:15913,15962:15972,16484:16514,17368:17399,17523:17629,17693:17721,18613:18639,19239:19254,19574:19588,19593:19638,19794:19853,19876:19918,19975:20043,20073:20191,20344:20666,20850:21100,21168:21202,21313:21322,21338:21353,21390:21441,21462:21479,21925:21955,21989:22001,22006:22044,22069:22089)' = c(0.001 , 0.4),         # 'IMP_per::perco.hru | change = absval   
  'IMP_latq::latq_co.hru | change = abschg | unit =   c(53:67,97:229,432:466,493:537,600:606,626:676,697:716,757:770,1277:1414,1421:1428,1446:1454,1459:1478,1529:1532,1789:1876,2059:2339,2347:2352,2361:2384,3299:3459,5420:5443,5900:5950,5963:5976,5991:6086,7311:7366,7375:7449,7458:7530,8425:8494,8507:8533,8537:8557,9233:9368,9687:9817,10017:10147,11027:11069,11085:11100,11115:11122,11135:11141,11338:11483,11847:12117,12275:12446,13061:13125,13154:13188,15748:15772,15795:15818,15835:15847,15877:15913,15962:15972,16484:16514,17368:17399,17523:17629,17693:17721,18613:18639,19239:19254,19574:19588,19593:19638,19794:19853,19876:19918,19975:20043,20073:20191,20344:20666,20850:21100,21168:21202,21313:21322,21338:21353,21390:21441,21462:21479,21925:21955,21989:22001,22006:22044,22069:22089)' = c(-0.5, 0.5),        # 'IMP_latq::latq_co.hru | change = abschg  
  'IMP_cn3::cn3_swf.hru | change = abschg | unit = c(53:67,97:229,432:466,493:537,600:606,626:676,697:716,757:770,1277:1414,1421:1428,1446:1454,1459:1478,1529:1532,1789:1876,2059:2339,2347:2352,2361:2384,3299:3459,5420:5443,5900:5950,5963:5976,5991:6086,7311:7366,7375:7449,7458:7530,8425:8494,8507:8533,8537:8557,9233:9368,9687:9817,10017:10147,11027:11069,11085:11100,11115:11122,11135:11141,11338:11483,11847:12117,12275:12446,13061:13125,13154:13188,15748:15772,15795:15818,15835:15847,15877:15913,15962:15972,16484:16514,17368:17399,17523:17629,17693:17721,18613:18639,19239:19254,19574:19588,19593:19638,19794:19853,19876:19918,19975:20043,20073:20191,20344:20666,20850:21100,21168:21202,21313:21322,21338:21353,21390:21441,21462:21479,21925:21955,21989:22001,22006:22044,22069:22089)' = c(-0.5, 0.5),           # 'IMP_cn3::cn3_swf.hru | change = abschg        
  'IMP_zso::z.sol | change = pctchg | unit =       c(53:67,97:229,432:466,493:537,600:606,626:676,697:716,757:770,1277:1414,1421:1428,1446:1454,1459:1478,1529:1532,1789:1876,2059:2339,2347:2352,2361:2384,3299:3459,5420:5443,5900:5950,5963:5976,5991:6086,7311:7366,7375:7449,7458:7530,8425:8494,8507:8533,8537:8557,9233:9368,9687:9817,10017:10147,11027:11069,11085:11100,11115:11122,11135:11141,11338:11483,11847:12117,12275:12446,13061:13125,13154:13188,15748:15772,15795:15818,15835:15847,15877:15913,15962:15972,16484:16514,17368:17399,17523:17629,17693:17721,18613:18639,19239:19254,19574:19588,19593:19638,19794:19853,19876:19918,19975:20043,20073:20191,20344:20666,20850:21100,21168:21202,21313:21322,21338:21353,21390:21441,21462:21479,21925:21955,21989:22001,22006:22044,22069:22089)' = c(-49.999 , 49.999),    # 'IMP_zso::z.sol | change = pctchg 
  'IMP_kso::k.sol | change = pctchg | unit =       c(53:67,97:229,432:466,493:537,600:606,626:676,697:716,757:770,1277:1414,1421:1428,1446:1454,1459:1478,1529:1532,1789:1876,2059:2339,2347:2352,2361:2384,3299:3459,5420:5443,5900:5950,5963:5976,5991:6086,7311:7366,7375:7449,7458:7530,8425:8494,8507:8533,8537:8557,9233:9368,9687:9817,10017:10147,11027:11069,11085:11100,11115:11122,11135:11141,11338:11483,11847:12117,12275:12446,13061:13125,13154:13188,15748:15772,15795:15818,15835:15847,15877:15913,15962:15972,16484:16514,17368:17399,17523:17629,17693:17721,18613:18639,19239:19254,19574:19588,19593:19638,19794:19853,19876:19918,19975:20043,20073:20191,20344:20666,20850:21100,21168:21202,21313:21322,21338:21353,21390:21441,21462:21479,21925:21955,21989:22001,22006:22044,22069:22089)' = c(-79.999 , 199.999),   # 'IMP_kso::k.sol | change = pctchg 
  'IMP_bd::bd.sol | change = pctchg | unit =       c(53:67,97:229,432:466,493:537,600:606,626:676,697:716,757:770,1277:1414,1421:1428,1446:1454,1459:1478,1529:1532,1789:1876,2059:2339,2347:2352,2361:2384,3299:3459,5420:5443,5900:5950,5963:5976,5991:6086,7311:7366,7375:7449,7458:7530,8425:8494,8507:8533,8537:8557,9233:9368,9687:9817,10017:10147,11027:11069,11085:11100,11115:11122,11135:11141,11338:11483,11847:12117,12275:12446,13061:13125,13154:13188,15748:15772,15795:15818,15835:15847,15877:15913,15962:15972,16484:16514,17368:17399,17523:17629,17693:17721,18613:18639,19239:19254,19574:19588,19593:19638,19794:19853,19876:19918,19975:20043,20073:20191,20344:20666,20850:21100,21168:21202,21313:21322,21338:21353,21390:21441,21462:21479,21925:21955,21989:22001,22006:22044,22069:22089)' = c(-29.999 , 29.999),    # 'IMP_bd::bd.sol | change = pctchg 
  
  
  'CRB_esc::esco.hru | change = absval | unit =    c(1:6,43:52,68:96,364:382,615:625,771:776,858:887,1052:1059,1092:1099,1120:1136,1181:1199,1217:1276,1429:1445,1653:1714,1745:1749,1905:2007,2042:2058,2413:2442,2553:2623,2662:2691,2716:2900,2917:2936,2970:2999,3019:3054,3077:3078,3217:3263,3880:3934,3977:4080,4164:4256,4402:4433,4538:4634,4662:4747,4773:4786,4793:4832,5795:5845,6164:6238,6441:6453,6460:6504,6531:6566,6584:6647,6680:6706,6733:6779,6846:6895,6916:6976,6998:7008,7035:7039,7133:7136,7190:7310,7854:7862,8118:8192,8248:8258,8273:8424,8683:8713,8730:8777,9058:9232,9369:9461,9469:9488,9493:9504,9509:9539,9556:9603,10193:10275,10302:10314,10328:10353,10368:10392,10405:10496,10511:10653,10733:10765,10873:10899,10992:11026,11305:11337,11697:11721,11819:11846,12118:12122,12197:12210,12263:12274,12481:12483,12504:12510,13189:13208,13223:13237,13494:13501,13655:13667,13971:13985,14329:14346,14709:14722,14743:14769,14810:14826,14888:14901,14953:14991,15007:15059,15136:15142,15202:15220,17246:17279,17310:17343,17437:17454,18123:18142,18218:18233,18514:18535,18896:18910,19255:19276,19395:19405,20218:20245,20749:20758,20840:20849,21209:21213,21226:21235)' = c(0.001 , 0.999),        # CRB_esc::esco.hru | change = absval           
  'CRB_epc::epco.hru | change = absval | unit =    c(1:6,43:52,68:96,364:382,615:625,771:776,858:887,1052:1059,1092:1099,1120:1136,1181:1199,1217:1276,1429:1445,1653:1714,1745:1749,1905:2007,2042:2058,2413:2442,2553:2623,2662:2691,2716:2900,2917:2936,2970:2999,3019:3054,3077:3078,3217:3263,3880:3934,3977:4080,4164:4256,4402:4433,4538:4634,4662:4747,4773:4786,4793:4832,5795:5845,6164:6238,6441:6453,6460:6504,6531:6566,6584:6647,6680:6706,6733:6779,6846:6895,6916:6976,6998:7008,7035:7039,7133:7136,7190:7310,7854:7862,8118:8192,8248:8258,8273:8424,8683:8713,8730:8777,9058:9232,9369:9461,9469:9488,9493:9504,9509:9539,9556:9603,10193:10275,10302:10314,10328:10353,10368:10392,10405:10496,10511:10653,10733:10765,10873:10899,10992:11026,11305:11337,11697:11721,11819:11846,12118:12122,12197:12210,12263:12274,12481:12483,12504:12510,13189:13208,13223:13237,13494:13501,13655:13667,13971:13985,14329:14346,14709:14722,14743:14769,14810:14826,14888:14901,14953:14991,15007:15059,15136:15142,15202:15220,17246:17279,17310:17343,17437:17454,18123:18142,18218:18233,18514:18535,18896:18910,19255:19276,19395:19405,20218:20245,20749:20758,20840:20849,21209:21213,21226:21235)' = c(0.001 , 0.999),        # CRB_epc::epco.hru | change = absval   
  'CRB_cnn::cn2.hru | change = pctchg | unit =     c(1:6,43:52,68:96,364:382,615:625,771:776,858:887,1052:1059,1092:1099,1120:1136,1181:1199,1217:1276,1429:1445,1653:1714,1745:1749,1905:2007,2042:2058,2413:2442,2553:2623,2662:2691,2716:2900,2917:2936,2970:2999,3019:3054,3077:3078,3217:3263,3880:3934,3977:4080,4164:4256,4402:4433,4538:4634,4662:4747,4773:4786,4793:4832,5795:5845,6164:6238,6441:6453,6460:6504,6531:6566,6584:6647,6680:6706,6733:6779,6846:6895,6916:6976,6998:7008,7035:7039,7133:7136,7190:7310,7854:7862,8118:8192,8248:8258,8273:8424,8683:8713,8730:8777,9058:9232,9369:9461,9469:9488,9493:9504,9509:9539,9556:9603,10193:10275,10302:10314,10328:10353,10368:10392,10405:10496,10511:10653,10733:10765,10873:10899,10992:11026,11305:11337,11697:11721,11819:11846,12118:12122,12197:12210,12263:12274,12481:12483,12504:12510,13189:13208,13223:13237,13494:13501,13655:13667,13971:13985,14329:14346,14709:14722,14743:14769,14810:14826,14888:14901,14953:14991,15007:15059,15136:15142,15202:15220,17246:17279,17310:17343,17437:17454,18123:18142,18218:18233,18514:18535,18896:18910,19255:19276,19395:19405,20218:20245,20749:20758,20840:20849,21209:21213,21226:21235)' = c(-29.999  ,  29.999),   # CRB_cnn::cn2.hru | change = pctchg           
  'CRB_awc::awc.sol | change = pctchg | unit =     c(1:6,43:52,68:96,364:382,615:625,771:776,858:887,1052:1059,1092:1099,1120:1136,1181:1199,1217:1276,1429:1445,1653:1714,1745:1749,1905:2007,2042:2058,2413:2442,2553:2623,2662:2691,2716:2900,2917:2936,2970:2999,3019:3054,3077:3078,3217:3263,3880:3934,3977:4080,4164:4256,4402:4433,4538:4634,4662:4747,4773:4786,4793:4832,5795:5845,6164:6238,6441:6453,6460:6504,6531:6566,6584:6647,6680:6706,6733:6779,6846:6895,6916:6976,6998:7008,7035:7039,7133:7136,7190:7310,7854:7862,8118:8192,8248:8258,8273:8424,8683:8713,8730:8777,9058:9232,9369:9461,9469:9488,9493:9504,9509:9539,9556:9603,10193:10275,10302:10314,10328:10353,10368:10392,10405:10496,10511:10653,10733:10765,10873:10899,10992:11026,11305:11337,11697:11721,11819:11846,12118:12122,12197:12210,12263:12274,12481:12483,12504:12510,13189:13208,13223:13237,13494:13501,13655:13667,13971:13985,14329:14346,14709:14722,14743:14769,14810:14826,14888:14901,14953:14991,15007:15059,15136:15142,15202:15220,17246:17279,17310:17343,17437:17454,18123:18142,18218:18233,18514:18535,18896:18910,19255:19276,19395:19405,20218:20245,20749:20758,20840:20849,21209:21213,21226:21235)' = c(-59.999 , 59.999),     # CRB_awc::awc.sol | change = pctchg       
  'CRB_per::perco.hru | change = absval | unit =   c(1:6,43:52,68:96,364:382,615:625,771:776,858:887,1052:1059,1092:1099,1120:1136,1181:1199,1217:1276,1429:1445,1653:1714,1745:1749,1905:2007,2042:2058,2413:2442,2553:2623,2662:2691,2716:2900,2917:2936,2970:2999,3019:3054,3077:3078,3217:3263,3880:3934,3977:4080,4164:4256,4402:4433,4538:4634,4662:4747,4773:4786,4793:4832,5795:5845,6164:6238,6441:6453,6460:6504,6531:6566,6584:6647,6680:6706,6733:6779,6846:6895,6916:6976,6998:7008,7035:7039,7133:7136,7190:7310,7854:7862,8118:8192,8248:8258,8273:8424,8683:8713,8730:8777,9058:9232,9369:9461,9469:9488,9493:9504,9509:9539,9556:9603,10193:10275,10302:10314,10328:10353,10368:10392,10405:10496,10511:10653,10733:10765,10873:10899,10992:11026,11305:11337,11697:11721,11819:11846,12118:12122,12197:12210,12263:12274,12481:12483,12504:12510,13189:13208,13223:13237,13494:13501,13655:13667,13971:13985,14329:14346,14709:14722,14743:14769,14810:14826,14888:14901,14953:14991,15007:15059,15136:15142,15202:15220,17246:17279,17310:17343,17437:17454,18123:18142,18218:18233,18514:18535,18896:18910,19255:19276,19395:19405,20218:20245,20749:20758,20840:20849,21209:21213,21226:21235)' = c(0.2 , 0.999),          # CRB_per::perco.hru | change = absval
  'CRB_latq::latq_co.hru | change = abschg | unit =   c(1:6,43:52,68:96,364:382,615:625,771:776,858:887,1052:1059,1092:1099,1120:1136,1181:1199,1217:1276,1429:1445,1653:1714,1745:1749,1905:2007,2042:2058,2413:2442,2553:2623,2662:2691,2716:2900,2917:2936,2970:2999,3019:3054,3077:3078,3217:3263,3880:3934,3977:4080,4164:4256,4402:4433,4538:4634,4662:4747,4773:4786,4793:4832,5795:5845,6164:6238,6441:6453,6460:6504,6531:6566,6584:6647,6680:6706,6733:6779,6846:6895,6916:6976,6998:7008,7035:7039,7133:7136,7190:7310,7854:7862,8118:8192,8248:8258,8273:8424,8683:8713,8730:8777,9058:9232,9369:9461,9469:9488,9493:9504,9509:9539,9556:9603,10193:10275,10302:10314,10328:10353,10368:10392,10405:10496,10511:10653,10733:10765,10873:10899,10992:11026,11305:11337,11697:11721,11819:11846,12118:12122,12197:12210,12263:12274,12481:12483,12504:12510,13189:13208,13223:13237,13494:13501,13655:13667,13971:13985,14329:14346,14709:14722,14743:14769,14810:14826,14888:14901,14953:14991,15007:15059,15136:15142,15202:15220,17246:17279,17310:17343,17437:17454,18123:18142,18218:18233,18514:18535,18896:18910,19255:19276,19395:19405,20218:20245,20749:20758,20840:20849,21209:21213,21226:21235)' = c(-0.5, 0.5),         # CRB_latq::latq_co.hru | change = abschg    
  'CRB_cn3::cn3_swf.hru | change = abschg | unit = c(1:6,43:52,68:96,364:382,615:625,771:776,858:887,1052:1059,1092:1099,1120:1136,1181:1199,1217:1276,1429:1445,1653:1714,1745:1749,1905:2007,2042:2058,2413:2442,2553:2623,2662:2691,2716:2900,2917:2936,2970:2999,3019:3054,3077:3078,3217:3263,3880:3934,3977:4080,4164:4256,4402:4433,4538:4634,4662:4747,4773:4786,4793:4832,5795:5845,6164:6238,6441:6453,6460:6504,6531:6566,6584:6647,6680:6706,6733:6779,6846:6895,6916:6976,6998:7008,7035:7039,7133:7136,7190:7310,7854:7862,8118:8192,8248:8258,8273:8424,8683:8713,8730:8777,9058:9232,9369:9461,9469:9488,9493:9504,9509:9539,9556:9603,10193:10275,10302:10314,10328:10353,10368:10392,10405:10496,10511:10653,10733:10765,10873:10899,10992:11026,11305:11337,11697:11721,11819:11846,12118:12122,12197:12210,12263:12274,12481:12483,12504:12510,13189:13208,13223:13237,13494:13501,13655:13667,13971:13985,14329:14346,14709:14722,14743:14769,14810:14826,14888:14901,14953:14991,15007:15059,15136:15142,15202:15220,17246:17279,17310:17343,17437:17454,18123:18142,18218:18233,18514:18535,18896:18910,19255:19276,19395:19405,20218:20245,20749:20758,20840:20849,21209:21213,21226:21235)' = c(-0.5, 0.5),            # CRB_cn3::cn3_swf.hru | change = abschg         
  'CRB_zso::z.sol | change = pctchg | unit =       c(1:6,43:52,68:96,364:382,615:625,771:776,858:887,1052:1059,1092:1099,1120:1136,1181:1199,1217:1276,1429:1445,1653:1714,1745:1749,1905:2007,2042:2058,2413:2442,2553:2623,2662:2691,2716:2900,2917:2936,2970:2999,3019:3054,3077:3078,3217:3263,3880:3934,3977:4080,4164:4256,4402:4433,4538:4634,4662:4747,4773:4786,4793:4832,5795:5845,6164:6238,6441:6453,6460:6504,6531:6566,6584:6647,6680:6706,6733:6779,6846:6895,6916:6976,6998:7008,7035:7039,7133:7136,7190:7310,7854:7862,8118:8192,8248:8258,8273:8424,8683:8713,8730:8777,9058:9232,9369:9461,9469:9488,9493:9504,9509:9539,9556:9603,10193:10275,10302:10314,10328:10353,10368:10392,10405:10496,10511:10653,10733:10765,10873:10899,10992:11026,11305:11337,11697:11721,11819:11846,12118:12122,12197:12210,12263:12274,12481:12483,12504:12510,13189:13208,13223:13237,13494:13501,13655:13667,13971:13985,14329:14346,14709:14722,14743:14769,14810:14826,14888:14901,14953:14991,15007:15059,15136:15142,15202:15220,17246:17279,17310:17343,17437:17454,18123:18142,18218:18233,18514:18535,18896:18910,19255:19276,19395:19405,20218:20245,20749:20758,20840:20849,21209:21213,21226:21235)' = c(-49.999 , 49.999),     # CRB_zso::z.sol | change = pctchg       
  'CRB_kso::k.sol | change = pctchg | unit =       c(1:6,43:52,68:96,364:382,615:625,771:776,858:887,1052:1059,1092:1099,1120:1136,1181:1199,1217:1276,1429:1445,1653:1714,1745:1749,1905:2007,2042:2058,2413:2442,2553:2623,2662:2691,2716:2900,2917:2936,2970:2999,3019:3054,3077:3078,3217:3263,3880:3934,3977:4080,4164:4256,4402:4433,4538:4634,4662:4747,4773:4786,4793:4832,5795:5845,6164:6238,6441:6453,6460:6504,6531:6566,6584:6647,6680:6706,6733:6779,6846:6895,6916:6976,6998:7008,7035:7039,7133:7136,7190:7310,7854:7862,8118:8192,8248:8258,8273:8424,8683:8713,8730:8777,9058:9232,9369:9461,9469:9488,9493:9504,9509:9539,9556:9603,10193:10275,10302:10314,10328:10353,10368:10392,10405:10496,10511:10653,10733:10765,10873:10899,10992:11026,11305:11337,11697:11721,11819:11846,12118:12122,12197:12210,12263:12274,12481:12483,12504:12510,13189:13208,13223:13237,13494:13501,13655:13667,13971:13985,14329:14346,14709:14722,14743:14769,14810:14826,14888:14901,14953:14991,15007:15059,15136:15142,15202:15220,17246:17279,17310:17343,17437:17454,18123:18142,18218:18233,18514:18535,18896:18910,19255:19276,19395:19405,20218:20245,20749:20758,20840:20849,21209:21213,21226:21235)' = c(-79.999 , 199.999),    # CRB_kso::k.sol | change = pctchg        
  'CRB_bd::bd.sol | change = pctchg | unit =       c(1:6,43:52,68:96,364:382,615:625,771:776,858:887,1052:1059,1092:1099,1120:1136,1181:1199,1217:1276,1429:1445,1653:1714,1745:1749,1905:2007,2042:2058,2413:2442,2553:2623,2662:2691,2716:2900,2917:2936,2970:2999,3019:3054,3077:3078,3217:3263,3880:3934,3977:4080,4164:4256,4402:4433,4538:4634,4662:4747,4773:4786,4793:4832,5795:5845,6164:6238,6441:6453,6460:6504,6531:6566,6584:6647,6680:6706,6733:6779,6846:6895,6916:6976,6998:7008,7035:7039,7133:7136,7190:7310,7854:7862,8118:8192,8248:8258,8273:8424,8683:8713,8730:8777,9058:9232,9369:9461,9469:9488,9493:9504,9509:9539,9556:9603,10193:10275,10302:10314,10328:10353,10368:10392,10405:10496,10511:10653,10733:10765,10873:10899,10992:11026,11305:11337,11697:11721,11819:11846,12118:12122,12197:12210,12263:12274,12481:12483,12504:12510,13189:13208,13223:13237,13494:13501,13655:13667,13971:13985,14329:14346,14709:14722,14743:14769,14810:14826,14888:14901,14953:14991,15007:15059,15136:15142,15202:15220,17246:17279,17310:17343,17437:17454,18123:18142,18218:18233,18514:18535,18896:18910,19255:19276,19395:19405,20218:20245,20749:20758,20840:20849,21209:21213,21226:21235)' = c(-29.999 , 29.999),     # CRB_bd::bd.sol | change = pctchg      
  
  
  'DTH_esc::esco.hru | change = absval | unit =    c( 230:335,538:599,677:696,717:756,945:982,1060:1091,1200:1216,1415:1420,1455:1458,1479:1528,1533:1652,1750:1788,2008:2041,2340:2346,2353:2360,2901:2916,2937:2969,3000:3018,3055:3076,3289:3298,3460:3610,3623:3651,3674:3701,3718:3814,4081:4108,4661:4661,4833:5419,5444:5794,5846:5871,5951:5962,5977:5990,6087:6163,6239:6379,6414:6440,6454:6459,6505:6530,6825:6845,6896:6915,6977:6997,7009:7034,7040:7132,7137:7189,7367:7374,7450:7457,7531:7553,7688:7717,7746:7753,7768:7853,7863:8037,8052:8068,8088:8117,8193:8247,8259:8272,8495:8506,8534:8536,8558:8682,8714:8729,8778:9057,9462:9468,9489:9492,9505:9508,9540:9555,9604:9669,9683:9686,9818:9921,9939:9961,9976:10016,10148:10192,10276:10301,10315:10327,10668:10694,10766:10872,10900:10919,10942:10965,11070:11084,11101:11114,11123:11134,11142:11304,11484:11511,11561:11616,11629:11635,11659:11696,11722:11794,12123:12196,12211:12262,12447:12480,12484:12503,12511:12534,12572:13033,13054:13060,13126:13153,13238:13281,13292:13362,13373:13493,13502:13536,13704:13723,13734:13759,13807:13833,13918:13970,13986:13992,14102:14111,14208:14224,14250:14255,14325:14328,14353:14428,14453:14536,14550:14673,14693:14708,14723:14742,14866:14887,15060:15100,15172:15172,15221:15313,15351:15400,15423:15434,15457:15496,15522:15563,15608:15636,15672:15747,15773:15794,15819:15834,15848:15876,15914:15961,15973:16103,16112:16209,16215:16245,16288:16419,16431:16440,16453:16483,16515:16610,16661:16687,16717:16774,17039:17075,17101:17141,17239:17245,17280:17286,17400:17436,17630:17692,17722:17980,18029:18080,18143:18217,18234:18254,18292:18406,18417:18427,18435:18466,18492:18498,18536:18612,18640:18750,18756:18825,18975:19238,19315:19394,19406:19573,19589:19592,19639:19793,19854:19875,19919:19974,20044:20072,20192:20217,20271:20343,20682:20696,20737:20748,20764:20773,21101:21167,21203:21208,21214:21225,21236:21312,21323:21337,21354:21389,21442:21461,21480:21505,21577:21589,21648:21924,21956:21988,22002:22005,22045:22068)' = c(0.001 , 0.999),      # DTH_esc::esco.hru | change = absval                         
  'DTH_epc::epco.hru | change = absval | unit =    c( 230:335,538:599,677:696,717:756,945:982,1060:1091,1200:1216,1415:1420,1455:1458,1479:1528,1533:1652,1750:1788,2008:2041,2340:2346,2353:2360,2901:2916,2937:2969,3000:3018,3055:3076,3289:3298,3460:3610,3623:3651,3674:3701,3718:3814,4081:4108,4661:4661,4833:5419,5444:5794,5846:5871,5951:5962,5977:5990,6087:6163,6239:6379,6414:6440,6454:6459,6505:6530,6825:6845,6896:6915,6977:6997,7009:7034,7040:7132,7137:7189,7367:7374,7450:7457,7531:7553,7688:7717,7746:7753,7768:7853,7863:8037,8052:8068,8088:8117,8193:8247,8259:8272,8495:8506,8534:8536,8558:8682,8714:8729,8778:9057,9462:9468,9489:9492,9505:9508,9540:9555,9604:9669,9683:9686,9818:9921,9939:9961,9976:10016,10148:10192,10276:10301,10315:10327,10668:10694,10766:10872,10900:10919,10942:10965,11070:11084,11101:11114,11123:11134,11142:11304,11484:11511,11561:11616,11629:11635,11659:11696,11722:11794,12123:12196,12211:12262,12447:12480,12484:12503,12511:12534,12572:13033,13054:13060,13126:13153,13238:13281,13292:13362,13373:13493,13502:13536,13704:13723,13734:13759,13807:13833,13918:13970,13986:13992,14102:14111,14208:14224,14250:14255,14325:14328,14353:14428,14453:14536,14550:14673,14693:14708,14723:14742,14866:14887,15060:15100,15172:15172,15221:15313,15351:15400,15423:15434,15457:15496,15522:15563,15608:15636,15672:15747,15773:15794,15819:15834,15848:15876,15914:15961,15973:16103,16112:16209,16215:16245,16288:16419,16431:16440,16453:16483,16515:16610,16661:16687,16717:16774,17039:17075,17101:17141,17239:17245,17280:17286,17400:17436,17630:17692,17722:17980,18029:18080,18143:18217,18234:18254,18292:18406,18417:18427,18435:18466,18492:18498,18536:18612,18640:18750,18756:18825,18975:19238,19315:19394,19406:19573,19589:19592,19639:19793,19854:19875,19919:19974,20044:20072,20192:20217,20271:20343,20682:20696,20737:20748,20764:20773,21101:21167,21203:21208,21214:21225,21236:21312,21323:21337,21354:21389,21442:21461,21480:21505,21577:21589,21648:21924,21956:21988,22002:22005,22045:22068)' = c(0.001 , 0.999),      # DTH_epc::epco.hru | change = absval     
  'DTH_cnn::cn2.hru | change = pctchg | unit =     c( 230:335,538:599,677:696,717:756,945:982,1060:1091,1200:1216,1415:1420,1455:1458,1479:1528,1533:1652,1750:1788,2008:2041,2340:2346,2353:2360,2901:2916,2937:2969,3000:3018,3055:3076,3289:3298,3460:3610,3623:3651,3674:3701,3718:3814,4081:4108,4661:4661,4833:5419,5444:5794,5846:5871,5951:5962,5977:5990,6087:6163,6239:6379,6414:6440,6454:6459,6505:6530,6825:6845,6896:6915,6977:6997,7009:7034,7040:7132,7137:7189,7367:7374,7450:7457,7531:7553,7688:7717,7746:7753,7768:7853,7863:8037,8052:8068,8088:8117,8193:8247,8259:8272,8495:8506,8534:8536,8558:8682,8714:8729,8778:9057,9462:9468,9489:9492,9505:9508,9540:9555,9604:9669,9683:9686,9818:9921,9939:9961,9976:10016,10148:10192,10276:10301,10315:10327,10668:10694,10766:10872,10900:10919,10942:10965,11070:11084,11101:11114,11123:11134,11142:11304,11484:11511,11561:11616,11629:11635,11659:11696,11722:11794,12123:12196,12211:12262,12447:12480,12484:12503,12511:12534,12572:13033,13054:13060,13126:13153,13238:13281,13292:13362,13373:13493,13502:13536,13704:13723,13734:13759,13807:13833,13918:13970,13986:13992,14102:14111,14208:14224,14250:14255,14325:14328,14353:14428,14453:14536,14550:14673,14693:14708,14723:14742,14866:14887,15060:15100,15172:15172,15221:15313,15351:15400,15423:15434,15457:15496,15522:15563,15608:15636,15672:15747,15773:15794,15819:15834,15848:15876,15914:15961,15973:16103,16112:16209,16215:16245,16288:16419,16431:16440,16453:16483,16515:16610,16661:16687,16717:16774,17039:17075,17101:17141,17239:17245,17280:17286,17400:17436,17630:17692,17722:17980,18029:18080,18143:18217,18234:18254,18292:18406,18417:18427,18435:18466,18492:18498,18536:18612,18640:18750,18756:18825,18975:19238,19315:19394,19406:19573,19589:19592,19639:19793,19854:19875,19919:19974,20044:20072,20192:20217,20271:20343,20682:20696,20737:20748,20764:20773,21101:21167,21203:21208,21214:21225,21236:21312,21323:21337,21354:21389,21442:21461,21480:21505,21577:21589,21648:21924,21956:21988,22002:22005,22045:22068)' = c(-29.999  ,  29.999), # DTH_cnn::cn2.hru | change = pctchg             
  'DTH_awc::awc.sol | change = pctchg | unit =     c( 230:335,538:599,677:696,717:756,945:982,1060:1091,1200:1216,1415:1420,1455:1458,1479:1528,1533:1652,1750:1788,2008:2041,2340:2346,2353:2360,2901:2916,2937:2969,3000:3018,3055:3076,3289:3298,3460:3610,3623:3651,3674:3701,3718:3814,4081:4108,4661:4661,4833:5419,5444:5794,5846:5871,5951:5962,5977:5990,6087:6163,6239:6379,6414:6440,6454:6459,6505:6530,6825:6845,6896:6915,6977:6997,7009:7034,7040:7132,7137:7189,7367:7374,7450:7457,7531:7553,7688:7717,7746:7753,7768:7853,7863:8037,8052:8068,8088:8117,8193:8247,8259:8272,8495:8506,8534:8536,8558:8682,8714:8729,8778:9057,9462:9468,9489:9492,9505:9508,9540:9555,9604:9669,9683:9686,9818:9921,9939:9961,9976:10016,10148:10192,10276:10301,10315:10327,10668:10694,10766:10872,10900:10919,10942:10965,11070:11084,11101:11114,11123:11134,11142:11304,11484:11511,11561:11616,11629:11635,11659:11696,11722:11794,12123:12196,12211:12262,12447:12480,12484:12503,12511:12534,12572:13033,13054:13060,13126:13153,13238:13281,13292:13362,13373:13493,13502:13536,13704:13723,13734:13759,13807:13833,13918:13970,13986:13992,14102:14111,14208:14224,14250:14255,14325:14328,14353:14428,14453:14536,14550:14673,14693:14708,14723:14742,14866:14887,15060:15100,15172:15172,15221:15313,15351:15400,15423:15434,15457:15496,15522:15563,15608:15636,15672:15747,15773:15794,15819:15834,15848:15876,15914:15961,15973:16103,16112:16209,16215:16245,16288:16419,16431:16440,16453:16483,16515:16610,16661:16687,16717:16774,17039:17075,17101:17141,17239:17245,17280:17286,17400:17436,17630:17692,17722:17980,18029:18080,18143:18217,18234:18254,18292:18406,18417:18427,18435:18466,18492:18498,18536:18612,18640:18750,18756:18825,18975:19238,19315:19394,19406:19573,19589:19592,19639:19793,19854:19875,19919:19974,20044:20072,20192:20217,20271:20343,20682:20696,20737:20748,20764:20773,21101:21167,21203:21208,21214:21225,21236:21312,21323:21337,21354:21389,21442:21461,21480:21505,21577:21589,21648:21924,21956:21988,22002:22005,22045:22068)' = c(-59.999 , 59.999),   # DTH_awc::awc.sol | change = pctchg         
  'DTH_per::perco.hru | change = absval | unit =   c( 230:335,538:599,677:696,717:756,945:982,1060:1091,1200:1216,1415:1420,1455:1458,1479:1528,1533:1652,1750:1788,2008:2041,2340:2346,2353:2360,2901:2916,2937:2969,3000:3018,3055:3076,3289:3298,3460:3610,3623:3651,3674:3701,3718:3814,4081:4108,4661:4661,4833:5419,5444:5794,5846:5871,5951:5962,5977:5990,6087:6163,6239:6379,6414:6440,6454:6459,6505:6530,6825:6845,6896:6915,6977:6997,7009:7034,7040:7132,7137:7189,7367:7374,7450:7457,7531:7553,7688:7717,7746:7753,7768:7853,7863:8037,8052:8068,8088:8117,8193:8247,8259:8272,8495:8506,8534:8536,8558:8682,8714:8729,8778:9057,9462:9468,9489:9492,9505:9508,9540:9555,9604:9669,9683:9686,9818:9921,9939:9961,9976:10016,10148:10192,10276:10301,10315:10327,10668:10694,10766:10872,10900:10919,10942:10965,11070:11084,11101:11114,11123:11134,11142:11304,11484:11511,11561:11616,11629:11635,11659:11696,11722:11794,12123:12196,12211:12262,12447:12480,12484:12503,12511:12534,12572:13033,13054:13060,13126:13153,13238:13281,13292:13362,13373:13493,13502:13536,13704:13723,13734:13759,13807:13833,13918:13970,13986:13992,14102:14111,14208:14224,14250:14255,14325:14328,14353:14428,14453:14536,14550:14673,14693:14708,14723:14742,14866:14887,15060:15100,15172:15172,15221:15313,15351:15400,15423:15434,15457:15496,15522:15563,15608:15636,15672:15747,15773:15794,15819:15834,15848:15876,15914:15961,15973:16103,16112:16209,16215:16245,16288:16419,16431:16440,16453:16483,16515:16610,16661:16687,16717:16774,17039:17075,17101:17141,17239:17245,17280:17286,17400:17436,17630:17692,17722:17980,18029:18080,18143:18217,18234:18254,18292:18406,18417:18427,18435:18466,18492:18498,18536:18612,18640:18750,18756:18825,18975:19238,19315:19394,19406:19573,19589:19592,19639:19793,19854:19875,19919:19974,20044:20072,20192:20217,20271:20343,20682:20696,20737:20748,20764:20773,21101:21167,21203:21208,21214:21225,21236:21312,21323:21337,21354:21389,21442:21461,21480:21505,21577:21589,21648:21924,21956:21988,22002:22005,22045:22068)' = c(0.2 , 0.999),        # DTH_per::perco.hru | change = absval  
  'DTH_latq::latq_co.hru | change = abschg | unit =   c( 230:335,538:599,677:696,717:756,945:982,1060:1091,1200:1216,1415:1420,1455:1458,1479:1528,1533:1652,1750:1788,2008:2041,2340:2346,2353:2360,2901:2916,2937:2969,3000:3018,3055:3076,3289:3298,3460:3610,3623:3651,3674:3701,3718:3814,4081:4108,4661:4661,4833:5419,5444:5794,5846:5871,5951:5962,5977:5990,6087:6163,6239:6379,6414:6440,6454:6459,6505:6530,6825:6845,6896:6915,6977:6997,7009:7034,7040:7132,7137:7189,7367:7374,7450:7457,7531:7553,7688:7717,7746:7753,7768:7853,7863:8037,8052:8068,8088:8117,8193:8247,8259:8272,8495:8506,8534:8536,8558:8682,8714:8729,8778:9057,9462:9468,9489:9492,9505:9508,9540:9555,9604:9669,9683:9686,9818:9921,9939:9961,9976:10016,10148:10192,10276:10301,10315:10327,10668:10694,10766:10872,10900:10919,10942:10965,11070:11084,11101:11114,11123:11134,11142:11304,11484:11511,11561:11616,11629:11635,11659:11696,11722:11794,12123:12196,12211:12262,12447:12480,12484:12503,12511:12534,12572:13033,13054:13060,13126:13153,13238:13281,13292:13362,13373:13493,13502:13536,13704:13723,13734:13759,13807:13833,13918:13970,13986:13992,14102:14111,14208:14224,14250:14255,14325:14328,14353:14428,14453:14536,14550:14673,14693:14708,14723:14742,14866:14887,15060:15100,15172:15172,15221:15313,15351:15400,15423:15434,15457:15496,15522:15563,15608:15636,15672:15747,15773:15794,15819:15834,15848:15876,15914:15961,15973:16103,16112:16209,16215:16245,16288:16419,16431:16440,16453:16483,16515:16610,16661:16687,16717:16774,17039:17075,17101:17141,17239:17245,17280:17286,17400:17436,17630:17692,17722:17980,18029:18080,18143:18217,18234:18254,18292:18406,18417:18427,18435:18466,18492:18498,18536:18612,18640:18750,18756:18825,18975:19238,19315:19394,19406:19573,19589:19592,19639:19793,19854:19875,19919:19974,20044:20072,20192:20217,20271:20343,20682:20696,20737:20748,20764:20773,21101:21167,21203:21208,21214:21225,21236:21312,21323:21337,21354:21389,21442:21461,21480:21505,21577:21589,21648:21924,21956:21988,22002:22005,22045:22068)' = c(-0.5, 0.5),       # DTH_latq::latq_co.hru | change = abschg      
  'DTH_cn3::cn3_swf.hru | change = abschg | unit = c( 230:335,538:599,677:696,717:756,945:982,1060:1091,1200:1216,1415:1420,1455:1458,1479:1528,1533:1652,1750:1788,2008:2041,2340:2346,2353:2360,2901:2916,2937:2969,3000:3018,3055:3076,3289:3298,3460:3610,3623:3651,3674:3701,3718:3814,4081:4108,4661:4661,4833:5419,5444:5794,5846:5871,5951:5962,5977:5990,6087:6163,6239:6379,6414:6440,6454:6459,6505:6530,6825:6845,6896:6915,6977:6997,7009:7034,7040:7132,7137:7189,7367:7374,7450:7457,7531:7553,7688:7717,7746:7753,7768:7853,7863:8037,8052:8068,8088:8117,8193:8247,8259:8272,8495:8506,8534:8536,8558:8682,8714:8729,8778:9057,9462:9468,9489:9492,9505:9508,9540:9555,9604:9669,9683:9686,9818:9921,9939:9961,9976:10016,10148:10192,10276:10301,10315:10327,10668:10694,10766:10872,10900:10919,10942:10965,11070:11084,11101:11114,11123:11134,11142:11304,11484:11511,11561:11616,11629:11635,11659:11696,11722:11794,12123:12196,12211:12262,12447:12480,12484:12503,12511:12534,12572:13033,13054:13060,13126:13153,13238:13281,13292:13362,13373:13493,13502:13536,13704:13723,13734:13759,13807:13833,13918:13970,13986:13992,14102:14111,14208:14224,14250:14255,14325:14328,14353:14428,14453:14536,14550:14673,14693:14708,14723:14742,14866:14887,15060:15100,15172:15172,15221:15313,15351:15400,15423:15434,15457:15496,15522:15563,15608:15636,15672:15747,15773:15794,15819:15834,15848:15876,15914:15961,15973:16103,16112:16209,16215:16245,16288:16419,16431:16440,16453:16483,16515:16610,16661:16687,16717:16774,17039:17075,17101:17141,17239:17245,17280:17286,17400:17436,17630:17692,17722:17980,18029:18080,18143:18217,18234:18254,18292:18406,18417:18427,18435:18466,18492:18498,18536:18612,18640:18750,18756:18825,18975:19238,19315:19394,19406:19573,19589:19592,19639:19793,19854:19875,19919:19974,20044:20072,20192:20217,20271:20343,20682:20696,20737:20748,20764:20773,21101:21167,21203:21208,21214:21225,21236:21312,21323:21337,21354:21389,21442:21461,21480:21505,21577:21589,21648:21924,21956:21988,22002:22005,22045:22068)' = c(-0.5, 0.5),          # DTH_cn3::cn3_swf.hru | change = abschg           
  'DTH_zso::z.sol | change = pctchg | unit =       c( 230:335,538:599,677:696,717:756,945:982,1060:1091,1200:1216,1415:1420,1455:1458,1479:1528,1533:1652,1750:1788,2008:2041,2340:2346,2353:2360,2901:2916,2937:2969,3000:3018,3055:3076,3289:3298,3460:3610,3623:3651,3674:3701,3718:3814,4081:4108,4661:4661,4833:5419,5444:5794,5846:5871,5951:5962,5977:5990,6087:6163,6239:6379,6414:6440,6454:6459,6505:6530,6825:6845,6896:6915,6977:6997,7009:7034,7040:7132,7137:7189,7367:7374,7450:7457,7531:7553,7688:7717,7746:7753,7768:7853,7863:8037,8052:8068,8088:8117,8193:8247,8259:8272,8495:8506,8534:8536,8558:8682,8714:8729,8778:9057,9462:9468,9489:9492,9505:9508,9540:9555,9604:9669,9683:9686,9818:9921,9939:9961,9976:10016,10148:10192,10276:10301,10315:10327,10668:10694,10766:10872,10900:10919,10942:10965,11070:11084,11101:11114,11123:11134,11142:11304,11484:11511,11561:11616,11629:11635,11659:11696,11722:11794,12123:12196,12211:12262,12447:12480,12484:12503,12511:12534,12572:13033,13054:13060,13126:13153,13238:13281,13292:13362,13373:13493,13502:13536,13704:13723,13734:13759,13807:13833,13918:13970,13986:13992,14102:14111,14208:14224,14250:14255,14325:14328,14353:14428,14453:14536,14550:14673,14693:14708,14723:14742,14866:14887,15060:15100,15172:15172,15221:15313,15351:15400,15423:15434,15457:15496,15522:15563,15608:15636,15672:15747,15773:15794,15819:15834,15848:15876,15914:15961,15973:16103,16112:16209,16215:16245,16288:16419,16431:16440,16453:16483,16515:16610,16661:16687,16717:16774,17039:17075,17101:17141,17239:17245,17280:17286,17400:17436,17630:17692,17722:17980,18029:18080,18143:18217,18234:18254,18292:18406,18417:18427,18435:18466,18492:18498,18536:18612,18640:18750,18756:18825,18975:19238,19315:19394,19406:19573,19589:19592,19639:19793,19854:19875,19919:19974,20044:20072,20192:20217,20271:20343,20682:20696,20737:20748,20764:20773,21101:21167,21203:21208,21214:21225,21236:21312,21323:21337,21354:21389,21442:21461,21480:21505,21577:21589,21648:21924,21956:21988,22002:22005,22045:22068)' = c(-49.999 , 49.999),   # DTH_zso::z.sol | change = pctchg         
  'DTH_kso::k.sol | change = pctchg | unit =       c( 230:335,538:599,677:696,717:756,945:982,1060:1091,1200:1216,1415:1420,1455:1458,1479:1528,1533:1652,1750:1788,2008:2041,2340:2346,2353:2360,2901:2916,2937:2969,3000:3018,3055:3076,3289:3298,3460:3610,3623:3651,3674:3701,3718:3814,4081:4108,4661:4661,4833:5419,5444:5794,5846:5871,5951:5962,5977:5990,6087:6163,6239:6379,6414:6440,6454:6459,6505:6530,6825:6845,6896:6915,6977:6997,7009:7034,7040:7132,7137:7189,7367:7374,7450:7457,7531:7553,7688:7717,7746:7753,7768:7853,7863:8037,8052:8068,8088:8117,8193:8247,8259:8272,8495:8506,8534:8536,8558:8682,8714:8729,8778:9057,9462:9468,9489:9492,9505:9508,9540:9555,9604:9669,9683:9686,9818:9921,9939:9961,9976:10016,10148:10192,10276:10301,10315:10327,10668:10694,10766:10872,10900:10919,10942:10965,11070:11084,11101:11114,11123:11134,11142:11304,11484:11511,11561:11616,11629:11635,11659:11696,11722:11794,12123:12196,12211:12262,12447:12480,12484:12503,12511:12534,12572:13033,13054:13060,13126:13153,13238:13281,13292:13362,13373:13493,13502:13536,13704:13723,13734:13759,13807:13833,13918:13970,13986:13992,14102:14111,14208:14224,14250:14255,14325:14328,14353:14428,14453:14536,14550:14673,14693:14708,14723:14742,14866:14887,15060:15100,15172:15172,15221:15313,15351:15400,15423:15434,15457:15496,15522:15563,15608:15636,15672:15747,15773:15794,15819:15834,15848:15876,15914:15961,15973:16103,16112:16209,16215:16245,16288:16419,16431:16440,16453:16483,16515:16610,16661:16687,16717:16774,17039:17075,17101:17141,17239:17245,17280:17286,17400:17436,17630:17692,17722:17980,18029:18080,18143:18217,18234:18254,18292:18406,18417:18427,18435:18466,18492:18498,18536:18612,18640:18750,18756:18825,18975:19238,19315:19394,19406:19573,19589:19592,19639:19793,19854:19875,19919:19974,20044:20072,20192:20217,20271:20343,20682:20696,20737:20748,20764:20773,21101:21167,21203:21208,21214:21225,21236:21312,21323:21337,21354:21389,21442:21461,21480:21505,21577:21589,21648:21924,21956:21988,22002:22005,22045:22068)' = c(-79.999 , 199.999),  # DTH_kso::k.sol | change = pctchg          
  'DTH_bd::bd.sol | change = pctchg | unit =       c( 230:335,538:599,677:696,717:756,945:982,1060:1091,1200:1216,1415:1420,1455:1458,1479:1528,1533:1652,1750:1788,2008:2041,2340:2346,2353:2360,2901:2916,2937:2969,3000:3018,3055:3076,3289:3298,3460:3610,3623:3651,3674:3701,3718:3814,4081:4108,4661:4661,4833:5419,5444:5794,5846:5871,5951:5962,5977:5990,6087:6163,6239:6379,6414:6440,6454:6459,6505:6530,6825:6845,6896:6915,6977:6997,7009:7034,7040:7132,7137:7189,7367:7374,7450:7457,7531:7553,7688:7717,7746:7753,7768:7853,7863:8037,8052:8068,8088:8117,8193:8247,8259:8272,8495:8506,8534:8536,8558:8682,8714:8729,8778:9057,9462:9468,9489:9492,9505:9508,9540:9555,9604:9669,9683:9686,9818:9921,9939:9961,9976:10016,10148:10192,10276:10301,10315:10327,10668:10694,10766:10872,10900:10919,10942:10965,11070:11084,11101:11114,11123:11134,11142:11304,11484:11511,11561:11616,11629:11635,11659:11696,11722:11794,12123:12196,12211:12262,12447:12480,12484:12503,12511:12534,12572:13033,13054:13060,13126:13153,13238:13281,13292:13362,13373:13493,13502:13536,13704:13723,13734:13759,13807:13833,13918:13970,13986:13992,14102:14111,14208:14224,14250:14255,14325:14328,14353:14428,14453:14536,14550:14673,14693:14708,14723:14742,14866:14887,15060:15100,15172:15172,15221:15313,15351:15400,15423:15434,15457:15496,15522:15563,15608:15636,15672:15747,15773:15794,15819:15834,15848:15876,15914:15961,15973:16103,16112:16209,16215:16245,16288:16419,16431:16440,16453:16483,16515:16610,16661:16687,16717:16774,17039:17075,17101:17141,17239:17245,17280:17286,17400:17436,17630:17692,17722:17980,18029:18080,18143:18217,18234:18254,18292:18406,18417:18427,18435:18466,18492:18498,18536:18612,18640:18750,18756:18825,18975:19238,19315:19394,19406:19573,19589:19592,19639:19793,19854:19875,19919:19974,20044:20072,20192:20217,20271:20343,20682:20696,20737:20748,20764:20773,21101:21167,21203:21208,21214:21225,21236:21312,21323:21337,21354:21389,21442:21461,21480:21505,21577:21589,21648:21924,21956:21988,22002:22005,22045:22068)' = c(-29.999 , 29.999),   # DTH_bd::bd.sol | change = pctchg        
  
  
  'DTL_esc::esco.hru | change = absval | unit =    c(  7:42,336:363,383:431,467:492,607:614,777:857,888:944,983:1051,1100:1119,1137:1180,1715:1744,1877:1904,2385:2412,2443:2552,2624:2661,2692:2715,3079:3216,3264:3288,3611:3622,3652:3673,3702:3717,3815:3879,3935:3976,4109:4163,4257:4401,4434:4537,4635:4660,4748:4772,4787:4792,5872:5899,6380:6413,6567:6583,6648:6679,6707:6732,6780:6824,7554:7687,7718:7745,7754:7767,8038:8051,8069:8087,9670:9682,9922:9938,9962:9975,10354:10367,10393:10404,10497:10510,10654:10667,10695:10732,10920:10941,10966:10991,11512:11560,11617:11628,11636:11658,11795:11818,12535:12571,13034:13053,13209:13222,13282:13291,13363:13372,13537:13654,13668:13703,13724:13733,13760:13806,13834:13917,13993:14101,14112:14207,14225:14249,14256:14324,14347:14352,14429:14452,14537:14549,14674:14692,14770:14809,14827:14865,14902:14952,14992:15006,15101:15135,15143:15171,15173:15201,15314:15350,15401:15422,15435:15456,15497:15521,15564:15607,15637:15671,16104:16111,16210:16214,16246:16287,16420:16430,16441:16452,16611:16660,16688:16716,16775:17038,17076:17100,17142:17238,17287:17309,17344:17367,17455:17522,17981:18028,18081:18122,18255:18291,18407:18416,18428:18434,18467:18491,18499:18513,18751:18755,18826:18895,18911:18974,19277:19314,20246:20270,20667:20681,20697:20736,20759:20763,20774:20839,21506:21576,21590:21647 )' = c(0.001 , 0.999),      # DTL_esc::esco.hru | change = absval       
  'DTL_epc::epco.hru | change = absval | unit =    c(  7:42,336:363,383:431,467:492,607:614,777:857,888:944,983:1051,1100:1119,1137:1180,1715:1744,1877:1904,2385:2412,2443:2552,2624:2661,2692:2715,3079:3216,3264:3288,3611:3622,3652:3673,3702:3717,3815:3879,3935:3976,4109:4163,4257:4401,4434:4537,4635:4660,4748:4772,4787:4792,5872:5899,6380:6413,6567:6583,6648:6679,6707:6732,6780:6824,7554:7687,7718:7745,7754:7767,8038:8051,8069:8087,9670:9682,9922:9938,9962:9975,10354:10367,10393:10404,10497:10510,10654:10667,10695:10732,10920:10941,10966:10991,11512:11560,11617:11628,11636:11658,11795:11818,12535:12571,13034:13053,13209:13222,13282:13291,13363:13372,13537:13654,13668:13703,13724:13733,13760:13806,13834:13917,13993:14101,14112:14207,14225:14249,14256:14324,14347:14352,14429:14452,14537:14549,14674:14692,14770:14809,14827:14865,14902:14952,14992:15006,15101:15135,15143:15171,15173:15201,15314:15350,15401:15422,15435:15456,15497:15521,15564:15607,15637:15671,16104:16111,16210:16214,16246:16287,16420:16430,16441:16452,16611:16660,16688:16716,16775:17038,17076:17100,17142:17238,17287:17309,17344:17367,17455:17522,17981:18028,18081:18122,18255:18291,18407:18416,18428:18434,18467:18491,18499:18513,18751:18755,18826:18895,18911:18974,19277:19314,20246:20270,20667:20681,20697:20736,20759:20763,20774:20839,21506:21576,21590:21647 )' = c(0.001 , 0.999),      # DTL_epc::epco.hru | change = absval  
  'DTL_cnn::cn2.hru | change = pctchg | unit =     c(  7:42,336:363,383:431,467:492,607:614,777:857,888:944,983:1051,1100:1119,1137:1180,1715:1744,1877:1904,2385:2412,2443:2552,2624:2661,2692:2715,3079:3216,3264:3288,3611:3622,3652:3673,3702:3717,3815:3879,3935:3976,4109:4163,4257:4401,4434:4537,4635:4660,4748:4772,4787:4792,5872:5899,6380:6413,6567:6583,6648:6679,6707:6732,6780:6824,7554:7687,7718:7745,7754:7767,8038:8051,8069:8087,9670:9682,9922:9938,9962:9975,10354:10367,10393:10404,10497:10510,10654:10667,10695:10732,10920:10941,10966:10991,11512:11560,11617:11628,11636:11658,11795:11818,12535:12571,13034:13053,13209:13222,13282:13291,13363:13372,13537:13654,13668:13703,13724:13733,13760:13806,13834:13917,13993:14101,14112:14207,14225:14249,14256:14324,14347:14352,14429:14452,14537:14549,14674:14692,14770:14809,14827:14865,14902:14952,14992:15006,15101:15135,15143:15171,15173:15201,15314:15350,15401:15422,15435:15456,15497:15521,15564:15607,15637:15671,16104:16111,16210:16214,16246:16287,16420:16430,16441:16452,16611:16660,16688:16716,16775:17038,17076:17100,17142:17238,17287:17309,17344:17367,17455:17522,17981:18028,18081:18122,18255:18291,18407:18416,18428:18434,18467:18491,18499:18513,18751:18755,18826:18895,18911:18974,19277:19314,20246:20270,20667:20681,20697:20736,20759:20763,20774:20839,21506:21576,21590:21647 )' = c(-29.999  ,  29.999), # DTL_cnn::cn2.hru | change = pctchg       
  'DTL_awc::awc.sol | change = pctchg | unit =     c(  7:42,336:363,383:431,467:492,607:614,777:857,888:944,983:1051,1100:1119,1137:1180,1715:1744,1877:1904,2385:2412,2443:2552,2624:2661,2692:2715,3079:3216,3264:3288,3611:3622,3652:3673,3702:3717,3815:3879,3935:3976,4109:4163,4257:4401,4434:4537,4635:4660,4748:4772,4787:4792,5872:5899,6380:6413,6567:6583,6648:6679,6707:6732,6780:6824,7554:7687,7718:7745,7754:7767,8038:8051,8069:8087,9670:9682,9922:9938,9962:9975,10354:10367,10393:10404,10497:10510,10654:10667,10695:10732,10920:10941,10966:10991,11512:11560,11617:11628,11636:11658,11795:11818,12535:12571,13034:13053,13209:13222,13282:13291,13363:13372,13537:13654,13668:13703,13724:13733,13760:13806,13834:13917,13993:14101,14112:14207,14225:14249,14256:14324,14347:14352,14429:14452,14537:14549,14674:14692,14770:14809,14827:14865,14902:14952,14992:15006,15101:15135,15143:15171,15173:15201,15314:15350,15401:15422,15435:15456,15497:15521,15564:15607,15637:15671,16104:16111,16210:16214,16246:16287,16420:16430,16441:16452,16611:16660,16688:16716,16775:17038,17076:17100,17142:17238,17287:17309,17344:17367,17455:17522,17981:18028,18081:18122,18255:18291,18407:18416,18428:18434,18467:18491,18499:18513,18751:18755,18826:18895,18911:18974,19277:19314,20246:20270,20667:20681,20697:20736,20759:20763,20774:20839,21506:21576,21590:21647 )' = c(-59.999 , 59.999),   # DTL_awc::awc.sol | change = pctchg    
  'DTL_per::perco.hru | change = absval | unit =   c(  7:42,336:363,383:431,467:492,607:614,777:857,888:944,983:1051,1100:1119,1137:1180,1715:1744,1877:1904,2385:2412,2443:2552,2624:2661,2692:2715,3079:3216,3264:3288,3611:3622,3652:3673,3702:3717,3815:3879,3935:3976,4109:4163,4257:4401,4434:4537,4635:4660,4748:4772,4787:4792,5872:5899,6380:6413,6567:6583,6648:6679,6707:6732,6780:6824,7554:7687,7718:7745,7754:7767,8038:8051,8069:8087,9670:9682,9922:9938,9962:9975,10354:10367,10393:10404,10497:10510,10654:10667,10695:10732,10920:10941,10966:10991,11512:11560,11617:11628,11636:11658,11795:11818,12535:12571,13034:13053,13209:13222,13282:13291,13363:13372,13537:13654,13668:13703,13724:13733,13760:13806,13834:13917,13993:14101,14112:14207,14225:14249,14256:14324,14347:14352,14429:14452,14537:14549,14674:14692,14770:14809,14827:14865,14902:14952,14992:15006,15101:15135,15143:15171,15173:15201,15314:15350,15401:15422,15435:15456,15497:15521,15564:15607,15637:15671,16104:16111,16210:16214,16246:16287,16420:16430,16441:16452,16611:16660,16688:16716,16775:17038,17076:17100,17142:17238,17287:17309,17344:17367,17455:17522,17981:18028,18081:18122,18255:18291,18407:18416,18428:18434,18467:18491,18499:18513,18751:18755,18826:18895,18911:18974,19277:19314,20246:20270,20667:20681,20697:20736,20759:20763,20774:20839,21506:21576,21590:21647 )' = c(0.001 , 0.7),        # DTL_per::perco.hru | change = absval
  'DTL_latq::latq_co.hru | change = abschg | unit =   c(  7:42,336:363,383:431,467:492,607:614,777:857,888:944,983:1051,1100:1119,1137:1180,1715:1744,1877:1904,2385:2412,2443:2552,2624:2661,2692:2715,3079:3216,3264:3288,3611:3622,3652:3673,3702:3717,3815:3879,3935:3976,4109:4163,4257:4401,4434:4537,4635:4660,4748:4772,4787:4792,5872:5899,6380:6413,6567:6583,6648:6679,6707:6732,6780:6824,7554:7687,7718:7745,7754:7767,8038:8051,8069:8087,9670:9682,9922:9938,9962:9975,10354:10367,10393:10404,10497:10510,10654:10667,10695:10732,10920:10941,10966:10991,11512:11560,11617:11628,11636:11658,11795:11818,12535:12571,13034:13053,13209:13222,13282:13291,13363:13372,13537:13654,13668:13703,13724:13733,13760:13806,13834:13917,13993:14101,14112:14207,14225:14249,14256:14324,14347:14352,14429:14452,14537:14549,14674:14692,14770:14809,14827:14865,14902:14952,14992:15006,15101:15135,15143:15171,15173:15201,15314:15350,15401:15422,15435:15456,15497:15521,15564:15607,15637:15671,16104:16111,16210:16214,16246:16287,16420:16430,16441:16452,16611:16660,16688:16716,16775:17038,17076:17100,17142:17238,17287:17309,17344:17367,17455:17522,17981:18028,18081:18122,18255:18291,18407:18416,18428:18434,18467:18491,18499:18513,18751:18755,18826:18895,18911:18974,19277:19314,20246:20270,20667:20681,20697:20736,20759:20763,20774:20839,21506:21576,21590:21647 )' = c(-0.5, 0.5),       # DTL_latq::latq_co.hru | change = abschg    
  'DTL_cn3::cn3_swf.hru | change = abschg | unit = c(  7:42,336:363,383:431,467:492,607:614,777:857,888:944,983:1051,1100:1119,1137:1180,1715:1744,1877:1904,2385:2412,2443:2552,2624:2661,2692:2715,3079:3216,3264:3288,3611:3622,3652:3673,3702:3717,3815:3879,3935:3976,4109:4163,4257:4401,4434:4537,4635:4660,4748:4772,4787:4792,5872:5899,6380:6413,6567:6583,6648:6679,6707:6732,6780:6824,7554:7687,7718:7745,7754:7767,8038:8051,8069:8087,9670:9682,9922:9938,9962:9975,10354:10367,10393:10404,10497:10510,10654:10667,10695:10732,10920:10941,10966:10991,11512:11560,11617:11628,11636:11658,11795:11818,12535:12571,13034:13053,13209:13222,13282:13291,13363:13372,13537:13654,13668:13703,13724:13733,13760:13806,13834:13917,13993:14101,14112:14207,14225:14249,14256:14324,14347:14352,14429:14452,14537:14549,14674:14692,14770:14809,14827:14865,14902:14952,14992:15006,15101:15135,15143:15171,15173:15201,15314:15350,15401:15422,15435:15456,15497:15521,15564:15607,15637:15671,16104:16111,16210:16214,16246:16287,16420:16430,16441:16452,16611:16660,16688:16716,16775:17038,17076:17100,17142:17238,17287:17309,17344:17367,17455:17522,17981:18028,18081:18122,18255:18291,18407:18416,18428:18434,18467:18491,18499:18513,18751:18755,18826:18895,18911:18974,19277:19314,20246:20270,20667:20681,20697:20736,20759:20763,20774:20839,21506:21576,21590:21647 )' = c(-0.5, 0.5),          # DTL_cn3::cn3_swf.hru | change = abschg        
  'DTL_zso::z.sol | change = pctchg | unit =       c(  7:42,336:363,383:431,467:492,607:614,777:857,888:944,983:1051,1100:1119,1137:1180,1715:1744,1877:1904,2385:2412,2443:2552,2624:2661,2692:2715,3079:3216,3264:3288,3611:3622,3652:3673,3702:3717,3815:3879,3935:3976,4109:4163,4257:4401,4434:4537,4635:4660,4748:4772,4787:4792,5872:5899,6380:6413,6567:6583,6648:6679,6707:6732,6780:6824,7554:7687,7718:7745,7754:7767,8038:8051,8069:8087,9670:9682,9922:9938,9962:9975,10354:10367,10393:10404,10497:10510,10654:10667,10695:10732,10920:10941,10966:10991,11512:11560,11617:11628,11636:11658,11795:11818,12535:12571,13034:13053,13209:13222,13282:13291,13363:13372,13537:13654,13668:13703,13724:13733,13760:13806,13834:13917,13993:14101,14112:14207,14225:14249,14256:14324,14347:14352,14429:14452,14537:14549,14674:14692,14770:14809,14827:14865,14902:14952,14992:15006,15101:15135,15143:15171,15173:15201,15314:15350,15401:15422,15435:15456,15497:15521,15564:15607,15637:15671,16104:16111,16210:16214,16246:16287,16420:16430,16441:16452,16611:16660,16688:16716,16775:17038,17076:17100,17142:17238,17287:17309,17344:17367,17455:17522,17981:18028,18081:18122,18255:18291,18407:18416,18428:18434,18467:18491,18499:18513,18751:18755,18826:18895,18911:18974,19277:19314,20246:20270,20667:20681,20697:20736,20759:20763,20774:20839,21506:21576,21590:21647 )' = c(-49.999 , 49.999),   # DTL_zso::z.sol | change = pctchg 
  'DTL_kso::k.sol | change = pctchg | unit =       c(  7:42,336:363,383:431,467:492,607:614,777:857,888:944,983:1051,1100:1119,1137:1180,1715:1744,1877:1904,2385:2412,2443:2552,2624:2661,2692:2715,3079:3216,3264:3288,3611:3622,3652:3673,3702:3717,3815:3879,3935:3976,4109:4163,4257:4401,4434:4537,4635:4660,4748:4772,4787:4792,5872:5899,6380:6413,6567:6583,6648:6679,6707:6732,6780:6824,7554:7687,7718:7745,7754:7767,8038:8051,8069:8087,9670:9682,9922:9938,9962:9975,10354:10367,10393:10404,10497:10510,10654:10667,10695:10732,10920:10941,10966:10991,11512:11560,11617:11628,11636:11658,11795:11818,12535:12571,13034:13053,13209:13222,13282:13291,13363:13372,13537:13654,13668:13703,13724:13733,13760:13806,13834:13917,13993:14101,14112:14207,14225:14249,14256:14324,14347:14352,14429:14452,14537:14549,14674:14692,14770:14809,14827:14865,14902:14952,14992:15006,15101:15135,15143:15171,15173:15201,15314:15350,15401:15422,15435:15456,15497:15521,15564:15607,15637:15671,16104:16111,16210:16214,16246:16287,16420:16430,16441:16452,16611:16660,16688:16716,16775:17038,17076:17100,17142:17238,17287:17309,17344:17367,17455:17522,17981:18028,18081:18122,18255:18291,18407:18416,18428:18434,18467:18491,18499:18513,18751:18755,18826:18895,18911:18974,19277:19314,20246:20270,20667:20681,20697:20736,20759:20763,20774:20839,21506:21576,21590:21647 )' = c(-79.999 , 199.999),  # DTL_kso::k.sol | change = pctchg 
  'DTL_bd::bd.sol | change = pctchg | unit =       c(  7:42,336:363,383:431,467:492,607:614,777:857,888:944,983:1051,1100:1119,1137:1180,1715:1744,1877:1904,2385:2412,2443:2552,2624:2661,2692:2715,3079:3216,3264:3288,3611:3622,3652:3673,3702:3717,3815:3879,3935:3976,4109:4163,4257:4401,4434:4537,4635:4660,4748:4772,4787:4792,5872:5899,6380:6413,6567:6583,6648:6679,6707:6732,6780:6824,7554:7687,7718:7745,7754:7767,8038:8051,8069:8087,9670:9682,9922:9938,9962:9975,10354:10367,10393:10404,10497:10510,10654:10667,10695:10732,10920:10941,10966:10991,11512:11560,11617:11628,11636:11658,11795:11818,12535:12571,13034:13053,13209:13222,13282:13291,13363:13372,13537:13654,13668:13703,13724:13733,13760:13806,13834:13917,13993:14101,14112:14207,14225:14249,14256:14324,14347:14352,14429:14452,14537:14549,14674:14692,14770:14809,14827:14865,14902:14952,14992:15006,15101:15135,15143:15171,15173:15201,15314:15350,15401:15422,15435:15456,15497:15521,15564:15607,15637:15671,16104:16111,16210:16214,16246:16287,16420:16430,16441:16452,16611:16660,16688:16716,16775:17038,17076:17100,17142:17238,17287:17309,17344:17367,17455:17522,17981:18028,18081:18122,18255:18291,18407:18416,18428:18434,18467:18491,18499:18513,18751:18755,18826:18895,18911:18974,19277:19314,20246:20270,20667:20681,20697:20736,20759:20763,20774:20839,21506:21576,21590:21647 )' = c(-29.999 , 29.999))   # DTL_bd::bd.sol | change = pctchg 

IMPHRUS <-  c( 53:67,97:229,432:466,493:537,600:606,626:676,697:716,757:770,1277:1414,1421:1428,1446:1454,1459:1478,1529:1532,1789:1876,2059:2339,2347:2352,2361:2384,3299:3459,5420:5443,5900:5950,5963:5976,5991:6086,7311:7366,7375:7449,7458:7530,8425:8494,8507:8533,8537:8557,9233:9368,9687:9817,10017:10147,11027:11069,11085:11100,11115:11122,11135:11141,11338:11483,11847:12117,12275:12446,13061:13125,13154:13188,15748:15772,15795:15818,15835:15847,15877:15913,15962:15972,16484:16514,17368:17399,17523:17629,17693:17721,18613:18639,19239:19254,19574:19588,19593:19638,19794:19853,19876:19918,19975:20043,20073:20191,20344:20666,20850:21100,21168:21202,21313:21322,21338:21353,21390:21441,21462:21479,21925:21955,21989:22001,22006:22044,22069:22089)

CRBHRUS <- c( 1:6,43:52,68:96,364:382,615:625,771:776,858:887,1052:1059,1092:1099,1120:1136,1181:1199,1217:1276,1429:1445,1653:1714,1745:1749,1905:2007,2042:2058,2413:2442,2553:2623,2662:2691,2716:2900,2917:2936,2970:2999,3019:3054,3077:3078,3217:3263,3880:3934,3977:4080,4164:4256,4402:4433,4538:4634,4662:4747,4773:4786,4793:4832,5795:5845,6164:6238,6441:6453,6460:6504,6531:6566,6584:6647,6680:6706,6733:6779,6846:6895,6916:6976,6998:7008,7035:7039,7133:7136,7190:7310,7854:7862,8118:8192,8248:8258,8273:8424,8683:8713,8730:8777,9058:9232,9369:9461,9469:9488,9493:9504,9509:9539,9556:9603,10193:10275,10302:10314,10328:10353,10368:10392,10405:10496,10511:10653,10733:10765,10873:10899,10992:11026,11305:11337,11697:11721,11819:11846,12118:12122,12197:12210,12263:12274,12481:12483,12504:12510,13189:13208,13223:13237,13494:13501,13655:13667,13971:13985,14329:14346,14709:14722,14743:14769,14810:14826,14888:14901,14953:14991,15007:15059,15136:15142,15202:15220,17246:17279,17310:17343,17437:17454,18123:18142,18218:18233,18514:18535,18896:18910,19255:19276,19395:19405,20218:20245,20749:20758,20840:20849,21209:21213,21226:21235)

DTHHRUS <- c( 230:335,538:599,677:696,717:756,945:982,1060:1091,1200:1216,1415:1420,1455:1458,1479:1528,1533:1652,1750:1788,2008:2041,2340:2346,2353:2360,2901:2916,2937:2969,3000:3018,3055:3076,3289:3298,3460:3610,3623:3651,3674:3701,3718:3814,4081:4108,4661:4661,4833:5419,5444:5794,5846:5871,5951:5962,5977:5990,6087:6163,6239:6379,6414:6440,6454:6459,6505:6530,6825:6845,6896:6915,6977:6997,7009:7034,7040:7132,7137:7189,7367:7374,7450:7457,7531:7553,7688:7717,7746:7753,7768:7853,7863:8037,8052:8068,8088:8117,8193:8247,8259:8272,8495:8506,8534:8536,8558:8682,8714:8729,8778:9057,9462:9468,9489:9492,9505:9508,9540:9555,9604:9669,9683:9686,9818:9921,9939:9961,9976:10016,10148:10192,10276:10301,10315:10327,10668:10694,10766:10872,10900:10919,10942:10965,11070:11084,11101:11114,11123:11134,11142:11304,11484:11511,11561:11616,11629:11635,11659:11696,11722:11794,12123:12196,12211:12262,12447:12480,12484:12503,12511:12534,12572:13033,13054:13060,13126:13153,13238:13281,13292:13362,13373:13493,13502:13536,13704:13723,13734:13759,13807:13833,13918:13970,13986:13992,14102:14111,14208:14224,14250:14255,14325:14328,14353:14428,14453:14536,14550:14673,14693:14708,14723:14742,14866:14887,15060:15100,15172:15172,15221:15313,15351:15400,15423:15434,15457:15496,15522:15563,15608:15636,15672:15747,15773:15794,15819:15834,15848:15876,15914:15961,15973:16103,16112:16209,16215:16245,16288:16419,16431:16440,16453:16483,16515:16610,16661:16687,16717:16774,17039:17075,17101:17141,17239:17245,17280:17286,17400:17436,17630:17692,17722:17980,18029:18080,18143:18217,18234:18254,18292:18406,18417:18427,18435:18466,18492:18498,18536:18612,18640:18750,18756:18825,18975:19238,19315:19394,19406:19573,19589:19592,19639:19793,19854:19875,19919:19974,20044:20072,20192:20217,20271:20343,20682:20696,20737:20748,20764:20773,21101:21167,21203:21208,21214:21225,21236:21312,21323:21337,21354:21389,21442:21461,21480:21505,21577:21589,21648:21924,21956:21988,22002:22005,22045:22068)

DTLHRUS <- c( 7:42,336:363,383:431,467:492,607:614,777:857,888:944,983:1051,1100:1119,1137:1180,1715:1744,1877:1904,2385:2412,2443:2552,2624:2661,2692:2715,3079:3216,3264:3288,3611:3622,3652:3673,3702:3717,3815:3879,3935:3976,4109:4163,4257:4401,4434:4537,4635:4660,4748:4772,4787:4792,5872:5899,6380:6413,6567:6583,6648:6679,6707:6732,6780:6824,7554:7687,7718:7745,7754:7767,8038:8051,8069:8087,9670:9682,9922:9938,9962:9975,10354:10367,10393:10404,10497:10510,10654:10667,10695:10732,10920:10941,10966:10991,11512:11560,11617:11628,11636:11658,11795:11818,12535:12571,13034:13053,13209:13222,13282:13291,13363:13372,13537:13654,13668:13703,13724:13733,13760:13806,13834:13917,13993:14101,14112:14207,14225:14249,14256:14324,14347:14352,14429:14452,14537:14549,14674:14692,14770:14809,14827:14865,14902:14952,14992:15006,15101:15135,15143:15171,15173:15201,15314:15350,15401:15422,15435:15456,15497:15521,15564:15607,15637:15671,16104:16111,16210:16214,16246:16287,16420:16430,16441:16452,16611:16660,16688:16716,16775:17038,17076:17100,17142:17238,17287:17309,17344:17367,17455:17522,17981:18028,18081:18122,18255:18291,18407:18416,18428:18434,18467:18491,18499:18513,18751:18755,18826:18895,18911:18974,19277:19314,20246:20270,20667:20681,20697:20736,20759:20763,20774:20839,21506:21576,21590:21647)

# Checking if the total number of units is equal to the total number of HRUs of the model (22089)
length(IMPHRUS)+length(CRBHRUS)+length(DTHHRUS)+length(DTLHRUS)

rm(IMPHRUS, CRBHRUS, DTHHRUS, DTLHRUS)

# Number of Simulations
n_sample <- 1000
#Numer of parameters
n_par <- ncol(par_bound_zonal)

#Random sampling with Latin Hypercube
par_zonal_tag <- randomLHS(n = n_sample, k = n_par) %>% # Perform sampling
  as_tibble(., .name_repair = 'minimal') %>% # Convert to a tibble
  set_names(names(par_bound_zonal)) %>% # Assign the parameter names with purrr
  map2_df(., par_bound_zonal, ~ (.x * (.y[2] - .y[1]) + .y[1]))



#Parameters ranges for the second round
par_bound_zonal_r2 <- tibble(
  'IMP_esc::esco.hru | change = absval | unit =    c(53:67,97:229,432:466,493:537,600:606,626:676,697:716,757:770,1277:1414,1421:1428,1446:1454,1459:1478,1529:1532,1789:1876,2059:2339,2347:2352,2361:2384,3299:3459,5420:5443,5900:5950,5963:5976,5991:6086,7311:7366,7375:7449,7458:7530,8425:8494,8507:8533,8537:8557,9233:9368,9687:9817,10017:10147,11027:11069,11085:11100,11115:11122,11135:11141,11338:11483,11847:12117,12275:12446,13061:13125,13154:13188,15748:15772,15795:15818,15835:15847,15877:15913,15962:15972,16484:16514,17368:17399,17523:17629,17693:17721,18613:18639,19239:19254,19574:19588,19593:19638,19794:19853,19876:19918,19975:20043,20073:20191,20344:20666,20850:21100,21168:21202,21313:21322,21338:21353,21390:21441,21462:21479,21925:21955,21989:22001,22006:22044,22069:22089)' = c(0.25, 0.999),       # 'IMP_esc::esco.hru | change = absval             
  'IMP_epc::epco.hru | change = absval | unit =    c(53:67,97:229,432:466,493:537,600:606,626:676,697:716,757:770,1277:1414,1421:1428,1446:1454,1459:1478,1529:1532,1789:1876,2059:2339,2347:2352,2361:2384,3299:3459,5420:5443,5900:5950,5963:5976,5991:6086,7311:7366,7375:7449,7458:7530,8425:8494,8507:8533,8537:8557,9233:9368,9687:9817,10017:10147,11027:11069,11085:11100,11115:11122,11135:11141,11338:11483,11847:12117,12275:12446,13061:13125,13154:13188,15748:15772,15795:15818,15835:15847,15877:15913,15962:15972,16484:16514,17368:17399,17523:17629,17693:17721,18613:18639,19239:19254,19574:19588,19593:19638,19794:19853,19876:19918,19975:20043,20073:20191,20344:20666,20850:21100,21168:21202,21313:21322,21338:21353,21390:21441,21462:21479,21925:21955,21989:22001,22006:22044,22069:22089)' = c(0.25, 0.999),       # 'IMP_epc::epco.hru | change = absval  
  'IMP_cnn::cn2.hru | change = pctchg | unit =     c(53:67,97:229,432:466,493:537,600:606,626:676,697:716,757:770,1277:1414,1421:1428,1446:1454,1459:1478,1529:1532,1789:1876,2059:2339,2347:2352,2361:2384,3299:3459,5420:5443,5900:5950,5963:5976,5991:6086,7311:7366,7375:7449,7458:7530,8425:8494,8507:8533,8537:8557,9233:9368,9687:9817,10017:10147,11027:11069,11085:11100,11115:11122,11135:11141,11338:11483,11847:12117,12275:12446,13061:13125,13154:13188,15748:15772,15795:15818,15835:15847,15877:15913,15962:15972,16484:16514,17368:17399,17523:17629,17693:17721,18613:18639,19239:19254,19574:19588,19593:19638,19794:19853,19876:19918,19975:20043,20073:20191,20344:20666,20850:21100,21168:21202,21313:21322,21338:21353,21390:21441,21462:21479,21925:21955,21989:22001,22006:22044,22069:22089)' = c(-29.999  ,  20),  # 'IMP_cnn::cn2.hru | change = pctchg     
  'IMP_awc::awc.sol | change = pctchg | unit =     c(53:67,97:229,432:466,493:537,600:606,626:676,697:716,757:770,1277:1414,1421:1428,1446:1454,1459:1478,1529:1532,1789:1876,2059:2339,2347:2352,2361:2384,3299:3459,5420:5443,5900:5950,5963:5976,5991:6086,7311:7366,7375:7449,7458:7530,8425:8494,8507:8533,8537:8557,9233:9368,9687:9817,10017:10147,11027:11069,11085:11100,11115:11122,11135:11141,11338:11483,11847:12117,12275:12446,13061:13125,13154:13188,15748:15772,15795:15818,15835:15847,15877:15913,15962:15972,16484:16514,17368:17399,17523:17629,17693:17721,18613:18639,19239:19254,19574:19588,19593:19638,19794:19853,19876:19918,19975:20043,20073:20191,20344:20666,20850:21100,21168:21202,21313:21322,21338:21353,21390:21441,21462:21479,21925:21955,21989:22001,22006:22044,22069:22089)' = c(-30 , 59.999),    # 'IMP_awc::awc.sol | change = pctchg    
  'IMP_per::perco.hru | change = absval | unit =   c(53:67,97:229,432:466,493:537,600:606,626:676,697:716,757:770,1277:1414,1421:1428,1446:1454,1459:1478,1529:1532,1789:1876,2059:2339,2347:2352,2361:2384,3299:3459,5420:5443,5900:5950,5963:5976,5991:6086,7311:7366,7375:7449,7458:7530,8425:8494,8507:8533,8537:8557,9233:9368,9687:9817,10017:10147,11027:11069,11085:11100,11115:11122,11135:11141,11338:11483,11847:12117,12275:12446,13061:13125,13154:13188,15748:15772,15795:15818,15835:15847,15877:15913,15962:15972,16484:16514,17368:17399,17523:17629,17693:17721,18613:18639,19239:19254,19574:19588,19593:19638,19794:19853,19876:19918,19975:20043,20073:20191,20344:20666,20850:21100,21168:21202,21313:21322,21338:21353,21390:21441,21462:21479,21925:21955,21989:22001,22006:22044,22069:22089)' = c(0.2 , 0.4),         # 'IMP_per::perco.hru | change = absval   
  'IMP_latq::latq_co.hru | change = abschg | unit =   c(53:67,97:229,432:466,493:537,600:606,626:676,697:716,757:770,1277:1414,1421:1428,1446:1454,1459:1478,1529:1532,1789:1876,2059:2339,2347:2352,2361:2384,3299:3459,5420:5443,5900:5950,5963:5976,5991:6086,7311:7366,7375:7449,7458:7530,8425:8494,8507:8533,8537:8557,9233:9368,9687:9817,10017:10147,11027:11069,11085:11100,11115:11122,11135:11141,11338:11483,11847:12117,12275:12446,13061:13125,13154:13188,15748:15772,15795:15818,15835:15847,15877:15913,15962:15972,16484:16514,17368:17399,17523:17629,17693:17721,18613:18639,19239:19254,19574:19588,19593:19638,19794:19853,19876:19918,19975:20043,20073:20191,20344:20666,20850:21100,21168:21202,21313:21322,21338:21353,21390:21441,21462:21479,21925:21955,21989:22001,22006:22044,22069:22089)' = c(-0.5, 0.375),        # 'IMP_latq::latq_co.hru | change = abschg  
  'IMP_cn3::cn3_swf.hru | change = abschg | unit = c(53:67,97:229,432:466,493:537,600:606,626:676,697:716,757:770,1277:1414,1421:1428,1446:1454,1459:1478,1529:1532,1789:1876,2059:2339,2347:2352,2361:2384,3299:3459,5420:5443,5900:5950,5963:5976,5991:6086,7311:7366,7375:7449,7458:7530,8425:8494,8507:8533,8537:8557,9233:9368,9687:9817,10017:10147,11027:11069,11085:11100,11115:11122,11135:11141,11338:11483,11847:12117,12275:12446,13061:13125,13154:13188,15748:15772,15795:15818,15835:15847,15877:15913,15962:15972,16484:16514,17368:17399,17523:17629,17693:17721,18613:18639,19239:19254,19574:19588,19593:19638,19794:19853,19876:19918,19975:20043,20073:20191,20344:20666,20850:21100,21168:21202,21313:21322,21338:21353,21390:21441,21462:21479,21925:21955,21989:22001,22006:22044,22069:22089)' = c(-0.25, 0.5),           # 'IMP_cn3::cn3_swf.hru | change = abschg        
  'IMP_zso::z.sol | change = pctchg | unit =       c(53:67,97:229,432:466,493:537,600:606,626:676,697:716,757:770,1277:1414,1421:1428,1446:1454,1459:1478,1529:1532,1789:1876,2059:2339,2347:2352,2361:2384,3299:3459,5420:5443,5900:5950,5963:5976,5991:6086,7311:7366,7375:7449,7458:7530,8425:8494,8507:8533,8537:8557,9233:9368,9687:9817,10017:10147,11027:11069,11085:11100,11115:11122,11135:11141,11338:11483,11847:12117,12275:12446,13061:13125,13154:13188,15748:15772,15795:15818,15835:15847,15877:15913,15962:15972,16484:16514,17368:17399,17523:17629,17693:17721,18613:18639,19239:19254,19574:19588,19593:19638,19794:19853,19876:19918,19975:20043,20073:20191,20344:20666,20850:21100,21168:21202,21313:21322,21338:21353,21390:21441,21462:21479,21925:21955,21989:22001,22006:22044,22069:22089)' = c(-25 , 49.999),    # 'IMP_zso::z.sol | change = pctchg 
  'IMP_kso::k.sol | change = pctchg | unit =       c(53:67,97:229,432:466,493:537,600:606,626:676,697:716,757:770,1277:1414,1421:1428,1446:1454,1459:1478,1529:1532,1789:1876,2059:2339,2347:2352,2361:2384,3299:3459,5420:5443,5900:5950,5963:5976,5991:6086,7311:7366,7375:7449,7458:7530,8425:8494,8507:8533,8537:8557,9233:9368,9687:9817,10017:10147,11027:11069,11085:11100,11115:11122,11135:11141,11338:11483,11847:12117,12275:12446,13061:13125,13154:13188,15748:15772,15795:15818,15835:15847,15877:15913,15962:15972,16484:16514,17368:17399,17523:17629,17693:17721,18613:18639,19239:19254,19574:19588,19593:19638,19794:19853,19876:19918,19975:20043,20073:20191,20344:20666,20850:21100,21168:21202,21313:21322,21338:21353,21390:21441,21462:21479,21925:21955,21989:22001,22006:22044,22069:22089)' = c(-79.999 , 199.999),   # 'IMP_kso::k.sol | change = pctchg 
  'IMP_bd::bd.sol | change = pctchg | unit =       c(53:67,97:229,432:466,493:537,600:606,626:676,697:716,757:770,1277:1414,1421:1428,1446:1454,1459:1478,1529:1532,1789:1876,2059:2339,2347:2352,2361:2384,3299:3459,5420:5443,5900:5950,5963:5976,5991:6086,7311:7366,7375:7449,7458:7530,8425:8494,8507:8533,8537:8557,9233:9368,9687:9817,10017:10147,11027:11069,11085:11100,11115:11122,11135:11141,11338:11483,11847:12117,12275:12446,13061:13125,13154:13188,15748:15772,15795:15818,15835:15847,15877:15913,15962:15972,16484:16514,17368:17399,17523:17629,17693:17721,18613:18639,19239:19254,19574:19588,19593:19638,19794:19853,19876:19918,19975:20043,20073:20191,20344:20666,20850:21100,21168:21202,21313:21322,21338:21353,21390:21441,21462:21479,21925:21955,21989:22001,22006:22044,22069:22089)' = c(-29.999 , 10),    # 'IMP_bd::bd.sol | change = pctchg 
  
  
  'CRB_esc::esco.hru | change = absval | unit =    c(1:6,43:52,68:96,364:382,615:625,771:776,858:887,1052:1059,1092:1099,1120:1136,1181:1199,1217:1276,1429:1445,1653:1714,1745:1749,1905:2007,2042:2058,2413:2442,2553:2623,2662:2691,2716:2900,2917:2936,2970:2999,3019:3054,3077:3078,3217:3263,3880:3934,3977:4080,4164:4256,4402:4433,4538:4634,4662:4747,4773:4786,4793:4832,5795:5845,6164:6238,6441:6453,6460:6504,6531:6566,6584:6647,6680:6706,6733:6779,6846:6895,6916:6976,6998:7008,7035:7039,7133:7136,7190:7310,7854:7862,8118:8192,8248:8258,8273:8424,8683:8713,8730:8777,9058:9232,9369:9461,9469:9488,9493:9504,9509:9539,9556:9603,10193:10275,10302:10314,10328:10353,10368:10392,10405:10496,10511:10653,10733:10765,10873:10899,10992:11026,11305:11337,11697:11721,11819:11846,12118:12122,12197:12210,12263:12274,12481:12483,12504:12510,13189:13208,13223:13237,13494:13501,13655:13667,13971:13985,14329:14346,14709:14722,14743:14769,14810:14826,14888:14901,14953:14991,15007:15059,15136:15142,15202:15220,17246:17279,17310:17343,17437:17454,18123:18142,18218:18233,18514:18535,18896:18910,19255:19276,19395:19405,20218:20245,20749:20758,20840:20849,21209:21213,21226:21235)' = c(0.001 , 0.999),        # CRB_esc::esco.hru | change = absval           
  'CRB_epc::epco.hru | change = absval | unit =    c(1:6,43:52,68:96,364:382,615:625,771:776,858:887,1052:1059,1092:1099,1120:1136,1181:1199,1217:1276,1429:1445,1653:1714,1745:1749,1905:2007,2042:2058,2413:2442,2553:2623,2662:2691,2716:2900,2917:2936,2970:2999,3019:3054,3077:3078,3217:3263,3880:3934,3977:4080,4164:4256,4402:4433,4538:4634,4662:4747,4773:4786,4793:4832,5795:5845,6164:6238,6441:6453,6460:6504,6531:6566,6584:6647,6680:6706,6733:6779,6846:6895,6916:6976,6998:7008,7035:7039,7133:7136,7190:7310,7854:7862,8118:8192,8248:8258,8273:8424,8683:8713,8730:8777,9058:9232,9369:9461,9469:9488,9493:9504,9509:9539,9556:9603,10193:10275,10302:10314,10328:10353,10368:10392,10405:10496,10511:10653,10733:10765,10873:10899,10992:11026,11305:11337,11697:11721,11819:11846,12118:12122,12197:12210,12263:12274,12481:12483,12504:12510,13189:13208,13223:13237,13494:13501,13655:13667,13971:13985,14329:14346,14709:14722,14743:14769,14810:14826,14888:14901,14953:14991,15007:15059,15136:15142,15202:15220,17246:17279,17310:17343,17437:17454,18123:18142,18218:18233,18514:18535,18896:18910,19255:19276,19395:19405,20218:20245,20749:20758,20840:20849,21209:21213,21226:21235)' = c(0.001 , 0.999),        # CRB_epc::epco.hru | change = absval   
  'CRB_cnn::cn2.hru | change = pctchg | unit =     c(1:6,43:52,68:96,364:382,615:625,771:776,858:887,1052:1059,1092:1099,1120:1136,1181:1199,1217:1276,1429:1445,1653:1714,1745:1749,1905:2007,2042:2058,2413:2442,2553:2623,2662:2691,2716:2900,2917:2936,2970:2999,3019:3054,3077:3078,3217:3263,3880:3934,3977:4080,4164:4256,4402:4433,4538:4634,4662:4747,4773:4786,4793:4832,5795:5845,6164:6238,6441:6453,6460:6504,6531:6566,6584:6647,6680:6706,6733:6779,6846:6895,6916:6976,6998:7008,7035:7039,7133:7136,7190:7310,7854:7862,8118:8192,8248:8258,8273:8424,8683:8713,8730:8777,9058:9232,9369:9461,9469:9488,9493:9504,9509:9539,9556:9603,10193:10275,10302:10314,10328:10353,10368:10392,10405:10496,10511:10653,10733:10765,10873:10899,10992:11026,11305:11337,11697:11721,11819:11846,12118:12122,12197:12210,12263:12274,12481:12483,12504:12510,13189:13208,13223:13237,13494:13501,13655:13667,13971:13985,14329:14346,14709:14722,14743:14769,14810:14826,14888:14901,14953:14991,15007:15059,15136:15142,15202:15220,17246:17279,17310:17343,17437:17454,18123:18142,18218:18233,18514:18535,18896:18910,19255:19276,19395:19405,20218:20245,20749:20758,20840:20849,21209:21213,21226:21235)' = c(-20  ,  20),   # CRB_cnn::cn2.hru | change = pctchg           
  'CRB_awc::awc.sol | change = pctchg | unit =     c(1:6,43:52,68:96,364:382,615:625,771:776,858:887,1052:1059,1092:1099,1120:1136,1181:1199,1217:1276,1429:1445,1653:1714,1745:1749,1905:2007,2042:2058,2413:2442,2553:2623,2662:2691,2716:2900,2917:2936,2970:2999,3019:3054,3077:3078,3217:3263,3880:3934,3977:4080,4164:4256,4402:4433,4538:4634,4662:4747,4773:4786,4793:4832,5795:5845,6164:6238,6441:6453,6460:6504,6531:6566,6584:6647,6680:6706,6733:6779,6846:6895,6916:6976,6998:7008,7035:7039,7133:7136,7190:7310,7854:7862,8118:8192,8248:8258,8273:8424,8683:8713,8730:8777,9058:9232,9369:9461,9469:9488,9493:9504,9509:9539,9556:9603,10193:10275,10302:10314,10328:10353,10368:10392,10405:10496,10511:10653,10733:10765,10873:10899,10992:11026,11305:11337,11697:11721,11819:11846,12118:12122,12197:12210,12263:12274,12481:12483,12504:12510,13189:13208,13223:13237,13494:13501,13655:13667,13971:13985,14329:14346,14709:14722,14743:14769,14810:14826,14888:14901,14953:14991,15007:15059,15136:15142,15202:15220,17246:17279,17310:17343,17437:17454,18123:18142,18218:18233,18514:18535,18896:18910,19255:19276,19395:19405,20218:20245,20749:20758,20840:20849,21209:21213,21226:21235)' = c(-59.999 , 15),     # CRB_awc::awc.sol | change = pctchg       
  'CRB_per::perco.hru | change = absval | unit =   c(1:6,43:52,68:96,364:382,615:625,771:776,858:887,1052:1059,1092:1099,1120:1136,1181:1199,1217:1276,1429:1445,1653:1714,1745:1749,1905:2007,2042:2058,2413:2442,2553:2623,2662:2691,2716:2900,2917:2936,2970:2999,3019:3054,3077:3078,3217:3263,3880:3934,3977:4080,4164:4256,4402:4433,4538:4634,4662:4747,4773:4786,4793:4832,5795:5845,6164:6238,6441:6453,6460:6504,6531:6566,6584:6647,6680:6706,6733:6779,6846:6895,6916:6976,6998:7008,7035:7039,7133:7136,7190:7310,7854:7862,8118:8192,8248:8258,8273:8424,8683:8713,8730:8777,9058:9232,9369:9461,9469:9488,9493:9504,9509:9539,9556:9603,10193:10275,10302:10314,10328:10353,10368:10392,10405:10496,10511:10653,10733:10765,10873:10899,10992:11026,11305:11337,11697:11721,11819:11846,12118:12122,12197:12210,12263:12274,12481:12483,12504:12510,13189:13208,13223:13237,13494:13501,13655:13667,13971:13985,14329:14346,14709:14722,14743:14769,14810:14826,14888:14901,14953:14991,15007:15059,15136:15142,15202:15220,17246:17279,17310:17343,17437:17454,18123:18142,18218:18233,18514:18535,18896:18910,19255:19276,19395:19405,20218:20245,20749:20758,20840:20849,21209:21213,21226:21235)' = c(0.7 , 0.999),          # CRB_per::perco.hru | change = absval
  'CRB_latq::latq_co.hru | change = abschg | unit =   c(1:6,43:52,68:96,364:382,615:625,771:776,858:887,1052:1059,1092:1099,1120:1136,1181:1199,1217:1276,1429:1445,1653:1714,1745:1749,1905:2007,2042:2058,2413:2442,2553:2623,2662:2691,2716:2900,2917:2936,2970:2999,3019:3054,3077:3078,3217:3263,3880:3934,3977:4080,4164:4256,4402:4433,4538:4634,4662:4747,4773:4786,4793:4832,5795:5845,6164:6238,6441:6453,6460:6504,6531:6566,6584:6647,6680:6706,6733:6779,6846:6895,6916:6976,6998:7008,7035:7039,7133:7136,7190:7310,7854:7862,8118:8192,8248:8258,8273:8424,8683:8713,8730:8777,9058:9232,9369:9461,9469:9488,9493:9504,9509:9539,9556:9603,10193:10275,10302:10314,10328:10353,10368:10392,10405:10496,10511:10653,10733:10765,10873:10899,10992:11026,11305:11337,11697:11721,11819:11846,12118:12122,12197:12210,12263:12274,12481:12483,12504:12510,13189:13208,13223:13237,13494:13501,13655:13667,13971:13985,14329:14346,14709:14722,14743:14769,14810:14826,14888:14901,14953:14991,15007:15059,15136:15142,15202:15220,17246:17279,17310:17343,17437:17454,18123:18142,18218:18233,18514:18535,18896:18910,19255:19276,19395:19405,20218:20245,20749:20758,20840:20849,21209:21213,21226:21235)' = c(-0.5, 0.5),         # CRB_latq::latq_co.hru | change = abschg    
  'CRB_cn3::cn3_swf.hru | change = abschg | unit = c(1:6,43:52,68:96,364:382,615:625,771:776,858:887,1052:1059,1092:1099,1120:1136,1181:1199,1217:1276,1429:1445,1653:1714,1745:1749,1905:2007,2042:2058,2413:2442,2553:2623,2662:2691,2716:2900,2917:2936,2970:2999,3019:3054,3077:3078,3217:3263,3880:3934,3977:4080,4164:4256,4402:4433,4538:4634,4662:4747,4773:4786,4793:4832,5795:5845,6164:6238,6441:6453,6460:6504,6531:6566,6584:6647,6680:6706,6733:6779,6846:6895,6916:6976,6998:7008,7035:7039,7133:7136,7190:7310,7854:7862,8118:8192,8248:8258,8273:8424,8683:8713,8730:8777,9058:9232,9369:9461,9469:9488,9493:9504,9509:9539,9556:9603,10193:10275,10302:10314,10328:10353,10368:10392,10405:10496,10511:10653,10733:10765,10873:10899,10992:11026,11305:11337,11697:11721,11819:11846,12118:12122,12197:12210,12263:12274,12481:12483,12504:12510,13189:13208,13223:13237,13494:13501,13655:13667,13971:13985,14329:14346,14709:14722,14743:14769,14810:14826,14888:14901,14953:14991,15007:15059,15136:15142,15202:15220,17246:17279,17310:17343,17437:17454,18123:18142,18218:18233,18514:18535,18896:18910,19255:19276,19395:19405,20218:20245,20749:20758,20840:20849,21209:21213,21226:21235)' = c(-0.25, 0.5),            # CRB_cn3::cn3_swf.hru | change = abschg         
  'CRB_zso::z.sol | change = pctchg | unit =       c(1:6,43:52,68:96,364:382,615:625,771:776,858:887,1052:1059,1092:1099,1120:1136,1181:1199,1217:1276,1429:1445,1653:1714,1745:1749,1905:2007,2042:2058,2413:2442,2553:2623,2662:2691,2716:2900,2917:2936,2970:2999,3019:3054,3077:3078,3217:3263,3880:3934,3977:4080,4164:4256,4402:4433,4538:4634,4662:4747,4773:4786,4793:4832,5795:5845,6164:6238,6441:6453,6460:6504,6531:6566,6584:6647,6680:6706,6733:6779,6846:6895,6916:6976,6998:7008,7035:7039,7133:7136,7190:7310,7854:7862,8118:8192,8248:8258,8273:8424,8683:8713,8730:8777,9058:9232,9369:9461,9469:9488,9493:9504,9509:9539,9556:9603,10193:10275,10302:10314,10328:10353,10368:10392,10405:10496,10511:10653,10733:10765,10873:10899,10992:11026,11305:11337,11697:11721,11819:11846,12118:12122,12197:12210,12263:12274,12481:12483,12504:12510,13189:13208,13223:13237,13494:13501,13655:13667,13971:13985,14329:14346,14709:14722,14743:14769,14810:14826,14888:14901,14953:14991,15007:15059,15136:15142,15202:15220,17246:17279,17310:17343,17437:17454,18123:18142,18218:18233,18514:18535,18896:18910,19255:19276,19395:19405,20218:20245,20749:20758,20840:20849,21209:21213,21226:21235)' = c(-49.999 , 25),     # CRB_zso::z.sol | change = pctchg       
  'CRB_kso::k.sol | change = pctchg | unit =       c(1:6,43:52,68:96,364:382,615:625,771:776,858:887,1052:1059,1092:1099,1120:1136,1181:1199,1217:1276,1429:1445,1653:1714,1745:1749,1905:2007,2042:2058,2413:2442,2553:2623,2662:2691,2716:2900,2917:2936,2970:2999,3019:3054,3077:3078,3217:3263,3880:3934,3977:4080,4164:4256,4402:4433,4538:4634,4662:4747,4773:4786,4793:4832,5795:5845,6164:6238,6441:6453,6460:6504,6531:6566,6584:6647,6680:6706,6733:6779,6846:6895,6916:6976,6998:7008,7035:7039,7133:7136,7190:7310,7854:7862,8118:8192,8248:8258,8273:8424,8683:8713,8730:8777,9058:9232,9369:9461,9469:9488,9493:9504,9509:9539,9556:9603,10193:10275,10302:10314,10328:10353,10368:10392,10405:10496,10511:10653,10733:10765,10873:10899,10992:11026,11305:11337,11697:11721,11819:11846,12118:12122,12197:12210,12263:12274,12481:12483,12504:12510,13189:13208,13223:13237,13494:13501,13655:13667,13971:13985,14329:14346,14709:14722,14743:14769,14810:14826,14888:14901,14953:14991,15007:15059,15136:15142,15202:15220,17246:17279,17310:17343,17437:17454,18123:18142,18218:18233,18514:18535,18896:18910,19255:19276,19395:19405,20218:20245,20749:20758,20840:20849,21209:21213,21226:21235)' = c(-79.999 , 199.999),    # CRB_kso::k.sol | change = pctchg        
  'CRB_bd::bd.sol | change = pctchg | unit =       c(1:6,43:52,68:96,364:382,615:625,771:776,858:887,1052:1059,1092:1099,1120:1136,1181:1199,1217:1276,1429:1445,1653:1714,1745:1749,1905:2007,2042:2058,2413:2442,2553:2623,2662:2691,2716:2900,2917:2936,2970:2999,3019:3054,3077:3078,3217:3263,3880:3934,3977:4080,4164:4256,4402:4433,4538:4634,4662:4747,4773:4786,4793:4832,5795:5845,6164:6238,6441:6453,6460:6504,6531:6566,6584:6647,6680:6706,6733:6779,6846:6895,6916:6976,6998:7008,7035:7039,7133:7136,7190:7310,7854:7862,8118:8192,8248:8258,8273:8424,8683:8713,8730:8777,9058:9232,9369:9461,9469:9488,9493:9504,9509:9539,9556:9603,10193:10275,10302:10314,10328:10353,10368:10392,10405:10496,10511:10653,10733:10765,10873:10899,10992:11026,11305:11337,11697:11721,11819:11846,12118:12122,12197:12210,12263:12274,12481:12483,12504:12510,13189:13208,13223:13237,13494:13501,13655:13667,13971:13985,14329:14346,14709:14722,14743:14769,14810:14826,14888:14901,14953:14991,15007:15059,15136:15142,15202:15220,17246:17279,17310:17343,17437:17454,18123:18142,18218:18233,18514:18535,18896:18910,19255:19276,19395:19405,20218:20245,20749:20758,20840:20849,21209:21213,21226:21235)' = c(-29.999 , 10),     # CRB_bd::bd.sol | change = pctchg      
  
  
  'DTH_esc::esco.hru | change = absval | unit =    c( 230:335,538:599,677:696,717:756,945:982,1060:1091,1200:1216,1415:1420,1455:1458,1479:1528,1533:1652,1750:1788,2008:2041,2340:2346,2353:2360,2901:2916,2937:2969,3000:3018,3055:3076,3289:3298,3460:3610,3623:3651,3674:3701,3718:3814,4081:4108,4661:4661,4833:5419,5444:5794,5846:5871,5951:5962,5977:5990,6087:6163,6239:6379,6414:6440,6454:6459,6505:6530,6825:6845,6896:6915,6977:6997,7009:7034,7040:7132,7137:7189,7367:7374,7450:7457,7531:7553,7688:7717,7746:7753,7768:7853,7863:8037,8052:8068,8088:8117,8193:8247,8259:8272,8495:8506,8534:8536,8558:8682,8714:8729,8778:9057,9462:9468,9489:9492,9505:9508,9540:9555,9604:9669,9683:9686,9818:9921,9939:9961,9976:10016,10148:10192,10276:10301,10315:10327,10668:10694,10766:10872,10900:10919,10942:10965,11070:11084,11101:11114,11123:11134,11142:11304,11484:11511,11561:11616,11629:11635,11659:11696,11722:11794,12123:12196,12211:12262,12447:12480,12484:12503,12511:12534,12572:13033,13054:13060,13126:13153,13238:13281,13292:13362,13373:13493,13502:13536,13704:13723,13734:13759,13807:13833,13918:13970,13986:13992,14102:14111,14208:14224,14250:14255,14325:14328,14353:14428,14453:14536,14550:14673,14693:14708,14723:14742,14866:14887,15060:15100,15172:15172,15221:15313,15351:15400,15423:15434,15457:15496,15522:15563,15608:15636,15672:15747,15773:15794,15819:15834,15848:15876,15914:15961,15973:16103,16112:16209,16215:16245,16288:16419,16431:16440,16453:16483,16515:16610,16661:16687,16717:16774,17039:17075,17101:17141,17239:17245,17280:17286,17400:17436,17630:17692,17722:17980,18029:18080,18143:18217,18234:18254,18292:18406,18417:18427,18435:18466,18492:18498,18536:18612,18640:18750,18756:18825,18975:19238,19315:19394,19406:19573,19589:19592,19639:19793,19854:19875,19919:19974,20044:20072,20192:20217,20271:20343,20682:20696,20737:20748,20764:20773,21101:21167,21203:21208,21214:21225,21236:21312,21323:21337,21354:21389,21442:21461,21480:21505,21577:21589,21648:21924,21956:21988,22002:22005,22045:22068)' = c(0.001 , 0.999),      # DTH_esc::esco.hru | change = absval                         
  'DTH_epc::epco.hru | change = absval | unit =    c( 230:335,538:599,677:696,717:756,945:982,1060:1091,1200:1216,1415:1420,1455:1458,1479:1528,1533:1652,1750:1788,2008:2041,2340:2346,2353:2360,2901:2916,2937:2969,3000:3018,3055:3076,3289:3298,3460:3610,3623:3651,3674:3701,3718:3814,4081:4108,4661:4661,4833:5419,5444:5794,5846:5871,5951:5962,5977:5990,6087:6163,6239:6379,6414:6440,6454:6459,6505:6530,6825:6845,6896:6915,6977:6997,7009:7034,7040:7132,7137:7189,7367:7374,7450:7457,7531:7553,7688:7717,7746:7753,7768:7853,7863:8037,8052:8068,8088:8117,8193:8247,8259:8272,8495:8506,8534:8536,8558:8682,8714:8729,8778:9057,9462:9468,9489:9492,9505:9508,9540:9555,9604:9669,9683:9686,9818:9921,9939:9961,9976:10016,10148:10192,10276:10301,10315:10327,10668:10694,10766:10872,10900:10919,10942:10965,11070:11084,11101:11114,11123:11134,11142:11304,11484:11511,11561:11616,11629:11635,11659:11696,11722:11794,12123:12196,12211:12262,12447:12480,12484:12503,12511:12534,12572:13033,13054:13060,13126:13153,13238:13281,13292:13362,13373:13493,13502:13536,13704:13723,13734:13759,13807:13833,13918:13970,13986:13992,14102:14111,14208:14224,14250:14255,14325:14328,14353:14428,14453:14536,14550:14673,14693:14708,14723:14742,14866:14887,15060:15100,15172:15172,15221:15313,15351:15400,15423:15434,15457:15496,15522:15563,15608:15636,15672:15747,15773:15794,15819:15834,15848:15876,15914:15961,15973:16103,16112:16209,16215:16245,16288:16419,16431:16440,16453:16483,16515:16610,16661:16687,16717:16774,17039:17075,17101:17141,17239:17245,17280:17286,17400:17436,17630:17692,17722:17980,18029:18080,18143:18217,18234:18254,18292:18406,18417:18427,18435:18466,18492:18498,18536:18612,18640:18750,18756:18825,18975:19238,19315:19394,19406:19573,19589:19592,19639:19793,19854:19875,19919:19974,20044:20072,20192:20217,20271:20343,20682:20696,20737:20748,20764:20773,21101:21167,21203:21208,21214:21225,21236:21312,21323:21337,21354:21389,21442:21461,21480:21505,21577:21589,21648:21924,21956:21988,22002:22005,22045:22068)' = c(0.001 , 0.999),      # DTH_epc::epco.hru | change = absval     
  'DTH_cnn::cn2.hru | change = pctchg | unit =     c( 230:335,538:599,677:696,717:756,945:982,1060:1091,1200:1216,1415:1420,1455:1458,1479:1528,1533:1652,1750:1788,2008:2041,2340:2346,2353:2360,2901:2916,2937:2969,3000:3018,3055:3076,3289:3298,3460:3610,3623:3651,3674:3701,3718:3814,4081:4108,4661:4661,4833:5419,5444:5794,5846:5871,5951:5962,5977:5990,6087:6163,6239:6379,6414:6440,6454:6459,6505:6530,6825:6845,6896:6915,6977:6997,7009:7034,7040:7132,7137:7189,7367:7374,7450:7457,7531:7553,7688:7717,7746:7753,7768:7853,7863:8037,8052:8068,8088:8117,8193:8247,8259:8272,8495:8506,8534:8536,8558:8682,8714:8729,8778:9057,9462:9468,9489:9492,9505:9508,9540:9555,9604:9669,9683:9686,9818:9921,9939:9961,9976:10016,10148:10192,10276:10301,10315:10327,10668:10694,10766:10872,10900:10919,10942:10965,11070:11084,11101:11114,11123:11134,11142:11304,11484:11511,11561:11616,11629:11635,11659:11696,11722:11794,12123:12196,12211:12262,12447:12480,12484:12503,12511:12534,12572:13033,13054:13060,13126:13153,13238:13281,13292:13362,13373:13493,13502:13536,13704:13723,13734:13759,13807:13833,13918:13970,13986:13992,14102:14111,14208:14224,14250:14255,14325:14328,14353:14428,14453:14536,14550:14673,14693:14708,14723:14742,14866:14887,15060:15100,15172:15172,15221:15313,15351:15400,15423:15434,15457:15496,15522:15563,15608:15636,15672:15747,15773:15794,15819:15834,15848:15876,15914:15961,15973:16103,16112:16209,16215:16245,16288:16419,16431:16440,16453:16483,16515:16610,16661:16687,16717:16774,17039:17075,17101:17141,17239:17245,17280:17286,17400:17436,17630:17692,17722:17980,18029:18080,18143:18217,18234:18254,18292:18406,18417:18427,18435:18466,18492:18498,18536:18612,18640:18750,18756:18825,18975:19238,19315:19394,19406:19573,19589:19592,19639:19793,19854:19875,19919:19974,20044:20072,20192:20217,20271:20343,20682:20696,20737:20748,20764:20773,21101:21167,21203:21208,21214:21225,21236:21312,21323:21337,21354:21389,21442:21461,21480:21505,21577:21589,21648:21924,21956:21988,22002:22005,22045:22068)' = c(-29.999  ,  10), # DTH_cnn::cn2.hru | change = pctchg             
  'DTH_awc::awc.sol | change = pctchg | unit =     c( 230:335,538:599,677:696,717:756,945:982,1060:1091,1200:1216,1415:1420,1455:1458,1479:1528,1533:1652,1750:1788,2008:2041,2340:2346,2353:2360,2901:2916,2937:2969,3000:3018,3055:3076,3289:3298,3460:3610,3623:3651,3674:3701,3718:3814,4081:4108,4661:4661,4833:5419,5444:5794,5846:5871,5951:5962,5977:5990,6087:6163,6239:6379,6414:6440,6454:6459,6505:6530,6825:6845,6896:6915,6977:6997,7009:7034,7040:7132,7137:7189,7367:7374,7450:7457,7531:7553,7688:7717,7746:7753,7768:7853,7863:8037,8052:8068,8088:8117,8193:8247,8259:8272,8495:8506,8534:8536,8558:8682,8714:8729,8778:9057,9462:9468,9489:9492,9505:9508,9540:9555,9604:9669,9683:9686,9818:9921,9939:9961,9976:10016,10148:10192,10276:10301,10315:10327,10668:10694,10766:10872,10900:10919,10942:10965,11070:11084,11101:11114,11123:11134,11142:11304,11484:11511,11561:11616,11629:11635,11659:11696,11722:11794,12123:12196,12211:12262,12447:12480,12484:12503,12511:12534,12572:13033,13054:13060,13126:13153,13238:13281,13292:13362,13373:13493,13502:13536,13704:13723,13734:13759,13807:13833,13918:13970,13986:13992,14102:14111,14208:14224,14250:14255,14325:14328,14353:14428,14453:14536,14550:14673,14693:14708,14723:14742,14866:14887,15060:15100,15172:15172,15221:15313,15351:15400,15423:15434,15457:15496,15522:15563,15608:15636,15672:15747,15773:15794,15819:15834,15848:15876,15914:15961,15973:16103,16112:16209,16215:16245,16288:16419,16431:16440,16453:16483,16515:16610,16661:16687,16717:16774,17039:17075,17101:17141,17239:17245,17280:17286,17400:17436,17630:17692,17722:17980,18029:18080,18143:18217,18234:18254,18292:18406,18417:18427,18435:18466,18492:18498,18536:18612,18640:18750,18756:18825,18975:19238,19315:19394,19406:19573,19589:19592,19639:19793,19854:19875,19919:19974,20044:20072,20192:20217,20271:20343,20682:20696,20737:20748,20764:20773,21101:21167,21203:21208,21214:21225,21236:21312,21323:21337,21354:21389,21442:21461,21480:21505,21577:21589,21648:21924,21956:21988,22002:22005,22045:22068)' = c(-15 , 59.999),   # DTH_awc::awc.sol | change = pctchg         
  'DTH_per::perco.hru | change = absval | unit =   c( 230:335,538:599,677:696,717:756,945:982,1060:1091,1200:1216,1415:1420,1455:1458,1479:1528,1533:1652,1750:1788,2008:2041,2340:2346,2353:2360,2901:2916,2937:2969,3000:3018,3055:3076,3289:3298,3460:3610,3623:3651,3674:3701,3718:3814,4081:4108,4661:4661,4833:5419,5444:5794,5846:5871,5951:5962,5977:5990,6087:6163,6239:6379,6414:6440,6454:6459,6505:6530,6825:6845,6896:6915,6977:6997,7009:7034,7040:7132,7137:7189,7367:7374,7450:7457,7531:7553,7688:7717,7746:7753,7768:7853,7863:8037,8052:8068,8088:8117,8193:8247,8259:8272,8495:8506,8534:8536,8558:8682,8714:8729,8778:9057,9462:9468,9489:9492,9505:9508,9540:9555,9604:9669,9683:9686,9818:9921,9939:9961,9976:10016,10148:10192,10276:10301,10315:10327,10668:10694,10766:10872,10900:10919,10942:10965,11070:11084,11101:11114,11123:11134,11142:11304,11484:11511,11561:11616,11629:11635,11659:11696,11722:11794,12123:12196,12211:12262,12447:12480,12484:12503,12511:12534,12572:13033,13054:13060,13126:13153,13238:13281,13292:13362,13373:13493,13502:13536,13704:13723,13734:13759,13807:13833,13918:13970,13986:13992,14102:14111,14208:14224,14250:14255,14325:14328,14353:14428,14453:14536,14550:14673,14693:14708,14723:14742,14866:14887,15060:15100,15172:15172,15221:15313,15351:15400,15423:15434,15457:15496,15522:15563,15608:15636,15672:15747,15773:15794,15819:15834,15848:15876,15914:15961,15973:16103,16112:16209,16215:16245,16288:16419,16431:16440,16453:16483,16515:16610,16661:16687,16717:16774,17039:17075,17101:17141,17239:17245,17280:17286,17400:17436,17630:17692,17722:17980,18029:18080,18143:18217,18234:18254,18292:18406,18417:18427,18435:18466,18492:18498,18536:18612,18640:18750,18756:18825,18975:19238,19315:19394,19406:19573,19589:19592,19639:19793,19854:19875,19919:19974,20044:20072,20192:20217,20271:20343,20682:20696,20737:20748,20764:20773,21101:21167,21203:21208,21214:21225,21236:21312,21323:21337,21354:21389,21442:21461,21480:21505,21577:21589,21648:21924,21956:21988,22002:22005,22045:22068)' = c(0.6 , 0.999),        # DTH_per::perco.hru | change = absval  
  'DTH_latq::latq_co.hru | change = abschg | unit =   c( 230:335,538:599,677:696,717:756,945:982,1060:1091,1200:1216,1415:1420,1455:1458,1479:1528,1533:1652,1750:1788,2008:2041,2340:2346,2353:2360,2901:2916,2937:2969,3000:3018,3055:3076,3289:3298,3460:3610,3623:3651,3674:3701,3718:3814,4081:4108,4661:4661,4833:5419,5444:5794,5846:5871,5951:5962,5977:5990,6087:6163,6239:6379,6414:6440,6454:6459,6505:6530,6825:6845,6896:6915,6977:6997,7009:7034,7040:7132,7137:7189,7367:7374,7450:7457,7531:7553,7688:7717,7746:7753,7768:7853,7863:8037,8052:8068,8088:8117,8193:8247,8259:8272,8495:8506,8534:8536,8558:8682,8714:8729,8778:9057,9462:9468,9489:9492,9505:9508,9540:9555,9604:9669,9683:9686,9818:9921,9939:9961,9976:10016,10148:10192,10276:10301,10315:10327,10668:10694,10766:10872,10900:10919,10942:10965,11070:11084,11101:11114,11123:11134,11142:11304,11484:11511,11561:11616,11629:11635,11659:11696,11722:11794,12123:12196,12211:12262,12447:12480,12484:12503,12511:12534,12572:13033,13054:13060,13126:13153,13238:13281,13292:13362,13373:13493,13502:13536,13704:13723,13734:13759,13807:13833,13918:13970,13986:13992,14102:14111,14208:14224,14250:14255,14325:14328,14353:14428,14453:14536,14550:14673,14693:14708,14723:14742,14866:14887,15060:15100,15172:15172,15221:15313,15351:15400,15423:15434,15457:15496,15522:15563,15608:15636,15672:15747,15773:15794,15819:15834,15848:15876,15914:15961,15973:16103,16112:16209,16215:16245,16288:16419,16431:16440,16453:16483,16515:16610,16661:16687,16717:16774,17039:17075,17101:17141,17239:17245,17280:17286,17400:17436,17630:17692,17722:17980,18029:18080,18143:18217,18234:18254,18292:18406,18417:18427,18435:18466,18492:18498,18536:18612,18640:18750,18756:18825,18975:19238,19315:19394,19406:19573,19589:19592,19639:19793,19854:19875,19919:19974,20044:20072,20192:20217,20271:20343,20682:20696,20737:20748,20764:20773,21101:21167,21203:21208,21214:21225,21236:21312,21323:21337,21354:21389,21442:21461,21480:21505,21577:21589,21648:21924,21956:21988,22002:22005,22045:22068)' = c(-0.5, 0.5),       # DTH_latq::latq_co.hru | change = abschg      
  'DTH_cn3::cn3_swf.hru | change = abschg | unit = c( 230:335,538:599,677:696,717:756,945:982,1060:1091,1200:1216,1415:1420,1455:1458,1479:1528,1533:1652,1750:1788,2008:2041,2340:2346,2353:2360,2901:2916,2937:2969,3000:3018,3055:3076,3289:3298,3460:3610,3623:3651,3674:3701,3718:3814,4081:4108,4661:4661,4833:5419,5444:5794,5846:5871,5951:5962,5977:5990,6087:6163,6239:6379,6414:6440,6454:6459,6505:6530,6825:6845,6896:6915,6977:6997,7009:7034,7040:7132,7137:7189,7367:7374,7450:7457,7531:7553,7688:7717,7746:7753,7768:7853,7863:8037,8052:8068,8088:8117,8193:8247,8259:8272,8495:8506,8534:8536,8558:8682,8714:8729,8778:9057,9462:9468,9489:9492,9505:9508,9540:9555,9604:9669,9683:9686,9818:9921,9939:9961,9976:10016,10148:10192,10276:10301,10315:10327,10668:10694,10766:10872,10900:10919,10942:10965,11070:11084,11101:11114,11123:11134,11142:11304,11484:11511,11561:11616,11629:11635,11659:11696,11722:11794,12123:12196,12211:12262,12447:12480,12484:12503,12511:12534,12572:13033,13054:13060,13126:13153,13238:13281,13292:13362,13373:13493,13502:13536,13704:13723,13734:13759,13807:13833,13918:13970,13986:13992,14102:14111,14208:14224,14250:14255,14325:14328,14353:14428,14453:14536,14550:14673,14693:14708,14723:14742,14866:14887,15060:15100,15172:15172,15221:15313,15351:15400,15423:15434,15457:15496,15522:15563,15608:15636,15672:15747,15773:15794,15819:15834,15848:15876,15914:15961,15973:16103,16112:16209,16215:16245,16288:16419,16431:16440,16453:16483,16515:16610,16661:16687,16717:16774,17039:17075,17101:17141,17239:17245,17280:17286,17400:17436,17630:17692,17722:17980,18029:18080,18143:18217,18234:18254,18292:18406,18417:18427,18435:18466,18492:18498,18536:18612,18640:18750,18756:18825,18975:19238,19315:19394,19406:19573,19589:19592,19639:19793,19854:19875,19919:19974,20044:20072,20192:20217,20271:20343,20682:20696,20737:20748,20764:20773,21101:21167,21203:21208,21214:21225,21236:21312,21323:21337,21354:21389,21442:21461,21480:21505,21577:21589,21648:21924,21956:21988,22002:22005,22045:22068)' = c(-0.25, 0.5),          # DTH_cn3::cn3_swf.hru | change = abschg           
  'DTH_zso::z.sol | change = pctchg | unit =       c( 230:335,538:599,677:696,717:756,945:982,1060:1091,1200:1216,1415:1420,1455:1458,1479:1528,1533:1652,1750:1788,2008:2041,2340:2346,2353:2360,2901:2916,2937:2969,3000:3018,3055:3076,3289:3298,3460:3610,3623:3651,3674:3701,3718:3814,4081:4108,4661:4661,4833:5419,5444:5794,5846:5871,5951:5962,5977:5990,6087:6163,6239:6379,6414:6440,6454:6459,6505:6530,6825:6845,6896:6915,6977:6997,7009:7034,7040:7132,7137:7189,7367:7374,7450:7457,7531:7553,7688:7717,7746:7753,7768:7853,7863:8037,8052:8068,8088:8117,8193:8247,8259:8272,8495:8506,8534:8536,8558:8682,8714:8729,8778:9057,9462:9468,9489:9492,9505:9508,9540:9555,9604:9669,9683:9686,9818:9921,9939:9961,9976:10016,10148:10192,10276:10301,10315:10327,10668:10694,10766:10872,10900:10919,10942:10965,11070:11084,11101:11114,11123:11134,11142:11304,11484:11511,11561:11616,11629:11635,11659:11696,11722:11794,12123:12196,12211:12262,12447:12480,12484:12503,12511:12534,12572:13033,13054:13060,13126:13153,13238:13281,13292:13362,13373:13493,13502:13536,13704:13723,13734:13759,13807:13833,13918:13970,13986:13992,14102:14111,14208:14224,14250:14255,14325:14328,14353:14428,14453:14536,14550:14673,14693:14708,14723:14742,14866:14887,15060:15100,15172:15172,15221:15313,15351:15400,15423:15434,15457:15496,15522:15563,15608:15636,15672:15747,15773:15794,15819:15834,15848:15876,15914:15961,15973:16103,16112:16209,16215:16245,16288:16419,16431:16440,16453:16483,16515:16610,16661:16687,16717:16774,17039:17075,17101:17141,17239:17245,17280:17286,17400:17436,17630:17692,17722:17980,18029:18080,18143:18217,18234:18254,18292:18406,18417:18427,18435:18466,18492:18498,18536:18612,18640:18750,18756:18825,18975:19238,19315:19394,19406:19573,19589:19592,19639:19793,19854:19875,19919:19974,20044:20072,20192:20217,20271:20343,20682:20696,20737:20748,20764:20773,21101:21167,21203:21208,21214:21225,21236:21312,21323:21337,21354:21389,21442:21461,21480:21505,21577:21589,21648:21924,21956:21988,22002:22005,22045:22068)' = c(-25 , 49.999),   # DTH_zso::z.sol | change = pctchg         
  'DTH_kso::k.sol | change = pctchg | unit =       c( 230:335,538:599,677:696,717:756,945:982,1060:1091,1200:1216,1415:1420,1455:1458,1479:1528,1533:1652,1750:1788,2008:2041,2340:2346,2353:2360,2901:2916,2937:2969,3000:3018,3055:3076,3289:3298,3460:3610,3623:3651,3674:3701,3718:3814,4081:4108,4661:4661,4833:5419,5444:5794,5846:5871,5951:5962,5977:5990,6087:6163,6239:6379,6414:6440,6454:6459,6505:6530,6825:6845,6896:6915,6977:6997,7009:7034,7040:7132,7137:7189,7367:7374,7450:7457,7531:7553,7688:7717,7746:7753,7768:7853,7863:8037,8052:8068,8088:8117,8193:8247,8259:8272,8495:8506,8534:8536,8558:8682,8714:8729,8778:9057,9462:9468,9489:9492,9505:9508,9540:9555,9604:9669,9683:9686,9818:9921,9939:9961,9976:10016,10148:10192,10276:10301,10315:10327,10668:10694,10766:10872,10900:10919,10942:10965,11070:11084,11101:11114,11123:11134,11142:11304,11484:11511,11561:11616,11629:11635,11659:11696,11722:11794,12123:12196,12211:12262,12447:12480,12484:12503,12511:12534,12572:13033,13054:13060,13126:13153,13238:13281,13292:13362,13373:13493,13502:13536,13704:13723,13734:13759,13807:13833,13918:13970,13986:13992,14102:14111,14208:14224,14250:14255,14325:14328,14353:14428,14453:14536,14550:14673,14693:14708,14723:14742,14866:14887,15060:15100,15172:15172,15221:15313,15351:15400,15423:15434,15457:15496,15522:15563,15608:15636,15672:15747,15773:15794,15819:15834,15848:15876,15914:15961,15973:16103,16112:16209,16215:16245,16288:16419,16431:16440,16453:16483,16515:16610,16661:16687,16717:16774,17039:17075,17101:17141,17239:17245,17280:17286,17400:17436,17630:17692,17722:17980,18029:18080,18143:18217,18234:18254,18292:18406,18417:18427,18435:18466,18492:18498,18536:18612,18640:18750,18756:18825,18975:19238,19315:19394,19406:19573,19589:19592,19639:19793,19854:19875,19919:19974,20044:20072,20192:20217,20271:20343,20682:20696,20737:20748,20764:20773,21101:21167,21203:21208,21214:21225,21236:21312,21323:21337,21354:21389,21442:21461,21480:21505,21577:21589,21648:21924,21956:21988,22002:22005,22045:22068)' = c(-79.999 , 199.999),  # DTH_kso::k.sol | change = pctchg          
  'DTH_bd::bd.sol | change = pctchg | unit =       c( 230:335,538:599,677:696,717:756,945:982,1060:1091,1200:1216,1415:1420,1455:1458,1479:1528,1533:1652,1750:1788,2008:2041,2340:2346,2353:2360,2901:2916,2937:2969,3000:3018,3055:3076,3289:3298,3460:3610,3623:3651,3674:3701,3718:3814,4081:4108,4661:4661,4833:5419,5444:5794,5846:5871,5951:5962,5977:5990,6087:6163,6239:6379,6414:6440,6454:6459,6505:6530,6825:6845,6896:6915,6977:6997,7009:7034,7040:7132,7137:7189,7367:7374,7450:7457,7531:7553,7688:7717,7746:7753,7768:7853,7863:8037,8052:8068,8088:8117,8193:8247,8259:8272,8495:8506,8534:8536,8558:8682,8714:8729,8778:9057,9462:9468,9489:9492,9505:9508,9540:9555,9604:9669,9683:9686,9818:9921,9939:9961,9976:10016,10148:10192,10276:10301,10315:10327,10668:10694,10766:10872,10900:10919,10942:10965,11070:11084,11101:11114,11123:11134,11142:11304,11484:11511,11561:11616,11629:11635,11659:11696,11722:11794,12123:12196,12211:12262,12447:12480,12484:12503,12511:12534,12572:13033,13054:13060,13126:13153,13238:13281,13292:13362,13373:13493,13502:13536,13704:13723,13734:13759,13807:13833,13918:13970,13986:13992,14102:14111,14208:14224,14250:14255,14325:14328,14353:14428,14453:14536,14550:14673,14693:14708,14723:14742,14866:14887,15060:15100,15172:15172,15221:15313,15351:15400,15423:15434,15457:15496,15522:15563,15608:15636,15672:15747,15773:15794,15819:15834,15848:15876,15914:15961,15973:16103,16112:16209,16215:16245,16288:16419,16431:16440,16453:16483,16515:16610,16661:16687,16717:16774,17039:17075,17101:17141,17239:17245,17280:17286,17400:17436,17630:17692,17722:17980,18029:18080,18143:18217,18234:18254,18292:18406,18417:18427,18435:18466,18492:18498,18536:18612,18640:18750,18756:18825,18975:19238,19315:19394,19406:19573,19589:19592,19639:19793,19854:19875,19919:19974,20044:20072,20192:20217,20271:20343,20682:20696,20737:20748,20764:20773,21101:21167,21203:21208,21214:21225,21236:21312,21323:21337,21354:21389,21442:21461,21480:21505,21577:21589,21648:21924,21956:21988,22002:22005,22045:22068)' = c(-29.999 , 20),   # DTH_bd::bd.sol | change = pctchg        
  
  
  'DTL_esc::esco.hru | change = absval | unit =    c(  7:42,336:363,383:431,467:492,607:614,777:857,888:944,983:1051,1100:1119,1137:1180,1715:1744,1877:1904,2385:2412,2443:2552,2624:2661,2692:2715,3079:3216,3264:3288,3611:3622,3652:3673,3702:3717,3815:3879,3935:3976,4109:4163,4257:4401,4434:4537,4635:4660,4748:4772,4787:4792,5872:5899,6380:6413,6567:6583,6648:6679,6707:6732,6780:6824,7554:7687,7718:7745,7754:7767,8038:8051,8069:8087,9670:9682,9922:9938,9962:9975,10354:10367,10393:10404,10497:10510,10654:10667,10695:10732,10920:10941,10966:10991,11512:11560,11617:11628,11636:11658,11795:11818,12535:12571,13034:13053,13209:13222,13282:13291,13363:13372,13537:13654,13668:13703,13724:13733,13760:13806,13834:13917,13993:14101,14112:14207,14225:14249,14256:14324,14347:14352,14429:14452,14537:14549,14674:14692,14770:14809,14827:14865,14902:14952,14992:15006,15101:15135,15143:15171,15173:15201,15314:15350,15401:15422,15435:15456,15497:15521,15564:15607,15637:15671,16104:16111,16210:16214,16246:16287,16420:16430,16441:16452,16611:16660,16688:16716,16775:17038,17076:17100,17142:17238,17287:17309,17344:17367,17455:17522,17981:18028,18081:18122,18255:18291,18407:18416,18428:18434,18467:18491,18499:18513,18751:18755,18826:18895,18911:18974,19277:19314,20246:20270,20667:20681,20697:20736,20759:20763,20774:20839,21506:21576,21590:21647 )' = c(0.25 , 0.999),      # DTL_esc::esco.hru | change = absval       
  'DTL_epc::epco.hru | change = absval | unit =    c(  7:42,336:363,383:431,467:492,607:614,777:857,888:944,983:1051,1100:1119,1137:1180,1715:1744,1877:1904,2385:2412,2443:2552,2624:2661,2692:2715,3079:3216,3264:3288,3611:3622,3652:3673,3702:3717,3815:3879,3935:3976,4109:4163,4257:4401,4434:4537,4635:4660,4748:4772,4787:4792,5872:5899,6380:6413,6567:6583,6648:6679,6707:6732,6780:6824,7554:7687,7718:7745,7754:7767,8038:8051,8069:8087,9670:9682,9922:9938,9962:9975,10354:10367,10393:10404,10497:10510,10654:10667,10695:10732,10920:10941,10966:10991,11512:11560,11617:11628,11636:11658,11795:11818,12535:12571,13034:13053,13209:13222,13282:13291,13363:13372,13537:13654,13668:13703,13724:13733,13760:13806,13834:13917,13993:14101,14112:14207,14225:14249,14256:14324,14347:14352,14429:14452,14537:14549,14674:14692,14770:14809,14827:14865,14902:14952,14992:15006,15101:15135,15143:15171,15173:15201,15314:15350,15401:15422,15435:15456,15497:15521,15564:15607,15637:15671,16104:16111,16210:16214,16246:16287,16420:16430,16441:16452,16611:16660,16688:16716,16775:17038,17076:17100,17142:17238,17287:17309,17344:17367,17455:17522,17981:18028,18081:18122,18255:18291,18407:18416,18428:18434,18467:18491,18499:18513,18751:18755,18826:18895,18911:18974,19277:19314,20246:20270,20667:20681,20697:20736,20759:20763,20774:20839,21506:21576,21590:21647 )' = c(0.25 , 0.999),      # DTL_epc::epco.hru | change = absval  
  'DTL_cnn::cn2.hru | change = pctchg | unit =     c(  7:42,336:363,383:431,467:492,607:614,777:857,888:944,983:1051,1100:1119,1137:1180,1715:1744,1877:1904,2385:2412,2443:2552,2624:2661,2692:2715,3079:3216,3264:3288,3611:3622,3652:3673,3702:3717,3815:3879,3935:3976,4109:4163,4257:4401,4434:4537,4635:4660,4748:4772,4787:4792,5872:5899,6380:6413,6567:6583,6648:6679,6707:6732,6780:6824,7554:7687,7718:7745,7754:7767,8038:8051,8069:8087,9670:9682,9922:9938,9962:9975,10354:10367,10393:10404,10497:10510,10654:10667,10695:10732,10920:10941,10966:10991,11512:11560,11617:11628,11636:11658,11795:11818,12535:12571,13034:13053,13209:13222,13282:13291,13363:13372,13537:13654,13668:13703,13724:13733,13760:13806,13834:13917,13993:14101,14112:14207,14225:14249,14256:14324,14347:14352,14429:14452,14537:14549,14674:14692,14770:14809,14827:14865,14902:14952,14992:15006,15101:15135,15143:15171,15173:15201,15314:15350,15401:15422,15435:15456,15497:15521,15564:15607,15637:15671,16104:16111,16210:16214,16246:16287,16420:16430,16441:16452,16611:16660,16688:16716,16775:17038,17076:17100,17142:17238,17287:17309,17344:17367,17455:17522,17981:18028,18081:18122,18255:18291,18407:18416,18428:18434,18467:18491,18499:18513,18751:18755,18826:18895,18911:18974,19277:19314,20246:20270,20667:20681,20697:20736,20759:20763,20774:20839,21506:21576,21590:21647 )' = c(-29.999  , 10), # DTL_cnn::cn2.hru | change = pctchg       
  'DTL_awc::awc.sol | change = pctchg | unit =     c(  7:42,336:363,383:431,467:492,607:614,777:857,888:944,983:1051,1100:1119,1137:1180,1715:1744,1877:1904,2385:2412,2443:2552,2624:2661,2692:2715,3079:3216,3264:3288,3611:3622,3652:3673,3702:3717,3815:3879,3935:3976,4109:4163,4257:4401,4434:4537,4635:4660,4748:4772,4787:4792,5872:5899,6380:6413,6567:6583,6648:6679,6707:6732,6780:6824,7554:7687,7718:7745,7754:7767,8038:8051,8069:8087,9670:9682,9922:9938,9962:9975,10354:10367,10393:10404,10497:10510,10654:10667,10695:10732,10920:10941,10966:10991,11512:11560,11617:11628,11636:11658,11795:11818,12535:12571,13034:13053,13209:13222,13282:13291,13363:13372,13537:13654,13668:13703,13724:13733,13760:13806,13834:13917,13993:14101,14112:14207,14225:14249,14256:14324,14347:14352,14429:14452,14537:14549,14674:14692,14770:14809,14827:14865,14902:14952,14992:15006,15101:15135,15143:15171,15173:15201,15314:15350,15401:15422,15435:15456,15497:15521,15564:15607,15637:15671,16104:16111,16210:16214,16246:16287,16420:16430,16441:16452,16611:16660,16688:16716,16775:17038,17076:17100,17142:17238,17287:17309,17344:17367,17455:17522,17981:18028,18081:18122,18255:18291,18407:18416,18428:18434,18467:18491,18499:18513,18751:18755,18826:18895,18911:18974,19277:19314,20246:20270,20667:20681,20697:20736,20759:20763,20774:20839,21506:21576,21590:21647 )' = c(-15 , 59.999),   # DTL_awc::awc.sol | change = pctchg    
  'DTL_per::perco.hru | change = absval | unit =   c(  7:42,336:363,383:431,467:492,607:614,777:857,888:944,983:1051,1100:1119,1137:1180,1715:1744,1877:1904,2385:2412,2443:2552,2624:2661,2692:2715,3079:3216,3264:3288,3611:3622,3652:3673,3702:3717,3815:3879,3935:3976,4109:4163,4257:4401,4434:4537,4635:4660,4748:4772,4787:4792,5872:5899,6380:6413,6567:6583,6648:6679,6707:6732,6780:6824,7554:7687,7718:7745,7754:7767,8038:8051,8069:8087,9670:9682,9922:9938,9962:9975,10354:10367,10393:10404,10497:10510,10654:10667,10695:10732,10920:10941,10966:10991,11512:11560,11617:11628,11636:11658,11795:11818,12535:12571,13034:13053,13209:13222,13282:13291,13363:13372,13537:13654,13668:13703,13724:13733,13760:13806,13834:13917,13993:14101,14112:14207,14225:14249,14256:14324,14347:14352,14429:14452,14537:14549,14674:14692,14770:14809,14827:14865,14902:14952,14992:15006,15101:15135,15143:15171,15173:15201,15314:15350,15401:15422,15435:15456,15497:15521,15564:15607,15637:15671,16104:16111,16210:16214,16246:16287,16420:16430,16441:16452,16611:16660,16688:16716,16775:17038,17076:17100,17142:17238,17287:17309,17344:17367,17455:17522,17981:18028,18081:18122,18255:18291,18407:18416,18428:18434,18467:18491,18499:18513,18751:18755,18826:18895,18911:18974,19277:19314,20246:20270,20667:20681,20697:20736,20759:20763,20774:20839,21506:21576,21590:21647 )' = c(0.2 , 0.7),        # DTL_per::perco.hru | change = absval
  'DTL_latq::latq_co.hru | change = abschg | unit =   c(  7:42,336:363,383:431,467:492,607:614,777:857,888:944,983:1051,1100:1119,1137:1180,1715:1744,1877:1904,2385:2412,2443:2552,2624:2661,2692:2715,3079:3216,3264:3288,3611:3622,3652:3673,3702:3717,3815:3879,3935:3976,4109:4163,4257:4401,4434:4537,4635:4660,4748:4772,4787:4792,5872:5899,6380:6413,6567:6583,6648:6679,6707:6732,6780:6824,7554:7687,7718:7745,7754:7767,8038:8051,8069:8087,9670:9682,9922:9938,9962:9975,10354:10367,10393:10404,10497:10510,10654:10667,10695:10732,10920:10941,10966:10991,11512:11560,11617:11628,11636:11658,11795:11818,12535:12571,13034:13053,13209:13222,13282:13291,13363:13372,13537:13654,13668:13703,13724:13733,13760:13806,13834:13917,13993:14101,14112:14207,14225:14249,14256:14324,14347:14352,14429:14452,14537:14549,14674:14692,14770:14809,14827:14865,14902:14952,14992:15006,15101:15135,15143:15171,15173:15201,15314:15350,15401:15422,15435:15456,15497:15521,15564:15607,15637:15671,16104:16111,16210:16214,16246:16287,16420:16430,16441:16452,16611:16660,16688:16716,16775:17038,17076:17100,17142:17238,17287:17309,17344:17367,17455:17522,17981:18028,18081:18122,18255:18291,18407:18416,18428:18434,18467:18491,18499:18513,18751:18755,18826:18895,18911:18974,19277:19314,20246:20270,20667:20681,20697:20736,20759:20763,20774:20839,21506:21576,21590:21647 )' = c(-0.5, 0.25),       # DTL_latq::latq_co.hru | change = abschg    
  'DTL_cn3::cn3_swf.hru | change = abschg | unit = c(  7:42,336:363,383:431,467:492,607:614,777:857,888:944,983:1051,1100:1119,1137:1180,1715:1744,1877:1904,2385:2412,2443:2552,2624:2661,2692:2715,3079:3216,3264:3288,3611:3622,3652:3673,3702:3717,3815:3879,3935:3976,4109:4163,4257:4401,4434:4537,4635:4660,4748:4772,4787:4792,5872:5899,6380:6413,6567:6583,6648:6679,6707:6732,6780:6824,7554:7687,7718:7745,7754:7767,8038:8051,8069:8087,9670:9682,9922:9938,9962:9975,10354:10367,10393:10404,10497:10510,10654:10667,10695:10732,10920:10941,10966:10991,11512:11560,11617:11628,11636:11658,11795:11818,12535:12571,13034:13053,13209:13222,13282:13291,13363:13372,13537:13654,13668:13703,13724:13733,13760:13806,13834:13917,13993:14101,14112:14207,14225:14249,14256:14324,14347:14352,14429:14452,14537:14549,14674:14692,14770:14809,14827:14865,14902:14952,14992:15006,15101:15135,15143:15171,15173:15201,15314:15350,15401:15422,15435:15456,15497:15521,15564:15607,15637:15671,16104:16111,16210:16214,16246:16287,16420:16430,16441:16452,16611:16660,16688:16716,16775:17038,17076:17100,17142:17238,17287:17309,17344:17367,17455:17522,17981:18028,18081:18122,18255:18291,18407:18416,18428:18434,18467:18491,18499:18513,18751:18755,18826:18895,18911:18974,19277:19314,20246:20270,20667:20681,20697:20736,20759:20763,20774:20839,21506:21576,21590:21647 )' = c(-0.25, 0.5),          # DTL_cn3::cn3_swf.hru | change = abschg        
  'DTL_zso::z.sol | change = pctchg | unit =       c(  7:42,336:363,383:431,467:492,607:614,777:857,888:944,983:1051,1100:1119,1137:1180,1715:1744,1877:1904,2385:2412,2443:2552,2624:2661,2692:2715,3079:3216,3264:3288,3611:3622,3652:3673,3702:3717,3815:3879,3935:3976,4109:4163,4257:4401,4434:4537,4635:4660,4748:4772,4787:4792,5872:5899,6380:6413,6567:6583,6648:6679,6707:6732,6780:6824,7554:7687,7718:7745,7754:7767,8038:8051,8069:8087,9670:9682,9922:9938,9962:9975,10354:10367,10393:10404,10497:10510,10654:10667,10695:10732,10920:10941,10966:10991,11512:11560,11617:11628,11636:11658,11795:11818,12535:12571,13034:13053,13209:13222,13282:13291,13363:13372,13537:13654,13668:13703,13724:13733,13760:13806,13834:13917,13993:14101,14112:14207,14225:14249,14256:14324,14347:14352,14429:14452,14537:14549,14674:14692,14770:14809,14827:14865,14902:14952,14992:15006,15101:15135,15143:15171,15173:15201,15314:15350,15401:15422,15435:15456,15497:15521,15564:15607,15637:15671,16104:16111,16210:16214,16246:16287,16420:16430,16441:16452,16611:16660,16688:16716,16775:17038,17076:17100,17142:17238,17287:17309,17344:17367,17455:17522,17981:18028,18081:18122,18255:18291,18407:18416,18428:18434,18467:18491,18499:18513,18751:18755,18826:18895,18911:18974,19277:19314,20246:20270,20667:20681,20697:20736,20759:20763,20774:20839,21506:21576,21590:21647 )' = c(-25 , 49.999),   # DTL_zso::z.sol | change = pctchg 
  'DTL_kso::k.sol | change = pctchg | unit =       c(  7:42,336:363,383:431,467:492,607:614,777:857,888:944,983:1051,1100:1119,1137:1180,1715:1744,1877:1904,2385:2412,2443:2552,2624:2661,2692:2715,3079:3216,3264:3288,3611:3622,3652:3673,3702:3717,3815:3879,3935:3976,4109:4163,4257:4401,4434:4537,4635:4660,4748:4772,4787:4792,5872:5899,6380:6413,6567:6583,6648:6679,6707:6732,6780:6824,7554:7687,7718:7745,7754:7767,8038:8051,8069:8087,9670:9682,9922:9938,9962:9975,10354:10367,10393:10404,10497:10510,10654:10667,10695:10732,10920:10941,10966:10991,11512:11560,11617:11628,11636:11658,11795:11818,12535:12571,13034:13053,13209:13222,13282:13291,13363:13372,13537:13654,13668:13703,13724:13733,13760:13806,13834:13917,13993:14101,14112:14207,14225:14249,14256:14324,14347:14352,14429:14452,14537:14549,14674:14692,14770:14809,14827:14865,14902:14952,14992:15006,15101:15135,15143:15171,15173:15201,15314:15350,15401:15422,15435:15456,15497:15521,15564:15607,15637:15671,16104:16111,16210:16214,16246:16287,16420:16430,16441:16452,16611:16660,16688:16716,16775:17038,17076:17100,17142:17238,17287:17309,17344:17367,17455:17522,17981:18028,18081:18122,18255:18291,18407:18416,18428:18434,18467:18491,18499:18513,18751:18755,18826:18895,18911:18974,19277:19314,20246:20270,20667:20681,20697:20736,20759:20763,20774:20839,21506:21576,21590:21647 )' = c(-79.999 , 199.999),  # DTL_kso::k.sol | change = pctchg 
  'DTL_bd::bd.sol | change = pctchg | unit =       c(  7:42,336:363,383:431,467:492,607:614,777:857,888:944,983:1051,1100:1119,1137:1180,1715:1744,1877:1904,2385:2412,2443:2552,2624:2661,2692:2715,3079:3216,3264:3288,3611:3622,3652:3673,3702:3717,3815:3879,3935:3976,4109:4163,4257:4401,4434:4537,4635:4660,4748:4772,4787:4792,5872:5899,6380:6413,6567:6583,6648:6679,6707:6732,6780:6824,7554:7687,7718:7745,7754:7767,8038:8051,8069:8087,9670:9682,9922:9938,9962:9975,10354:10367,10393:10404,10497:10510,10654:10667,10695:10732,10920:10941,10966:10991,11512:11560,11617:11628,11636:11658,11795:11818,12535:12571,13034:13053,13209:13222,13282:13291,13363:13372,13537:13654,13668:13703,13724:13733,13760:13806,13834:13917,13993:14101,14112:14207,14225:14249,14256:14324,14347:14352,14429:14452,14537:14549,14674:14692,14770:14809,14827:14865,14902:14952,14992:15006,15101:15135,15143:15171,15173:15201,15314:15350,15401:15422,15435:15456,15497:15521,15564:15607,15637:15671,16104:16111,16210:16214,16246:16287,16420:16430,16441:16452,16611:16660,16688:16716,16775:17038,17076:17100,17142:17238,17287:17309,17344:17367,17455:17522,17981:18028,18081:18122,18255:18291,18407:18416,18428:18434,18467:18491,18499:18513,18751:18755,18826:18895,18911:18974,19277:19314,20246:20270,20667:20681,20697:20736,20759:20763,20774:20839,21506:21576,21590:21647 )' = c(-20 , 29.999))   # DTL_bd::bd.sol | change = pctchg 




#Parameters ranges for the third round
par_bound_zonal_r3 <- tibble(
  'IMP_esc::esco.hru | change = absval | unit =    c(53:67,97:229,432:466,493:537,600:606,626:676,697:716,757:770,1277:1414,1421:1428,1446:1454,1459:1478,1529:1532,1789:1876,2059:2339,2347:2352,2361:2384,3299:3459,5420:5443,5900:5950,5963:5976,5991:6086,7311:7366,7375:7449,7458:7530,8425:8494,8507:8533,8537:8557,9233:9368,9687:9817,10017:10147,11027:11069,11085:11100,11115:11122,11135:11141,11338:11483,11847:12117,12275:12446,13061:13125,13154:13188,15748:15772,15795:15818,15835:15847,15877:15913,15962:15972,16484:16514,17368:17399,17523:17629,17693:17721,18613:18639,19239:19254,19574:19588,19593:19638,19794:19853,19876:19918,19975:20043,20073:20191,20344:20666,20850:21100,21168:21202,21313:21322,21338:21353,21390:21441,21462:21479,21925:21955,21989:22001,22006:22044,22069:22089)' = c(0.25, 0.999),       # 'IMP_esc::esco.hru | change = absval             
  'IMP_epc::epco.hru | change = absval | unit =    c(53:67,97:229,432:466,493:537,600:606,626:676,697:716,757:770,1277:1414,1421:1428,1446:1454,1459:1478,1529:1532,1789:1876,2059:2339,2347:2352,2361:2384,3299:3459,5420:5443,5900:5950,5963:5976,5991:6086,7311:7366,7375:7449,7458:7530,8425:8494,8507:8533,8537:8557,9233:9368,9687:9817,10017:10147,11027:11069,11085:11100,11115:11122,11135:11141,11338:11483,11847:12117,12275:12446,13061:13125,13154:13188,15748:15772,15795:15818,15835:15847,15877:15913,15962:15972,16484:16514,17368:17399,17523:17629,17693:17721,18613:18639,19239:19254,19574:19588,19593:19638,19794:19853,19876:19918,19975:20043,20073:20191,20344:20666,20850:21100,21168:21202,21313:21322,21338:21353,21390:21441,21462:21479,21925:21955,21989:22001,22006:22044,22069:22089)' = c(0.25, 0.9),       # 'IMP_epc::epco.hru | change = absval  
  'IMP_cnn::cn2.hru | change = pctchg | unit =     c(53:67,97:229,432:466,493:537,600:606,626:676,697:716,757:770,1277:1414,1421:1428,1446:1454,1459:1478,1529:1532,1789:1876,2059:2339,2347:2352,2361:2384,3299:3459,5420:5443,5900:5950,5963:5976,5991:6086,7311:7366,7375:7449,7458:7530,8425:8494,8507:8533,8537:8557,9233:9368,9687:9817,10017:10147,11027:11069,11085:11100,11115:11122,11135:11141,11338:11483,11847:12117,12275:12446,13061:13125,13154:13188,15748:15772,15795:15818,15835:15847,15877:15913,15962:15972,16484:16514,17368:17399,17523:17629,17693:17721,18613:18639,19239:19254,19574:19588,19593:19638,19794:19853,19876:19918,19975:20043,20073:20191,20344:20666,20850:21100,21168:21202,21313:21322,21338:21353,21390:21441,21462:21479,21925:21955,21989:22001,22006:22044,22069:22089)' = c(-30  ,  15),  # 'IMP_cnn::cn2.hru | change = pctchg     
  'IMP_awc::awc.sol | change = pctchg | unit =     c(53:67,97:229,432:466,493:537,600:606,626:676,697:716,757:770,1277:1414,1421:1428,1446:1454,1459:1478,1529:1532,1789:1876,2059:2339,2347:2352,2361:2384,3299:3459,5420:5443,5900:5950,5963:5976,5991:6086,7311:7366,7375:7449,7458:7530,8425:8494,8507:8533,8537:8557,9233:9368,9687:9817,10017:10147,11027:11069,11085:11100,11115:11122,11135:11141,11338:11483,11847:12117,12275:12446,13061:13125,13154:13188,15748:15772,15795:15818,15835:15847,15877:15913,15962:15972,16484:16514,17368:17399,17523:17629,17693:17721,18613:18639,19239:19254,19574:19588,19593:19638,19794:19853,19876:19918,19975:20043,20073:20191,20344:20666,20850:21100,21168:21202,21313:21322,21338:21353,21390:21441,21462:21479,21925:21955,21989:22001,22006:22044,22069:22089)' = c(-20 , 40),    # 'IMP_awc::awc.sol | change = pctchg    
  'IMP_per::perco.hru | change = absval | unit =   c(53:67,97:229,432:466,493:537,600:606,626:676,697:716,757:770,1277:1414,1421:1428,1446:1454,1459:1478,1529:1532,1789:1876,2059:2339,2347:2352,2361:2384,3299:3459,5420:5443,5900:5950,5963:5976,5991:6086,7311:7366,7375:7449,7458:7530,8425:8494,8507:8533,8537:8557,9233:9368,9687:9817,10017:10147,11027:11069,11085:11100,11115:11122,11135:11141,11338:11483,11847:12117,12275:12446,13061:13125,13154:13188,15748:15772,15795:15818,15835:15847,15877:15913,15962:15972,16484:16514,17368:17399,17523:17629,17693:17721,18613:18639,19239:19254,19574:19588,19593:19638,19794:19853,19876:19918,19975:20043,20073:20191,20344:20666,20850:21100,21168:21202,21313:21322,21338:21353,21390:21441,21462:21479,21925:21955,21989:22001,22006:22044,22069:22089)' = c(0.25 , 0.4),         # 'IMP_per::perco.hru | change = absval   
  'IMP_latq::latq_co.hru | change = abschg | unit =   c(53:67,97:229,432:466,493:537,600:606,626:676,697:716,757:770,1277:1414,1421:1428,1446:1454,1459:1478,1529:1532,1789:1876,2059:2339,2347:2352,2361:2384,3299:3459,5420:5443,5900:5950,5963:5976,5991:6086,7311:7366,7375:7449,7458:7530,8425:8494,8507:8533,8537:8557,9233:9368,9687:9817,10017:10147,11027:11069,11085:11100,11115:11122,11135:11141,11338:11483,11847:12117,12275:12446,13061:13125,13154:13188,15748:15772,15795:15818,15835:15847,15877:15913,15962:15972,16484:16514,17368:17399,17523:17629,17693:17721,18613:18639,19239:19254,19574:19588,19593:19638,19794:19853,19876:19918,19975:20043,20073:20191,20344:20666,20850:21100,21168:21202,21313:21322,21338:21353,21390:21441,21462:21479,21925:21955,21989:22001,22006:22044,22069:22089)' = c(-0.4, 0.2),        # 'IMP_latq::latq_co.hru | change = abschg  
  'IMP_cn3::cn3_swf.hru | change = abschg | unit = c(53:67,97:229,432:466,493:537,600:606,626:676,697:716,757:770,1277:1414,1421:1428,1446:1454,1459:1478,1529:1532,1789:1876,2059:2339,2347:2352,2361:2384,3299:3459,5420:5443,5900:5950,5963:5976,5991:6086,7311:7366,7375:7449,7458:7530,8425:8494,8507:8533,8537:8557,9233:9368,9687:9817,10017:10147,11027:11069,11085:11100,11115:11122,11135:11141,11338:11483,11847:12117,12275:12446,13061:13125,13154:13188,15748:15772,15795:15818,15835:15847,15877:15913,15962:15972,16484:16514,17368:17399,17523:17629,17693:17721,18613:18639,19239:19254,19574:19588,19593:19638,19794:19853,19876:19918,19975:20043,20073:20191,20344:20666,20850:21100,21168:21202,21313:21322,21338:21353,21390:21441,21462:21479,21925:21955,21989:22001,22006:22044,22069:22089)' = c(-0.25, 0.5),           # 'IMP_cn3::cn3_swf.hru | change = abschg        
  'IMP_zso::z.sol | change = pctchg | unit =       c(53:67,97:229,432:466,493:537,600:606,626:676,697:716,757:770,1277:1414,1421:1428,1446:1454,1459:1478,1529:1532,1789:1876,2059:2339,2347:2352,2361:2384,3299:3459,5420:5443,5900:5950,5963:5976,5991:6086,7311:7366,7375:7449,7458:7530,8425:8494,8507:8533,8537:8557,9233:9368,9687:9817,10017:10147,11027:11069,11085:11100,11115:11122,11135:11141,11338:11483,11847:12117,12275:12446,13061:13125,13154:13188,15748:15772,15795:15818,15835:15847,15877:15913,15962:15972,16484:16514,17368:17399,17523:17629,17693:17721,18613:18639,19239:19254,19574:19588,19593:19638,19794:19853,19876:19918,19975:20043,20073:20191,20344:20666,20850:21100,21168:21202,21313:21322,21338:21353,21390:21441,21462:21479,21925:21955,21989:22001,22006:22044,22069:22089)' = c(-20 , 30),    # 'IMP_zso::z.sol | change = pctchg 
  'IMP_kso::k.sol | change = pctchg | unit =       c(53:67,97:229,432:466,493:537,600:606,626:676,697:716,757:770,1277:1414,1421:1428,1446:1454,1459:1478,1529:1532,1789:1876,2059:2339,2347:2352,2361:2384,3299:3459,5420:5443,5900:5950,5963:5976,5991:6086,7311:7366,7375:7449,7458:7530,8425:8494,8507:8533,8537:8557,9233:9368,9687:9817,10017:10147,11027:11069,11085:11100,11115:11122,11135:11141,11338:11483,11847:12117,12275:12446,13061:13125,13154:13188,15748:15772,15795:15818,15835:15847,15877:15913,15962:15972,16484:16514,17368:17399,17523:17629,17693:17721,18613:18639,19239:19254,19574:19588,19593:19638,19794:19853,19876:19918,19975:20043,20073:20191,20344:20666,20850:21100,21168:21202,21313:21322,21338:21353,21390:21441,21462:21479,21925:21955,21989:22001,22006:22044,22069:22089)' = c(-40 , 150),   # 'IMP_kso::k.sol | change = pctchg 
  'IMP_bd::bd.sol | change = pctchg | unit =       c(53:67,97:229,432:466,493:537,600:606,626:676,697:716,757:770,1277:1414,1421:1428,1446:1454,1459:1478,1529:1532,1789:1876,2059:2339,2347:2352,2361:2384,3299:3459,5420:5443,5900:5950,5963:5976,5991:6086,7311:7366,7375:7449,7458:7530,8425:8494,8507:8533,8537:8557,9233:9368,9687:9817,10017:10147,11027:11069,11085:11100,11115:11122,11135:11141,11338:11483,11847:12117,12275:12446,13061:13125,13154:13188,15748:15772,15795:15818,15835:15847,15877:15913,15962:15972,16484:16514,17368:17399,17523:17629,17693:17721,18613:18639,19239:19254,19574:19588,19593:19638,19794:19853,19876:19918,19975:20043,20073:20191,20344:20666,20850:21100,21168:21202,21313:21322,21338:21353,21390:21441,21462:21479,21925:21955,21989:22001,22006:22044,22069:22089)' = c(-30 , 10),    # 'IMP_bd::bd.sol | change = pctchg 
  
  
  'CRB_esc::esco.hru | change = absval | unit =    c(1:6,43:52,68:96,364:382,615:625,771:776,858:887,1052:1059,1092:1099,1120:1136,1181:1199,1217:1276,1429:1445,1653:1714,1745:1749,1905:2007,2042:2058,2413:2442,2553:2623,2662:2691,2716:2900,2917:2936,2970:2999,3019:3054,3077:3078,3217:3263,3880:3934,3977:4080,4164:4256,4402:4433,4538:4634,4662:4747,4773:4786,4793:4832,5795:5845,6164:6238,6441:6453,6460:6504,6531:6566,6584:6647,6680:6706,6733:6779,6846:6895,6916:6976,6998:7008,7035:7039,7133:7136,7190:7310,7854:7862,8118:8192,8248:8258,8273:8424,8683:8713,8730:8777,9058:9232,9369:9461,9469:9488,9493:9504,9509:9539,9556:9603,10193:10275,10302:10314,10328:10353,10368:10392,10405:10496,10511:10653,10733:10765,10873:10899,10992:11026,11305:11337,11697:11721,11819:11846,12118:12122,12197:12210,12263:12274,12481:12483,12504:12510,13189:13208,13223:13237,13494:13501,13655:13667,13971:13985,14329:14346,14709:14722,14743:14769,14810:14826,14888:14901,14953:14991,15007:15059,15136:15142,15202:15220,17246:17279,17310:17343,17437:17454,18123:18142,18218:18233,18514:18535,18896:18910,19255:19276,19395:19405,20218:20245,20749:20758,20840:20849,21209:21213,21226:21235)' = c(0.001 , 0.8),        # CRB_esc::esco.hru | change = absval           
  'CRB_epc::epco.hru | change = absval | unit =    c(1:6,43:52,68:96,364:382,615:625,771:776,858:887,1052:1059,1092:1099,1120:1136,1181:1199,1217:1276,1429:1445,1653:1714,1745:1749,1905:2007,2042:2058,2413:2442,2553:2623,2662:2691,2716:2900,2917:2936,2970:2999,3019:3054,3077:3078,3217:3263,3880:3934,3977:4080,4164:4256,4402:4433,4538:4634,4662:4747,4773:4786,4793:4832,5795:5845,6164:6238,6441:6453,6460:6504,6531:6566,6584:6647,6680:6706,6733:6779,6846:6895,6916:6976,6998:7008,7035:7039,7133:7136,7190:7310,7854:7862,8118:8192,8248:8258,8273:8424,8683:8713,8730:8777,9058:9232,9369:9461,9469:9488,9493:9504,9509:9539,9556:9603,10193:10275,10302:10314,10328:10353,10368:10392,10405:10496,10511:10653,10733:10765,10873:10899,10992:11026,11305:11337,11697:11721,11819:11846,12118:12122,12197:12210,12263:12274,12481:12483,12504:12510,13189:13208,13223:13237,13494:13501,13655:13667,13971:13985,14329:14346,14709:14722,14743:14769,14810:14826,14888:14901,14953:14991,15007:15059,15136:15142,15202:15220,17246:17279,17310:17343,17437:17454,18123:18142,18218:18233,18514:18535,18896:18910,19255:19276,19395:19405,20218:20245,20749:20758,20840:20849,21209:21213,21226:21235)' = c(0.001 , 0.8),        # CRB_epc::epco.hru | change = absval   
  'CRB_cnn::cn2.hru | change = pctchg | unit =     c(1:6,43:52,68:96,364:382,615:625,771:776,858:887,1052:1059,1092:1099,1120:1136,1181:1199,1217:1276,1429:1445,1653:1714,1745:1749,1905:2007,2042:2058,2413:2442,2553:2623,2662:2691,2716:2900,2917:2936,2970:2999,3019:3054,3077:3078,3217:3263,3880:3934,3977:4080,4164:4256,4402:4433,4538:4634,4662:4747,4773:4786,4793:4832,5795:5845,6164:6238,6441:6453,6460:6504,6531:6566,6584:6647,6680:6706,6733:6779,6846:6895,6916:6976,6998:7008,7035:7039,7133:7136,7190:7310,7854:7862,8118:8192,8248:8258,8273:8424,8683:8713,8730:8777,9058:9232,9369:9461,9469:9488,9493:9504,9509:9539,9556:9603,10193:10275,10302:10314,10328:10353,10368:10392,10405:10496,10511:10653,10733:10765,10873:10899,10992:11026,11305:11337,11697:11721,11819:11846,12118:12122,12197:12210,12263:12274,12481:12483,12504:12510,13189:13208,13223:13237,13494:13501,13655:13667,13971:13985,14329:14346,14709:14722,14743:14769,14810:14826,14888:14901,14953:14991,15007:15059,15136:15142,15202:15220,17246:17279,17310:17343,17437:17454,18123:18142,18218:18233,18514:18535,18896:18910,19255:19276,19395:19405,20218:20245,20749:20758,20840:20849,21209:21213,21226:21235)' = c(-10,  20),   # CRB_cnn::cn2.hru | change = pctchg           
  'CRB_awc::awc.sol | change = pctchg | unit =     c(1:6,43:52,68:96,364:382,615:625,771:776,858:887,1052:1059,1092:1099,1120:1136,1181:1199,1217:1276,1429:1445,1653:1714,1745:1749,1905:2007,2042:2058,2413:2442,2553:2623,2662:2691,2716:2900,2917:2936,2970:2999,3019:3054,3077:3078,3217:3263,3880:3934,3977:4080,4164:4256,4402:4433,4538:4634,4662:4747,4773:4786,4793:4832,5795:5845,6164:6238,6441:6453,6460:6504,6531:6566,6584:6647,6680:6706,6733:6779,6846:6895,6916:6976,6998:7008,7035:7039,7133:7136,7190:7310,7854:7862,8118:8192,8248:8258,8273:8424,8683:8713,8730:8777,9058:9232,9369:9461,9469:9488,9493:9504,9509:9539,9556:9603,10193:10275,10302:10314,10328:10353,10368:10392,10405:10496,10511:10653,10733:10765,10873:10899,10992:11026,11305:11337,11697:11721,11819:11846,12118:12122,12197:12210,12263:12274,12481:12483,12504:12510,13189:13208,13223:13237,13494:13501,13655:13667,13971:13985,14329:14346,14709:14722,14743:14769,14810:14826,14888:14901,14953:14991,15007:15059,15136:15142,15202:15220,17246:17279,17310:17343,17437:17454,18123:18142,18218:18233,18514:18535,18896:18910,19255:19276,19395:19405,20218:20245,20749:20758,20840:20849,21209:21213,21226:21235)' = c(-55 , -10),     # CRB_awc::awc.sol | change = pctchg       
  'CRB_per::perco.hru | change = absval | unit =   c(1:6,43:52,68:96,364:382,615:625,771:776,858:887,1052:1059,1092:1099,1120:1136,1181:1199,1217:1276,1429:1445,1653:1714,1745:1749,1905:2007,2042:2058,2413:2442,2553:2623,2662:2691,2716:2900,2917:2936,2970:2999,3019:3054,3077:3078,3217:3263,3880:3934,3977:4080,4164:4256,4402:4433,4538:4634,4662:4747,4773:4786,4793:4832,5795:5845,6164:6238,6441:6453,6460:6504,6531:6566,6584:6647,6680:6706,6733:6779,6846:6895,6916:6976,6998:7008,7035:7039,7133:7136,7190:7310,7854:7862,8118:8192,8248:8258,8273:8424,8683:8713,8730:8777,9058:9232,9369:9461,9469:9488,9493:9504,9509:9539,9556:9603,10193:10275,10302:10314,10328:10353,10368:10392,10405:10496,10511:10653,10733:10765,10873:10899,10992:11026,11305:11337,11697:11721,11819:11846,12118:12122,12197:12210,12263:12274,12481:12483,12504:12510,13189:13208,13223:13237,13494:13501,13655:13667,13971:13985,14329:14346,14709:14722,14743:14769,14810:14826,14888:14901,14953:14991,15007:15059,15136:15142,15202:15220,17246:17279,17310:17343,17437:17454,18123:18142,18218:18233,18514:18535,18896:18910,19255:19276,19395:19405,20218:20245,20749:20758,20840:20849,21209:21213,21226:21235)' = c(0.8 , 0.95),          # CRB_per::perco.hru | change = absval
  'CRB_latq::latq_co.hru | change = abschg | unit =   c(1:6,43:52,68:96,364:382,615:625,771:776,858:887,1052:1059,1092:1099,1120:1136,1181:1199,1217:1276,1429:1445,1653:1714,1745:1749,1905:2007,2042:2058,2413:2442,2553:2623,2662:2691,2716:2900,2917:2936,2970:2999,3019:3054,3077:3078,3217:3263,3880:3934,3977:4080,4164:4256,4402:4433,4538:4634,4662:4747,4773:4786,4793:4832,5795:5845,6164:6238,6441:6453,6460:6504,6531:6566,6584:6647,6680:6706,6733:6779,6846:6895,6916:6976,6998:7008,7035:7039,7133:7136,7190:7310,7854:7862,8118:8192,8248:8258,8273:8424,8683:8713,8730:8777,9058:9232,9369:9461,9469:9488,9493:9504,9509:9539,9556:9603,10193:10275,10302:10314,10328:10353,10368:10392,10405:10496,10511:10653,10733:10765,10873:10899,10992:11026,11305:11337,11697:11721,11819:11846,12118:12122,12197:12210,12263:12274,12481:12483,12504:12510,13189:13208,13223:13237,13494:13501,13655:13667,13971:13985,14329:14346,14709:14722,14743:14769,14810:14826,14888:14901,14953:14991,15007:15059,15136:15142,15202:15220,17246:17279,17310:17343,17437:17454,18123:18142,18218:18233,18514:18535,18896:18910,19255:19276,19395:19405,20218:20245,20749:20758,20840:20849,21209:21213,21226:21235)' = c(-0.5, 0.25),         # CRB_latq::latq_co.hru | change = abschg    
  'CRB_cn3::cn3_swf.hru | change = abschg | unit = c(1:6,43:52,68:96,364:382,615:625,771:776,858:887,1052:1059,1092:1099,1120:1136,1181:1199,1217:1276,1429:1445,1653:1714,1745:1749,1905:2007,2042:2058,2413:2442,2553:2623,2662:2691,2716:2900,2917:2936,2970:2999,3019:3054,3077:3078,3217:3263,3880:3934,3977:4080,4164:4256,4402:4433,4538:4634,4662:4747,4773:4786,4793:4832,5795:5845,6164:6238,6441:6453,6460:6504,6531:6566,6584:6647,6680:6706,6733:6779,6846:6895,6916:6976,6998:7008,7035:7039,7133:7136,7190:7310,7854:7862,8118:8192,8248:8258,8273:8424,8683:8713,8730:8777,9058:9232,9369:9461,9469:9488,9493:9504,9509:9539,9556:9603,10193:10275,10302:10314,10328:10353,10368:10392,10405:10496,10511:10653,10733:10765,10873:10899,10992:11026,11305:11337,11697:11721,11819:11846,12118:12122,12197:12210,12263:12274,12481:12483,12504:12510,13189:13208,13223:13237,13494:13501,13655:13667,13971:13985,14329:14346,14709:14722,14743:14769,14810:14826,14888:14901,14953:14991,15007:15059,15136:15142,15202:15220,17246:17279,17310:17343,17437:17454,18123:18142,18218:18233,18514:18535,18896:18910,19255:19276,19395:19405,20218:20245,20749:20758,20840:20849,21209:21213,21226:21235)' = c(-0.25, 0.375),            # CRB_cn3::cn3_swf.hru | change = abschg         
  'CRB_zso::z.sol | change = pctchg | unit =       c(1:6,43:52,68:96,364:382,615:625,771:776,858:887,1052:1059,1092:1099,1120:1136,1181:1199,1217:1276,1429:1445,1653:1714,1745:1749,1905:2007,2042:2058,2413:2442,2553:2623,2662:2691,2716:2900,2917:2936,2970:2999,3019:3054,3077:3078,3217:3263,3880:3934,3977:4080,4164:4256,4402:4433,4538:4634,4662:4747,4773:4786,4793:4832,5795:5845,6164:6238,6441:6453,6460:6504,6531:6566,6584:6647,6680:6706,6733:6779,6846:6895,6916:6976,6998:7008,7035:7039,7133:7136,7190:7310,7854:7862,8118:8192,8248:8258,8273:8424,8683:8713,8730:8777,9058:9232,9369:9461,9469:9488,9493:9504,9509:9539,9556:9603,10193:10275,10302:10314,10328:10353,10368:10392,10405:10496,10511:10653,10733:10765,10873:10899,10992:11026,11305:11337,11697:11721,11819:11846,12118:12122,12197:12210,12263:12274,12481:12483,12504:12510,13189:13208,13223:13237,13494:13501,13655:13667,13971:13985,14329:14346,14709:14722,14743:14769,14810:14826,14888:14901,14953:14991,15007:15059,15136:15142,15202:15220,17246:17279,17310:17343,17437:17454,18123:18142,18218:18233,18514:18535,18896:18910,19255:19276,19395:19405,20218:20245,20749:20758,20840:20849,21209:21213,21226:21235)' = c(-49.999 , 0),     # CRB_zso::z.sol | change = pctchg       
  'CRB_kso::k.sol | change = pctchg | unit =       c(1:6,43:52,68:96,364:382,615:625,771:776,858:887,1052:1059,1092:1099,1120:1136,1181:1199,1217:1276,1429:1445,1653:1714,1745:1749,1905:2007,2042:2058,2413:2442,2553:2623,2662:2691,2716:2900,2917:2936,2970:2999,3019:3054,3077:3078,3217:3263,3880:3934,3977:4080,4164:4256,4402:4433,4538:4634,4662:4747,4773:4786,4793:4832,5795:5845,6164:6238,6441:6453,6460:6504,6531:6566,6584:6647,6680:6706,6733:6779,6846:6895,6916:6976,6998:7008,7035:7039,7133:7136,7190:7310,7854:7862,8118:8192,8248:8258,8273:8424,8683:8713,8730:8777,9058:9232,9369:9461,9469:9488,9493:9504,9509:9539,9556:9603,10193:10275,10302:10314,10328:10353,10368:10392,10405:10496,10511:10653,10733:10765,10873:10899,10992:11026,11305:11337,11697:11721,11819:11846,12118:12122,12197:12210,12263:12274,12481:12483,12504:12510,13189:13208,13223:13237,13494:13501,13655:13667,13971:13985,14329:14346,14709:14722,14743:14769,14810:14826,14888:14901,14953:14991,15007:15059,15136:15142,15202:15220,17246:17279,17310:17343,17437:17454,18123:18142,18218:18233,18514:18535,18896:18910,19255:19276,19395:19405,20218:20245,20749:20758,20840:20849,21209:21213,21226:21235)' = c(0 , 175),    # CRB_kso::k.sol | change = pctchg        
  'CRB_bd::bd.sol | change = pctchg | unit =       c(1:6,43:52,68:96,364:382,615:625,771:776,858:887,1052:1059,1092:1099,1120:1136,1181:1199,1217:1276,1429:1445,1653:1714,1745:1749,1905:2007,2042:2058,2413:2442,2553:2623,2662:2691,2716:2900,2917:2936,2970:2999,3019:3054,3077:3078,3217:3263,3880:3934,3977:4080,4164:4256,4402:4433,4538:4634,4662:4747,4773:4786,4793:4832,5795:5845,6164:6238,6441:6453,6460:6504,6531:6566,6584:6647,6680:6706,6733:6779,6846:6895,6916:6976,6998:7008,7035:7039,7133:7136,7190:7310,7854:7862,8118:8192,8248:8258,8273:8424,8683:8713,8730:8777,9058:9232,9369:9461,9469:9488,9493:9504,9509:9539,9556:9603,10193:10275,10302:10314,10328:10353,10368:10392,10405:10496,10511:10653,10733:10765,10873:10899,10992:11026,11305:11337,11697:11721,11819:11846,12118:12122,12197:12210,12263:12274,12481:12483,12504:12510,13189:13208,13223:13237,13494:13501,13655:13667,13971:13985,14329:14346,14709:14722,14743:14769,14810:14826,14888:14901,14953:14991,15007:15059,15136:15142,15202:15220,17246:17279,17310:17343,17437:17454,18123:18142,18218:18233,18514:18535,18896:18910,19255:19276,19395:19405,20218:20245,20749:20758,20840:20849,21209:21213,21226:21235)' = c(-20 , 10),     # CRB_bd::bd.sol | change = pctchg      
  
  
  'DTH_esc::esco.hru | change = absval | unit =    c( 230:335,538:599,677:696,717:756,945:982,1060:1091,1200:1216,1415:1420,1455:1458,1479:1528,1533:1652,1750:1788,2008:2041,2340:2346,2353:2360,2901:2916,2937:2969,3000:3018,3055:3076,3289:3298,3460:3610,3623:3651,3674:3701,3718:3814,4081:4108,4661:4661,4833:5419,5444:5794,5846:5871,5951:5962,5977:5990,6087:6163,6239:6379,6414:6440,6454:6459,6505:6530,6825:6845,6896:6915,6977:6997,7009:7034,7040:7132,7137:7189,7367:7374,7450:7457,7531:7553,7688:7717,7746:7753,7768:7853,7863:8037,8052:8068,8088:8117,8193:8247,8259:8272,8495:8506,8534:8536,8558:8682,8714:8729,8778:9057,9462:9468,9489:9492,9505:9508,9540:9555,9604:9669,9683:9686,9818:9921,9939:9961,9976:10016,10148:10192,10276:10301,10315:10327,10668:10694,10766:10872,10900:10919,10942:10965,11070:11084,11101:11114,11123:11134,11142:11304,11484:11511,11561:11616,11629:11635,11659:11696,11722:11794,12123:12196,12211:12262,12447:12480,12484:12503,12511:12534,12572:13033,13054:13060,13126:13153,13238:13281,13292:13362,13373:13493,13502:13536,13704:13723,13734:13759,13807:13833,13918:13970,13986:13992,14102:14111,14208:14224,14250:14255,14325:14328,14353:14428,14453:14536,14550:14673,14693:14708,14723:14742,14866:14887,15060:15100,15172:15172,15221:15313,15351:15400,15423:15434,15457:15496,15522:15563,15608:15636,15672:15747,15773:15794,15819:15834,15848:15876,15914:15961,15973:16103,16112:16209,16215:16245,16288:16419,16431:16440,16453:16483,16515:16610,16661:16687,16717:16774,17039:17075,17101:17141,17239:17245,17280:17286,17400:17436,17630:17692,17722:17980,18029:18080,18143:18217,18234:18254,18292:18406,18417:18427,18435:18466,18492:18498,18536:18612,18640:18750,18756:18825,18975:19238,19315:19394,19406:19573,19589:19592,19639:19793,19854:19875,19919:19974,20044:20072,20192:20217,20271:20343,20682:20696,20737:20748,20764:20773,21101:21167,21203:21208,21214:21225,21236:21312,21323:21337,21354:21389,21442:21461,21480:21505,21577:21589,21648:21924,21956:21988,22002:22005,22045:22068)' = c(0.25 , 0.999),      # DTH_esc::esco.hru | change = absval                         
  'DTH_epc::epco.hru | change = absval | unit =    c( 230:335,538:599,677:696,717:756,945:982,1060:1091,1200:1216,1415:1420,1455:1458,1479:1528,1533:1652,1750:1788,2008:2041,2340:2346,2353:2360,2901:2916,2937:2969,3000:3018,3055:3076,3289:3298,3460:3610,3623:3651,3674:3701,3718:3814,4081:4108,4661:4661,4833:5419,5444:5794,5846:5871,5951:5962,5977:5990,6087:6163,6239:6379,6414:6440,6454:6459,6505:6530,6825:6845,6896:6915,6977:6997,7009:7034,7040:7132,7137:7189,7367:7374,7450:7457,7531:7553,7688:7717,7746:7753,7768:7853,7863:8037,8052:8068,8088:8117,8193:8247,8259:8272,8495:8506,8534:8536,8558:8682,8714:8729,8778:9057,9462:9468,9489:9492,9505:9508,9540:9555,9604:9669,9683:9686,9818:9921,9939:9961,9976:10016,10148:10192,10276:10301,10315:10327,10668:10694,10766:10872,10900:10919,10942:10965,11070:11084,11101:11114,11123:11134,11142:11304,11484:11511,11561:11616,11629:11635,11659:11696,11722:11794,12123:12196,12211:12262,12447:12480,12484:12503,12511:12534,12572:13033,13054:13060,13126:13153,13238:13281,13292:13362,13373:13493,13502:13536,13704:13723,13734:13759,13807:13833,13918:13970,13986:13992,14102:14111,14208:14224,14250:14255,14325:14328,14353:14428,14453:14536,14550:14673,14693:14708,14723:14742,14866:14887,15060:15100,15172:15172,15221:15313,15351:15400,15423:15434,15457:15496,15522:15563,15608:15636,15672:15747,15773:15794,15819:15834,15848:15876,15914:15961,15973:16103,16112:16209,16215:16245,16288:16419,16431:16440,16453:16483,16515:16610,16661:16687,16717:16774,17039:17075,17101:17141,17239:17245,17280:17286,17400:17436,17630:17692,17722:17980,18029:18080,18143:18217,18234:18254,18292:18406,18417:18427,18435:18466,18492:18498,18536:18612,18640:18750,18756:18825,18975:19238,19315:19394,19406:19573,19589:19592,19639:19793,19854:19875,19919:19974,20044:20072,20192:20217,20271:20343,20682:20696,20737:20748,20764:20773,21101:21167,21203:21208,21214:21225,21236:21312,21323:21337,21354:21389,21442:21461,21480:21505,21577:21589,21648:21924,21956:21988,22002:22005,22045:22068)' = c(0.25 , 0.999),      # DTH_epc::epco.hru | change = absval     
  'DTH_cnn::cn2.hru | change = pctchg | unit =     c( 230:335,538:599,677:696,717:756,945:982,1060:1091,1200:1216,1415:1420,1455:1458,1479:1528,1533:1652,1750:1788,2008:2041,2340:2346,2353:2360,2901:2916,2937:2969,3000:3018,3055:3076,3289:3298,3460:3610,3623:3651,3674:3701,3718:3814,4081:4108,4661:4661,4833:5419,5444:5794,5846:5871,5951:5962,5977:5990,6087:6163,6239:6379,6414:6440,6454:6459,6505:6530,6825:6845,6896:6915,6977:6997,7009:7034,7040:7132,7137:7189,7367:7374,7450:7457,7531:7553,7688:7717,7746:7753,7768:7853,7863:8037,8052:8068,8088:8117,8193:8247,8259:8272,8495:8506,8534:8536,8558:8682,8714:8729,8778:9057,9462:9468,9489:9492,9505:9508,9540:9555,9604:9669,9683:9686,9818:9921,9939:9961,9976:10016,10148:10192,10276:10301,10315:10327,10668:10694,10766:10872,10900:10919,10942:10965,11070:11084,11101:11114,11123:11134,11142:11304,11484:11511,11561:11616,11629:11635,11659:11696,11722:11794,12123:12196,12211:12262,12447:12480,12484:12503,12511:12534,12572:13033,13054:13060,13126:13153,13238:13281,13292:13362,13373:13493,13502:13536,13704:13723,13734:13759,13807:13833,13918:13970,13986:13992,14102:14111,14208:14224,14250:14255,14325:14328,14353:14428,14453:14536,14550:14673,14693:14708,14723:14742,14866:14887,15060:15100,15172:15172,15221:15313,15351:15400,15423:15434,15457:15496,15522:15563,15608:15636,15672:15747,15773:15794,15819:15834,15848:15876,15914:15961,15973:16103,16112:16209,16215:16245,16288:16419,16431:16440,16453:16483,16515:16610,16661:16687,16717:16774,17039:17075,17101:17141,17239:17245,17280:17286,17400:17436,17630:17692,17722:17980,18029:18080,18143:18217,18234:18254,18292:18406,18417:18427,18435:18466,18492:18498,18536:18612,18640:18750,18756:18825,18975:19238,19315:19394,19406:19573,19589:19592,19639:19793,19854:19875,19919:19974,20044:20072,20192:20217,20271:20343,20682:20696,20737:20748,20764:20773,21101:21167,21203:21208,21214:21225,21236:21312,21323:21337,21354:21389,21442:21461,21480:21505,21577:21589,21648:21924,21956:21988,22002:22005,22045:22068)' = c(-29.999  ,  0), # DTH_cnn::cn2.hru | change = pctchg             
  'DTH_awc::awc.sol | change = pctchg | unit =     c( 230:335,538:599,677:696,717:756,945:982,1060:1091,1200:1216,1415:1420,1455:1458,1479:1528,1533:1652,1750:1788,2008:2041,2340:2346,2353:2360,2901:2916,2937:2969,3000:3018,3055:3076,3289:3298,3460:3610,3623:3651,3674:3701,3718:3814,4081:4108,4661:4661,4833:5419,5444:5794,5846:5871,5951:5962,5977:5990,6087:6163,6239:6379,6414:6440,6454:6459,6505:6530,6825:6845,6896:6915,6977:6997,7009:7034,7040:7132,7137:7189,7367:7374,7450:7457,7531:7553,7688:7717,7746:7753,7768:7853,7863:8037,8052:8068,8088:8117,8193:8247,8259:8272,8495:8506,8534:8536,8558:8682,8714:8729,8778:9057,9462:9468,9489:9492,9505:9508,9540:9555,9604:9669,9683:9686,9818:9921,9939:9961,9976:10016,10148:10192,10276:10301,10315:10327,10668:10694,10766:10872,10900:10919,10942:10965,11070:11084,11101:11114,11123:11134,11142:11304,11484:11511,11561:11616,11629:11635,11659:11696,11722:11794,12123:12196,12211:12262,12447:12480,12484:12503,12511:12534,12572:13033,13054:13060,13126:13153,13238:13281,13292:13362,13373:13493,13502:13536,13704:13723,13734:13759,13807:13833,13918:13970,13986:13992,14102:14111,14208:14224,14250:14255,14325:14328,14353:14428,14453:14536,14550:14673,14693:14708,14723:14742,14866:14887,15060:15100,15172:15172,15221:15313,15351:15400,15423:15434,15457:15496,15522:15563,15608:15636,15672:15747,15773:15794,15819:15834,15848:15876,15914:15961,15973:16103,16112:16209,16215:16245,16288:16419,16431:16440,16453:16483,16515:16610,16661:16687,16717:16774,17039:17075,17101:17141,17239:17245,17280:17286,17400:17436,17630:17692,17722:17980,18029:18080,18143:18217,18234:18254,18292:18406,18417:18427,18435:18466,18492:18498,18536:18612,18640:18750,18756:18825,18975:19238,19315:19394,19406:19573,19589:19592,19639:19793,19854:19875,19919:19974,20044:20072,20192:20217,20271:20343,20682:20696,20737:20748,20764:20773,21101:21167,21203:21208,21214:21225,21236:21312,21323:21337,21354:21389,21442:21461,21480:21505,21577:21589,21648:21924,21956:21988,22002:22005,22045:22068)' = c(5 , 59.999),   # DTH_awc::awc.sol | change = pctchg         
  'DTH_per::perco.hru | change = absval | unit =   c( 230:335,538:599,677:696,717:756,945:982,1060:1091,1200:1216,1415:1420,1455:1458,1479:1528,1533:1652,1750:1788,2008:2041,2340:2346,2353:2360,2901:2916,2937:2969,3000:3018,3055:3076,3289:3298,3460:3610,3623:3651,3674:3701,3718:3814,4081:4108,4661:4661,4833:5419,5444:5794,5846:5871,5951:5962,5977:5990,6087:6163,6239:6379,6414:6440,6454:6459,6505:6530,6825:6845,6896:6915,6977:6997,7009:7034,7040:7132,7137:7189,7367:7374,7450:7457,7531:7553,7688:7717,7746:7753,7768:7853,7863:8037,8052:8068,8088:8117,8193:8247,8259:8272,8495:8506,8534:8536,8558:8682,8714:8729,8778:9057,9462:9468,9489:9492,9505:9508,9540:9555,9604:9669,9683:9686,9818:9921,9939:9961,9976:10016,10148:10192,10276:10301,10315:10327,10668:10694,10766:10872,10900:10919,10942:10965,11070:11084,11101:11114,11123:11134,11142:11304,11484:11511,11561:11616,11629:11635,11659:11696,11722:11794,12123:12196,12211:12262,12447:12480,12484:12503,12511:12534,12572:13033,13054:13060,13126:13153,13238:13281,13292:13362,13373:13493,13502:13536,13704:13723,13734:13759,13807:13833,13918:13970,13986:13992,14102:14111,14208:14224,14250:14255,14325:14328,14353:14428,14453:14536,14550:14673,14693:14708,14723:14742,14866:14887,15060:15100,15172:15172,15221:15313,15351:15400,15423:15434,15457:15496,15522:15563,15608:15636,15672:15747,15773:15794,15819:15834,15848:15876,15914:15961,15973:16103,16112:16209,16215:16245,16288:16419,16431:16440,16453:16483,16515:16610,16661:16687,16717:16774,17039:17075,17101:17141,17239:17245,17280:17286,17400:17436,17630:17692,17722:17980,18029:18080,18143:18217,18234:18254,18292:18406,18417:18427,18435:18466,18492:18498,18536:18612,18640:18750,18756:18825,18975:19238,19315:19394,19406:19573,19589:19592,19639:19793,19854:19875,19919:19974,20044:20072,20192:20217,20271:20343,20682:20696,20737:20748,20764:20773,21101:21167,21203:21208,21214:21225,21236:21312,21323:21337,21354:21389,21442:21461,21480:21505,21577:21589,21648:21924,21956:21988,22002:22005,22045:22068)' = c(0.75 , 0.9),        # DTH_per::perco.hru | change = absval  
  'DTH_latq::latq_co.hru | change = abschg | unit =   c( 230:335,538:599,677:696,717:756,945:982,1060:1091,1200:1216,1415:1420,1455:1458,1479:1528,1533:1652,1750:1788,2008:2041,2340:2346,2353:2360,2901:2916,2937:2969,3000:3018,3055:3076,3289:3298,3460:3610,3623:3651,3674:3701,3718:3814,4081:4108,4661:4661,4833:5419,5444:5794,5846:5871,5951:5962,5977:5990,6087:6163,6239:6379,6414:6440,6454:6459,6505:6530,6825:6845,6896:6915,6977:6997,7009:7034,7040:7132,7137:7189,7367:7374,7450:7457,7531:7553,7688:7717,7746:7753,7768:7853,7863:8037,8052:8068,8088:8117,8193:8247,8259:8272,8495:8506,8534:8536,8558:8682,8714:8729,8778:9057,9462:9468,9489:9492,9505:9508,9540:9555,9604:9669,9683:9686,9818:9921,9939:9961,9976:10016,10148:10192,10276:10301,10315:10327,10668:10694,10766:10872,10900:10919,10942:10965,11070:11084,11101:11114,11123:11134,11142:11304,11484:11511,11561:11616,11629:11635,11659:11696,11722:11794,12123:12196,12211:12262,12447:12480,12484:12503,12511:12534,12572:13033,13054:13060,13126:13153,13238:13281,13292:13362,13373:13493,13502:13536,13704:13723,13734:13759,13807:13833,13918:13970,13986:13992,14102:14111,14208:14224,14250:14255,14325:14328,14353:14428,14453:14536,14550:14673,14693:14708,14723:14742,14866:14887,15060:15100,15172:15172,15221:15313,15351:15400,15423:15434,15457:15496,15522:15563,15608:15636,15672:15747,15773:15794,15819:15834,15848:15876,15914:15961,15973:16103,16112:16209,16215:16245,16288:16419,16431:16440,16453:16483,16515:16610,16661:16687,16717:16774,17039:17075,17101:17141,17239:17245,17280:17286,17400:17436,17630:17692,17722:17980,18029:18080,18143:18217,18234:18254,18292:18406,18417:18427,18435:18466,18492:18498,18536:18612,18640:18750,18756:18825,18975:19238,19315:19394,19406:19573,19589:19592,19639:19793,19854:19875,19919:19974,20044:20072,20192:20217,20271:20343,20682:20696,20737:20748,20764:20773,21101:21167,21203:21208,21214:21225,21236:21312,21323:21337,21354:21389,21442:21461,21480:21505,21577:21589,21648:21924,21956:21988,22002:22005,22045:22068)' = c(-0.5, 0.2),       # DTH_latq::latq_co.hru | change = abschg      
  'DTH_cn3::cn3_swf.hru | change = abschg | unit = c( 230:335,538:599,677:696,717:756,945:982,1060:1091,1200:1216,1415:1420,1455:1458,1479:1528,1533:1652,1750:1788,2008:2041,2340:2346,2353:2360,2901:2916,2937:2969,3000:3018,3055:3076,3289:3298,3460:3610,3623:3651,3674:3701,3718:3814,4081:4108,4661:4661,4833:5419,5444:5794,5846:5871,5951:5962,5977:5990,6087:6163,6239:6379,6414:6440,6454:6459,6505:6530,6825:6845,6896:6915,6977:6997,7009:7034,7040:7132,7137:7189,7367:7374,7450:7457,7531:7553,7688:7717,7746:7753,7768:7853,7863:8037,8052:8068,8088:8117,8193:8247,8259:8272,8495:8506,8534:8536,8558:8682,8714:8729,8778:9057,9462:9468,9489:9492,9505:9508,9540:9555,9604:9669,9683:9686,9818:9921,9939:9961,9976:10016,10148:10192,10276:10301,10315:10327,10668:10694,10766:10872,10900:10919,10942:10965,11070:11084,11101:11114,11123:11134,11142:11304,11484:11511,11561:11616,11629:11635,11659:11696,11722:11794,12123:12196,12211:12262,12447:12480,12484:12503,12511:12534,12572:13033,13054:13060,13126:13153,13238:13281,13292:13362,13373:13493,13502:13536,13704:13723,13734:13759,13807:13833,13918:13970,13986:13992,14102:14111,14208:14224,14250:14255,14325:14328,14353:14428,14453:14536,14550:14673,14693:14708,14723:14742,14866:14887,15060:15100,15172:15172,15221:15313,15351:15400,15423:15434,15457:15496,15522:15563,15608:15636,15672:15747,15773:15794,15819:15834,15848:15876,15914:15961,15973:16103,16112:16209,16215:16245,16288:16419,16431:16440,16453:16483,16515:16610,16661:16687,16717:16774,17039:17075,17101:17141,17239:17245,17280:17286,17400:17436,17630:17692,17722:17980,18029:18080,18143:18217,18234:18254,18292:18406,18417:18427,18435:18466,18492:18498,18536:18612,18640:18750,18756:18825,18975:19238,19315:19394,19406:19573,19589:19592,19639:19793,19854:19875,19919:19974,20044:20072,20192:20217,20271:20343,20682:20696,20737:20748,20764:20773,21101:21167,21203:21208,21214:21225,21236:21312,21323:21337,21354:21389,21442:21461,21480:21505,21577:21589,21648:21924,21956:21988,22002:22005,22045:22068)' = c(-0.1, 0.5),          # DTH_cn3::cn3_swf.hru | change = abschg           
  'DTH_zso::z.sol | change = pctchg | unit =       c( 230:335,538:599,677:696,717:756,945:982,1060:1091,1200:1216,1415:1420,1455:1458,1479:1528,1533:1652,1750:1788,2008:2041,2340:2346,2353:2360,2901:2916,2937:2969,3000:3018,3055:3076,3289:3298,3460:3610,3623:3651,3674:3701,3718:3814,4081:4108,4661:4661,4833:5419,5444:5794,5846:5871,5951:5962,5977:5990,6087:6163,6239:6379,6414:6440,6454:6459,6505:6530,6825:6845,6896:6915,6977:6997,7009:7034,7040:7132,7137:7189,7367:7374,7450:7457,7531:7553,7688:7717,7746:7753,7768:7853,7863:8037,8052:8068,8088:8117,8193:8247,8259:8272,8495:8506,8534:8536,8558:8682,8714:8729,8778:9057,9462:9468,9489:9492,9505:9508,9540:9555,9604:9669,9683:9686,9818:9921,9939:9961,9976:10016,10148:10192,10276:10301,10315:10327,10668:10694,10766:10872,10900:10919,10942:10965,11070:11084,11101:11114,11123:11134,11142:11304,11484:11511,11561:11616,11629:11635,11659:11696,11722:11794,12123:12196,12211:12262,12447:12480,12484:12503,12511:12534,12572:13033,13054:13060,13126:13153,13238:13281,13292:13362,13373:13493,13502:13536,13704:13723,13734:13759,13807:13833,13918:13970,13986:13992,14102:14111,14208:14224,14250:14255,14325:14328,14353:14428,14453:14536,14550:14673,14693:14708,14723:14742,14866:14887,15060:15100,15172:15172,15221:15313,15351:15400,15423:15434,15457:15496,15522:15563,15608:15636,15672:15747,15773:15794,15819:15834,15848:15876,15914:15961,15973:16103,16112:16209,16215:16245,16288:16419,16431:16440,16453:16483,16515:16610,16661:16687,16717:16774,17039:17075,17101:17141,17239:17245,17280:17286,17400:17436,17630:17692,17722:17980,18029:18080,18143:18217,18234:18254,18292:18406,18417:18427,18435:18466,18492:18498,18536:18612,18640:18750,18756:18825,18975:19238,19315:19394,19406:19573,19589:19592,19639:19793,19854:19875,19919:19974,20044:20072,20192:20217,20271:20343,20682:20696,20737:20748,20764:20773,21101:21167,21203:21208,21214:21225,21236:21312,21323:21337,21354:21389,21442:21461,21480:21505,21577:21589,21648:21924,21956:21988,22002:22005,22045:22068)' = c(0 , 49.999),   # DTH_zso::z.sol | change = pctchg         
  'DTH_kso::k.sol | change = pctchg | unit =       c( 230:335,538:599,677:696,717:756,945:982,1060:1091,1200:1216,1415:1420,1455:1458,1479:1528,1533:1652,1750:1788,2008:2041,2340:2346,2353:2360,2901:2916,2937:2969,3000:3018,3055:3076,3289:3298,3460:3610,3623:3651,3674:3701,3718:3814,4081:4108,4661:4661,4833:5419,5444:5794,5846:5871,5951:5962,5977:5990,6087:6163,6239:6379,6414:6440,6454:6459,6505:6530,6825:6845,6896:6915,6977:6997,7009:7034,7040:7132,7137:7189,7367:7374,7450:7457,7531:7553,7688:7717,7746:7753,7768:7853,7863:8037,8052:8068,8088:8117,8193:8247,8259:8272,8495:8506,8534:8536,8558:8682,8714:8729,8778:9057,9462:9468,9489:9492,9505:9508,9540:9555,9604:9669,9683:9686,9818:9921,9939:9961,9976:10016,10148:10192,10276:10301,10315:10327,10668:10694,10766:10872,10900:10919,10942:10965,11070:11084,11101:11114,11123:11134,11142:11304,11484:11511,11561:11616,11629:11635,11659:11696,11722:11794,12123:12196,12211:12262,12447:12480,12484:12503,12511:12534,12572:13033,13054:13060,13126:13153,13238:13281,13292:13362,13373:13493,13502:13536,13704:13723,13734:13759,13807:13833,13918:13970,13986:13992,14102:14111,14208:14224,14250:14255,14325:14328,14353:14428,14453:14536,14550:14673,14693:14708,14723:14742,14866:14887,15060:15100,15172:15172,15221:15313,15351:15400,15423:15434,15457:15496,15522:15563,15608:15636,15672:15747,15773:15794,15819:15834,15848:15876,15914:15961,15973:16103,16112:16209,16215:16245,16288:16419,16431:16440,16453:16483,16515:16610,16661:16687,16717:16774,17039:17075,17101:17141,17239:17245,17280:17286,17400:17436,17630:17692,17722:17980,18029:18080,18143:18217,18234:18254,18292:18406,18417:18427,18435:18466,18492:18498,18536:18612,18640:18750,18756:18825,18975:19238,19315:19394,19406:19573,19589:19592,19639:19793,19854:19875,19919:19974,20044:20072,20192:20217,20271:20343,20682:20696,20737:20748,20764:20773,21101:21167,21203:21208,21214:21225,21236:21312,21323:21337,21354:21389,21442:21461,21480:21505,21577:21589,21648:21924,21956:21988,22002:22005,22045:22068)' = c(-79.999 , 150),  # DTH_kso::k.sol | change = pctchg          
  'DTH_bd::bd.sol | change = pctchg | unit =       c( 230:335,538:599,677:696,717:756,945:982,1060:1091,1200:1216,1415:1420,1455:1458,1479:1528,1533:1652,1750:1788,2008:2041,2340:2346,2353:2360,2901:2916,2937:2969,3000:3018,3055:3076,3289:3298,3460:3610,3623:3651,3674:3701,3718:3814,4081:4108,4661:4661,4833:5419,5444:5794,5846:5871,5951:5962,5977:5990,6087:6163,6239:6379,6414:6440,6454:6459,6505:6530,6825:6845,6896:6915,6977:6997,7009:7034,7040:7132,7137:7189,7367:7374,7450:7457,7531:7553,7688:7717,7746:7753,7768:7853,7863:8037,8052:8068,8088:8117,8193:8247,8259:8272,8495:8506,8534:8536,8558:8682,8714:8729,8778:9057,9462:9468,9489:9492,9505:9508,9540:9555,9604:9669,9683:9686,9818:9921,9939:9961,9976:10016,10148:10192,10276:10301,10315:10327,10668:10694,10766:10872,10900:10919,10942:10965,11070:11084,11101:11114,11123:11134,11142:11304,11484:11511,11561:11616,11629:11635,11659:11696,11722:11794,12123:12196,12211:12262,12447:12480,12484:12503,12511:12534,12572:13033,13054:13060,13126:13153,13238:13281,13292:13362,13373:13493,13502:13536,13704:13723,13734:13759,13807:13833,13918:13970,13986:13992,14102:14111,14208:14224,14250:14255,14325:14328,14353:14428,14453:14536,14550:14673,14693:14708,14723:14742,14866:14887,15060:15100,15172:15172,15221:15313,15351:15400,15423:15434,15457:15496,15522:15563,15608:15636,15672:15747,15773:15794,15819:15834,15848:15876,15914:15961,15973:16103,16112:16209,16215:16245,16288:16419,16431:16440,16453:16483,16515:16610,16661:16687,16717:16774,17039:17075,17101:17141,17239:17245,17280:17286,17400:17436,17630:17692,17722:17980,18029:18080,18143:18217,18234:18254,18292:18406,18417:18427,18435:18466,18492:18498,18536:18612,18640:18750,18756:18825,18975:19238,19315:19394,19406:19573,19589:19592,19639:19793,19854:19875,19919:19974,20044:20072,20192:20217,20271:20343,20682:20696,20737:20748,20764:20773,21101:21167,21203:21208,21214:21225,21236:21312,21323:21337,21354:21389,21442:21461,21480:21505,21577:21589,21648:21924,21956:21988,22002:22005,22045:22068)' = c(-29.999 , 5),   # DTH_bd::bd.sol | change = pctchg        
  
  
  'DTL_esc::esco.hru | change = absval | unit =    c(  7:42,336:363,383:431,467:492,607:614,777:857,888:944,983:1051,1100:1119,1137:1180,1715:1744,1877:1904,2385:2412,2443:2552,2624:2661,2692:2715,3079:3216,3264:3288,3611:3622,3652:3673,3702:3717,3815:3879,3935:3976,4109:4163,4257:4401,4434:4537,4635:4660,4748:4772,4787:4792,5872:5899,6380:6413,6567:6583,6648:6679,6707:6732,6780:6824,7554:7687,7718:7745,7754:7767,8038:8051,8069:8087,9670:9682,9922:9938,9962:9975,10354:10367,10393:10404,10497:10510,10654:10667,10695:10732,10920:10941,10966:10991,11512:11560,11617:11628,11636:11658,11795:11818,12535:12571,13034:13053,13209:13222,13282:13291,13363:13372,13537:13654,13668:13703,13724:13733,13760:13806,13834:13917,13993:14101,14112:14207,14225:14249,14256:14324,14347:14352,14429:14452,14537:14549,14674:14692,14770:14809,14827:14865,14902:14952,14992:15006,15101:15135,15143:15171,15173:15201,15314:15350,15401:15422,15435:15456,15497:15521,15564:15607,15637:15671,16104:16111,16210:16214,16246:16287,16420:16430,16441:16452,16611:16660,16688:16716,16775:17038,17076:17100,17142:17238,17287:17309,17344:17367,17455:17522,17981:18028,18081:18122,18255:18291,18407:18416,18428:18434,18467:18491,18499:18513,18751:18755,18826:18895,18911:18974,19277:19314,20246:20270,20667:20681,20697:20736,20759:20763,20774:20839,21506:21576,21590:21647 )' = c(0.25 , 0.999),      # DTL_esc::esco.hru | change = absval       
  'DTL_epc::epco.hru | change = absval | unit =    c(  7:42,336:363,383:431,467:492,607:614,777:857,888:944,983:1051,1100:1119,1137:1180,1715:1744,1877:1904,2385:2412,2443:2552,2624:2661,2692:2715,3079:3216,3264:3288,3611:3622,3652:3673,3702:3717,3815:3879,3935:3976,4109:4163,4257:4401,4434:4537,4635:4660,4748:4772,4787:4792,5872:5899,6380:6413,6567:6583,6648:6679,6707:6732,6780:6824,7554:7687,7718:7745,7754:7767,8038:8051,8069:8087,9670:9682,9922:9938,9962:9975,10354:10367,10393:10404,10497:10510,10654:10667,10695:10732,10920:10941,10966:10991,11512:11560,11617:11628,11636:11658,11795:11818,12535:12571,13034:13053,13209:13222,13282:13291,13363:13372,13537:13654,13668:13703,13724:13733,13760:13806,13834:13917,13993:14101,14112:14207,14225:14249,14256:14324,14347:14352,14429:14452,14537:14549,14674:14692,14770:14809,14827:14865,14902:14952,14992:15006,15101:15135,15143:15171,15173:15201,15314:15350,15401:15422,15435:15456,15497:15521,15564:15607,15637:15671,16104:16111,16210:16214,16246:16287,16420:16430,16441:16452,16611:16660,16688:16716,16775:17038,17076:17100,17142:17238,17287:17309,17344:17367,17455:17522,17981:18028,18081:18122,18255:18291,18407:18416,18428:18434,18467:18491,18499:18513,18751:18755,18826:18895,18911:18974,19277:19314,20246:20270,20667:20681,20697:20736,20759:20763,20774:20839,21506:21576,21590:21647 )' = c(0.25 , 0.999),      # DTL_epc::epco.hru | change = absval  
  'DTL_cnn::cn2.hru | change = pctchg | unit =     c(  7:42,336:363,383:431,467:492,607:614,777:857,888:944,983:1051,1100:1119,1137:1180,1715:1744,1877:1904,2385:2412,2443:2552,2624:2661,2692:2715,3079:3216,3264:3288,3611:3622,3652:3673,3702:3717,3815:3879,3935:3976,4109:4163,4257:4401,4434:4537,4635:4660,4748:4772,4787:4792,5872:5899,6380:6413,6567:6583,6648:6679,6707:6732,6780:6824,7554:7687,7718:7745,7754:7767,8038:8051,8069:8087,9670:9682,9922:9938,9962:9975,10354:10367,10393:10404,10497:10510,10654:10667,10695:10732,10920:10941,10966:10991,11512:11560,11617:11628,11636:11658,11795:11818,12535:12571,13034:13053,13209:13222,13282:13291,13363:13372,13537:13654,13668:13703,13724:13733,13760:13806,13834:13917,13993:14101,14112:14207,14225:14249,14256:14324,14347:14352,14429:14452,14537:14549,14674:14692,14770:14809,14827:14865,14902:14952,14992:15006,15101:15135,15143:15171,15173:15201,15314:15350,15401:15422,15435:15456,15497:15521,15564:15607,15637:15671,16104:16111,16210:16214,16246:16287,16420:16430,16441:16452,16611:16660,16688:16716,16775:17038,17076:17100,17142:17238,17287:17309,17344:17367,17455:17522,17981:18028,18081:18122,18255:18291,18407:18416,18428:18434,18467:18491,18499:18513,18751:18755,18826:18895,18911:18974,19277:19314,20246:20270,20667:20681,20697:20736,20759:20763,20774:20839,21506:21576,21590:21647 )' = c(-29.999  , 0), # DTL_cnn::cn2.hru | change = pctchg       
  'DTL_awc::awc.sol | change = pctchg | unit =     c(  7:42,336:363,383:431,467:492,607:614,777:857,888:944,983:1051,1100:1119,1137:1180,1715:1744,1877:1904,2385:2412,2443:2552,2624:2661,2692:2715,3079:3216,3264:3288,3611:3622,3652:3673,3702:3717,3815:3879,3935:3976,4109:4163,4257:4401,4434:4537,4635:4660,4748:4772,4787:4792,5872:5899,6380:6413,6567:6583,6648:6679,6707:6732,6780:6824,7554:7687,7718:7745,7754:7767,8038:8051,8069:8087,9670:9682,9922:9938,9962:9975,10354:10367,10393:10404,10497:10510,10654:10667,10695:10732,10920:10941,10966:10991,11512:11560,11617:11628,11636:11658,11795:11818,12535:12571,13034:13053,13209:13222,13282:13291,13363:13372,13537:13654,13668:13703,13724:13733,13760:13806,13834:13917,13993:14101,14112:14207,14225:14249,14256:14324,14347:14352,14429:14452,14537:14549,14674:14692,14770:14809,14827:14865,14902:14952,14992:15006,15101:15135,15143:15171,15173:15201,15314:15350,15401:15422,15435:15456,15497:15521,15564:15607,15637:15671,16104:16111,16210:16214,16246:16287,16420:16430,16441:16452,16611:16660,16688:16716,16775:17038,17076:17100,17142:17238,17287:17309,17344:17367,17455:17522,17981:18028,18081:18122,18255:18291,18407:18416,18428:18434,18467:18491,18499:18513,18751:18755,18826:18895,18911:18974,19277:19314,20246:20270,20667:20681,20697:20736,20759:20763,20774:20839,21506:21576,21590:21647 )' = c(30 , 59.999),   # DTL_awc::awc.sol | change = pctchg    
  'DTL_per::perco.hru | change = absval | unit =   c(  7:42,336:363,383:431,467:492,607:614,777:857,888:944,983:1051,1100:1119,1137:1180,1715:1744,1877:1904,2385:2412,2443:2552,2624:2661,2692:2715,3079:3216,3264:3288,3611:3622,3652:3673,3702:3717,3815:3879,3935:3976,4109:4163,4257:4401,4434:4537,4635:4660,4748:4772,4787:4792,5872:5899,6380:6413,6567:6583,6648:6679,6707:6732,6780:6824,7554:7687,7718:7745,7754:7767,8038:8051,8069:8087,9670:9682,9922:9938,9962:9975,10354:10367,10393:10404,10497:10510,10654:10667,10695:10732,10920:10941,10966:10991,11512:11560,11617:11628,11636:11658,11795:11818,12535:12571,13034:13053,13209:13222,13282:13291,13363:13372,13537:13654,13668:13703,13724:13733,13760:13806,13834:13917,13993:14101,14112:14207,14225:14249,14256:14324,14347:14352,14429:14452,14537:14549,14674:14692,14770:14809,14827:14865,14902:14952,14992:15006,15101:15135,15143:15171,15173:15201,15314:15350,15401:15422,15435:15456,15497:15521,15564:15607,15637:15671,16104:16111,16210:16214,16246:16287,16420:16430,16441:16452,16611:16660,16688:16716,16775:17038,17076:17100,17142:17238,17287:17309,17344:17367,17455:17522,17981:18028,18081:18122,18255:18291,18407:18416,18428:18434,18467:18491,18499:18513,18751:18755,18826:18895,18911:18974,19277:19314,20246:20270,20667:20681,20697:20736,20759:20763,20774:20839,21506:21576,21590:21647 )' = c(0.3 , 0.6),        # DTL_per::perco.hru | change = absval
  'DTL_latq::latq_co.hru | change = abschg | unit =   c(  7:42,336:363,383:431,467:492,607:614,777:857,888:944,983:1051,1100:1119,1137:1180,1715:1744,1877:1904,2385:2412,2443:2552,2624:2661,2692:2715,3079:3216,3264:3288,3611:3622,3652:3673,3702:3717,3815:3879,3935:3976,4109:4163,4257:4401,4434:4537,4635:4660,4748:4772,4787:4792,5872:5899,6380:6413,6567:6583,6648:6679,6707:6732,6780:6824,7554:7687,7718:7745,7754:7767,8038:8051,8069:8087,9670:9682,9922:9938,9962:9975,10354:10367,10393:10404,10497:10510,10654:10667,10695:10732,10920:10941,10966:10991,11512:11560,11617:11628,11636:11658,11795:11818,12535:12571,13034:13053,13209:13222,13282:13291,13363:13372,13537:13654,13668:13703,13724:13733,13760:13806,13834:13917,13993:14101,14112:14207,14225:14249,14256:14324,14347:14352,14429:14452,14537:14549,14674:14692,14770:14809,14827:14865,14902:14952,14992:15006,15101:15135,15143:15171,15173:15201,15314:15350,15401:15422,15435:15456,15497:15521,15564:15607,15637:15671,16104:16111,16210:16214,16246:16287,16420:16430,16441:16452,16611:16660,16688:16716,16775:17038,17076:17100,17142:17238,17287:17309,17344:17367,17455:17522,17981:18028,18081:18122,18255:18291,18407:18416,18428:18434,18467:18491,18499:18513,18751:18755,18826:18895,18911:18974,19277:19314,20246:20270,20667:20681,20697:20736,20759:20763,20774:20839,21506:21576,21590:21647 )' = c(-0.5, 0),       # DTL_latq::latq_co.hru | change = abschg    
  'DTL_cn3::cn3_swf.hru | change = abschg | unit = c(  7:42,336:363,383:431,467:492,607:614,777:857,888:944,983:1051,1100:1119,1137:1180,1715:1744,1877:1904,2385:2412,2443:2552,2624:2661,2692:2715,3079:3216,3264:3288,3611:3622,3652:3673,3702:3717,3815:3879,3935:3976,4109:4163,4257:4401,4434:4537,4635:4660,4748:4772,4787:4792,5872:5899,6380:6413,6567:6583,6648:6679,6707:6732,6780:6824,7554:7687,7718:7745,7754:7767,8038:8051,8069:8087,9670:9682,9922:9938,9962:9975,10354:10367,10393:10404,10497:10510,10654:10667,10695:10732,10920:10941,10966:10991,11512:11560,11617:11628,11636:11658,11795:11818,12535:12571,13034:13053,13209:13222,13282:13291,13363:13372,13537:13654,13668:13703,13724:13733,13760:13806,13834:13917,13993:14101,14112:14207,14225:14249,14256:14324,14347:14352,14429:14452,14537:14549,14674:14692,14770:14809,14827:14865,14902:14952,14992:15006,15101:15135,15143:15171,15173:15201,15314:15350,15401:15422,15435:15456,15497:15521,15564:15607,15637:15671,16104:16111,16210:16214,16246:16287,16420:16430,16441:16452,16611:16660,16688:16716,16775:17038,17076:17100,17142:17238,17287:17309,17344:17367,17455:17522,17981:18028,18081:18122,18255:18291,18407:18416,18428:18434,18467:18491,18499:18513,18751:18755,18826:18895,18911:18974,19277:19314,20246:20270,20667:20681,20697:20736,20759:20763,20774:20839,21506:21576,21590:21647 )' = c(-0.25, 0.5),          # DTL_cn3::cn3_swf.hru | change = abschg        
  'DTL_zso::z.sol | change = pctchg | unit =       c(  7:42,336:363,383:431,467:492,607:614,777:857,888:944,983:1051,1100:1119,1137:1180,1715:1744,1877:1904,2385:2412,2443:2552,2624:2661,2692:2715,3079:3216,3264:3288,3611:3622,3652:3673,3702:3717,3815:3879,3935:3976,4109:4163,4257:4401,4434:4537,4635:4660,4748:4772,4787:4792,5872:5899,6380:6413,6567:6583,6648:6679,6707:6732,6780:6824,7554:7687,7718:7745,7754:7767,8038:8051,8069:8087,9670:9682,9922:9938,9962:9975,10354:10367,10393:10404,10497:10510,10654:10667,10695:10732,10920:10941,10966:10991,11512:11560,11617:11628,11636:11658,11795:11818,12535:12571,13034:13053,13209:13222,13282:13291,13363:13372,13537:13654,13668:13703,13724:13733,13760:13806,13834:13917,13993:14101,14112:14207,14225:14249,14256:14324,14347:14352,14429:14452,14537:14549,14674:14692,14770:14809,14827:14865,14902:14952,14992:15006,15101:15135,15143:15171,15173:15201,15314:15350,15401:15422,15435:15456,15497:15521,15564:15607,15637:15671,16104:16111,16210:16214,16246:16287,16420:16430,16441:16452,16611:16660,16688:16716,16775:17038,17076:17100,17142:17238,17287:17309,17344:17367,17455:17522,17981:18028,18081:18122,18255:18291,18407:18416,18428:18434,18467:18491,18499:18513,18751:18755,18826:18895,18911:18974,19277:19314,20246:20270,20667:20681,20697:20736,20759:20763,20774:20839,21506:21576,21590:21647 )' = c(12.5 , 49.999),   # DTL_zso::z.sol | change = pctchg 
  'DTL_kso::k.sol | change = pctchg | unit =       c(  7:42,336:363,383:431,467:492,607:614,777:857,888:944,983:1051,1100:1119,1137:1180,1715:1744,1877:1904,2385:2412,2443:2552,2624:2661,2692:2715,3079:3216,3264:3288,3611:3622,3652:3673,3702:3717,3815:3879,3935:3976,4109:4163,4257:4401,4434:4537,4635:4660,4748:4772,4787:4792,5872:5899,6380:6413,6567:6583,6648:6679,6707:6732,6780:6824,7554:7687,7718:7745,7754:7767,8038:8051,8069:8087,9670:9682,9922:9938,9962:9975,10354:10367,10393:10404,10497:10510,10654:10667,10695:10732,10920:10941,10966:10991,11512:11560,11617:11628,11636:11658,11795:11818,12535:12571,13034:13053,13209:13222,13282:13291,13363:13372,13537:13654,13668:13703,13724:13733,13760:13806,13834:13917,13993:14101,14112:14207,14225:14249,14256:14324,14347:14352,14429:14452,14537:14549,14674:14692,14770:14809,14827:14865,14902:14952,14992:15006,15101:15135,15143:15171,15173:15201,15314:15350,15401:15422,15435:15456,15497:15521,15564:15607,15637:15671,16104:16111,16210:16214,16246:16287,16420:16430,16441:16452,16611:16660,16688:16716,16775:17038,17076:17100,17142:17238,17287:17309,17344:17367,17455:17522,17981:18028,18081:18122,18255:18291,18407:18416,18428:18434,18467:18491,18499:18513,18751:18755,18826:18895,18911:18974,19277:19314,20246:20270,20667:20681,20697:20736,20759:20763,20774:20839,21506:21576,21590:21647 )' = c(-79.999 , 50),  # DTL_kso::k.sol | change = pctchg 
  'DTL_bd::bd.sol | change = pctchg | unit =       c(  7:42,336:363,383:431,467:492,607:614,777:857,888:944,983:1051,1100:1119,1137:1180,1715:1744,1877:1904,2385:2412,2443:2552,2624:2661,2692:2715,3079:3216,3264:3288,3611:3622,3652:3673,3702:3717,3815:3879,3935:3976,4109:4163,4257:4401,4434:4537,4635:4660,4748:4772,4787:4792,5872:5899,6380:6413,6567:6583,6648:6679,6707:6732,6780:6824,7554:7687,7718:7745,7754:7767,8038:8051,8069:8087,9670:9682,9922:9938,9962:9975,10354:10367,10393:10404,10497:10510,10654:10667,10695:10732,10920:10941,10966:10991,11512:11560,11617:11628,11636:11658,11795:11818,12535:12571,13034:13053,13209:13222,13282:13291,13363:13372,13537:13654,13668:13703,13724:13733,13760:13806,13834:13917,13993:14101,14112:14207,14225:14249,14256:14324,14347:14352,14429:14452,14537:14549,14674:14692,14770:14809,14827:14865,14902:14952,14992:15006,15101:15135,15143:15171,15173:15201,15314:15350,15401:15422,15435:15456,15497:15521,15564:15607,15637:15671,16104:16111,16210:16214,16246:16287,16420:16430,16441:16452,16611:16660,16688:16716,16775:17038,17076:17100,17142:17238,17287:17309,17344:17367,17455:17522,17981:18028,18081:18122,18255:18291,18407:18416,18428:18434,18467:18491,18499:18513,18751:18755,18826:18895,18911:18974,19277:19314,20246:20270,20667:20681,20697:20736,20759:20763,20774:20839,21506:21576,21590:21647 )' = c(-20 , 5))   # DTL_bd::bd.sol | change = pctchg 


#### 2.2. Creating parameters sets for SENSITIVITY ANALYSIS and RUNNING SA SIMULATIONS####


# Loading required R packages 
library(SWATplusR)
library(dplyr)
library(tibble)
library(purrr)
library(sensitivity)

# Function definitions 
## Set sampled parameter ranges to parameter boundaries
set_par_range <- function(par_tbl, range_tbl) {
  map2_df(par_tbl, range_tbl, ~ (.x * (.y[2] - .y[1]) + .y[1]))
}

# Paths 
# SWAT+ project path
tagus_path  <- './TxtInOut_TAGUS23/'

# Save path for Sobol parameter set
sample_path <- './230414_sobol_sample.rds'

# Sobol sample definition 
# Labels of the different spatial zones, used for splitting parameter table
# into list for the different zones
zones <- c('IMP', 'CRB', 'DTH', 'DTL')

# Sobol base sample size
ns <- 1000

# Analyzed SWAT+ model parameters
par_names <- c('esco', 'epco', 'cn2', 'awc', 'perco', 'latq_co', 'cn3_swf', 'z', 'k', 'bd')

# Number of parameters
np <- length(par_names)

# Drawing the base Sobol parameter sample
X1 <- data.frame(matrix(runif(np * ns), nrow = ns)) %>% set_names(par_names)
X2 <- data.frame(matrix(runif(np * ns), nrow = ns)) %>% set_names(par_names)

sobol_sample <- sobolSalt(model = NULL, X1, X2, scheme="A", nboot = 100)

# Parameters ranges for the different spatial zones
par_bound_zonal <- tibble(
  'IMP_esc::esco.hru | change = absval | unit =    c(53:67,97:229,432:466,493:537,600:606,626:676,697:716,757:770,1277:1414,1421:1428,1446:1454,1459:1478,1529:1532,1789:1876,2059:2339,2347:2352,2361:2384,3299:3459,5420:5443,5900:5950,5963:5976,5991:6086,7311:7366,7375:7449,7458:7530,8425:8494,8507:8533,8537:8557,9233:9368,9687:9817,10017:10147,11027:11069,11085:11100,11115:11122,11135:11141,11338:11483,11847:12117,12275:12446,13061:13125,13154:13188,15748:15772,15795:15818,15835:15847,15877:15913,15962:15972,16484:16514,17368:17399,17523:17629,17693:17721,18613:18639,19239:19254,19574:19588,19593:19638,19794:19853,19876:19918,19975:20043,20073:20191,20344:20666,20850:21100,21168:21202,21313:21322,21338:21353,21390:21441,21462:21479,21925:21955,21989:22001,22006:22044,22069:22089)' = c(0.001 , 0.999),       # 'IMP_esc::esco.hru | change = absval
  'IMP_epc::epco.hru | change = absval | unit =    c(53:67,97:229,432:466,493:537,600:606,626:676,697:716,757:770,1277:1414,1421:1428,1446:1454,1459:1478,1529:1532,1789:1876,2059:2339,2347:2352,2361:2384,3299:3459,5420:5443,5900:5950,5963:5976,5991:6086,7311:7366,7375:7449,7458:7530,8425:8494,8507:8533,8537:8557,9233:9368,9687:9817,10017:10147,11027:11069,11085:11100,11115:11122,11135:11141,11338:11483,11847:12117,12275:12446,13061:13125,13154:13188,15748:15772,15795:15818,15835:15847,15877:15913,15962:15972,16484:16514,17368:17399,17523:17629,17693:17721,18613:18639,19239:19254,19574:19588,19593:19638,19794:19853,19876:19918,19975:20043,20073:20191,20344:20666,20850:21100,21168:21202,21313:21322,21338:21353,21390:21441,21462:21479,21925:21955,21989:22001,22006:22044,22069:22089)' = c(0.001 , 0.999),       # 'IMP_epc::epco.hru | change = absval
  'IMP_cnn::cn2.hru | change = pctchg | unit =     c(53:67,97:229,432:466,493:537,600:606,626:676,697:716,757:770,1277:1414,1421:1428,1446:1454,1459:1478,1529:1532,1789:1876,2059:2339,2347:2352,2361:2384,3299:3459,5420:5443,5900:5950,5963:5976,5991:6086,7311:7366,7375:7449,7458:7530,8425:8494,8507:8533,8537:8557,9233:9368,9687:9817,10017:10147,11027:11069,11085:11100,11115:11122,11135:11141,11338:11483,11847:12117,12275:12446,13061:13125,13154:13188,15748:15772,15795:15818,15835:15847,15877:15913,15962:15972,16484:16514,17368:17399,17523:17629,17693:17721,18613:18639,19239:19254,19574:19588,19593:19638,19794:19853,19876:19918,19975:20043,20073:20191,20344:20666,20850:21100,21168:21202,21313:21322,21338:21353,21390:21441,21462:21479,21925:21955,21989:22001,22006:22044,22069:22089)' = c(-29.999  ,  29.999),  # 'IMP_cnn::cn2.hru | change = pctchg
  'IMP_awc::awc.sol | change = pctchg | unit =     c(53:67,97:229,432:466,493:537,600:606,626:676,697:716,757:770,1277:1414,1421:1428,1446:1454,1459:1478,1529:1532,1789:1876,2059:2339,2347:2352,2361:2384,3299:3459,5420:5443,5900:5950,5963:5976,5991:6086,7311:7366,7375:7449,7458:7530,8425:8494,8507:8533,8537:8557,9233:9368,9687:9817,10017:10147,11027:11069,11085:11100,11115:11122,11135:11141,11338:11483,11847:12117,12275:12446,13061:13125,13154:13188,15748:15772,15795:15818,15835:15847,15877:15913,15962:15972,16484:16514,17368:17399,17523:17629,17693:17721,18613:18639,19239:19254,19574:19588,19593:19638,19794:19853,19876:19918,19975:20043,20073:20191,20344:20666,20850:21100,21168:21202,21313:21322,21338:21353,21390:21441,21462:21479,21925:21955,21989:22001,22006:22044,22069:22089)' = c(-59.999 , 59.999),    # 'IMP_awc::awc.sol | change = pctchg
  'IMP_per::perco.hru | change = absval | unit =   c(53:67,97:229,432:466,493:537,600:606,626:676,697:716,757:770,1277:1414,1421:1428,1446:1454,1459:1478,1529:1532,1789:1876,2059:2339,2347:2352,2361:2384,3299:3459,5420:5443,5900:5950,5963:5976,5991:6086,7311:7366,7375:7449,7458:7530,8425:8494,8507:8533,8537:8557,9233:9368,9687:9817,10017:10147,11027:11069,11085:11100,11115:11122,11135:11141,11338:11483,11847:12117,12275:12446,13061:13125,13154:13188,15748:15772,15795:15818,15835:15847,15877:15913,15962:15972,16484:16514,17368:17399,17523:17629,17693:17721,18613:18639,19239:19254,19574:19588,19593:19638,19794:19853,19876:19918,19975:20043,20073:20191,20344:20666,20850:21100,21168:21202,21313:21322,21338:21353,21390:21441,21462:21479,21925:21955,21989:22001,22006:22044,22069:22089)' = c(0.001 , 0.4),         # 'IMP_per::perco.hru | change = absval
  'IMP_latq::latq_co.hru | change = abschg | unit =   c(53:67,97:229,432:466,493:537,600:606,626:676,697:716,757:770,1277:1414,1421:1428,1446:1454,1459:1478,1529:1532,1789:1876,2059:2339,2347:2352,2361:2384,3299:3459,5420:5443,5900:5950,5963:5976,5991:6086,7311:7366,7375:7449,7458:7530,8425:8494,8507:8533,8537:8557,9233:9368,9687:9817,10017:10147,11027:11069,11085:11100,11115:11122,11135:11141,11338:11483,11847:12117,12275:12446,13061:13125,13154:13188,15748:15772,15795:15818,15835:15847,15877:15913,15962:15972,16484:16514,17368:17399,17523:17629,17693:17721,18613:18639,19239:19254,19574:19588,19593:19638,19794:19853,19876:19918,19975:20043,20073:20191,20344:20666,20850:21100,21168:21202,21313:21322,21338:21353,21390:21441,21462:21479,21925:21955,21989:22001,22006:22044,22069:22089)' = c(-0.5, 0.5),        # 'IMP_latq::latq_co.hru | change = abschg
  'IMP_cn3::cn3_swf.hru | change = abschg | unit = c(53:67,97:229,432:466,493:537,600:606,626:676,697:716,757:770,1277:1414,1421:1428,1446:1454,1459:1478,1529:1532,1789:1876,2059:2339,2347:2352,2361:2384,3299:3459,5420:5443,5900:5950,5963:5976,5991:6086,7311:7366,7375:7449,7458:7530,8425:8494,8507:8533,8537:8557,9233:9368,9687:9817,10017:10147,11027:11069,11085:11100,11115:11122,11135:11141,11338:11483,11847:12117,12275:12446,13061:13125,13154:13188,15748:15772,15795:15818,15835:15847,15877:15913,15962:15972,16484:16514,17368:17399,17523:17629,17693:17721,18613:18639,19239:19254,19574:19588,19593:19638,19794:19853,19876:19918,19975:20043,20073:20191,20344:20666,20850:21100,21168:21202,21313:21322,21338:21353,21390:21441,21462:21479,21925:21955,21989:22001,22006:22044,22069:22089)' = c(-0.5, 0.5),           # 'IMP_cn3::cn3_swf.hru | change = abschg
  'IMP_zso::z.sol | change = pctchg | unit =       c(53:67,97:229,432:466,493:537,600:606,626:676,697:716,757:770,1277:1414,1421:1428,1446:1454,1459:1478,1529:1532,1789:1876,2059:2339,2347:2352,2361:2384,3299:3459,5420:5443,5900:5950,5963:5976,5991:6086,7311:7366,7375:7449,7458:7530,8425:8494,8507:8533,8537:8557,9233:9368,9687:9817,10017:10147,11027:11069,11085:11100,11115:11122,11135:11141,11338:11483,11847:12117,12275:12446,13061:13125,13154:13188,15748:15772,15795:15818,15835:15847,15877:15913,15962:15972,16484:16514,17368:17399,17523:17629,17693:17721,18613:18639,19239:19254,19574:19588,19593:19638,19794:19853,19876:19918,19975:20043,20073:20191,20344:20666,20850:21100,21168:21202,21313:21322,21338:21353,21390:21441,21462:21479,21925:21955,21989:22001,22006:22044,22069:22089)' = c(-49.999 , 49.999),    # 'IMP_zso::z.sol | change = pctchg
  'IMP_kso::k.sol | change = pctchg | unit =       c(53:67,97:229,432:466,493:537,600:606,626:676,697:716,757:770,1277:1414,1421:1428,1446:1454,1459:1478,1529:1532,1789:1876,2059:2339,2347:2352,2361:2384,3299:3459,5420:5443,5900:5950,5963:5976,5991:6086,7311:7366,7375:7449,7458:7530,8425:8494,8507:8533,8537:8557,9233:9368,9687:9817,10017:10147,11027:11069,11085:11100,11115:11122,11135:11141,11338:11483,11847:12117,12275:12446,13061:13125,13154:13188,15748:15772,15795:15818,15835:15847,15877:15913,15962:15972,16484:16514,17368:17399,17523:17629,17693:17721,18613:18639,19239:19254,19574:19588,19593:19638,19794:19853,19876:19918,19975:20043,20073:20191,20344:20666,20850:21100,21168:21202,21313:21322,21338:21353,21390:21441,21462:21479,21925:21955,21989:22001,22006:22044,22069:22089)' = c(-79.999 , 199.999),   # 'IMP_kso::k.sol | change = pctchg
  'IMP_bd::bd.sol | change = pctchg | unit =       c(53:67,97:229,432:466,493:537,600:606,626:676,697:716,757:770,1277:1414,1421:1428,1446:1454,1459:1478,1529:1532,1789:1876,2059:2339,2347:2352,2361:2384,3299:3459,5420:5443,5900:5950,5963:5976,5991:6086,7311:7366,7375:7449,7458:7530,8425:8494,8507:8533,8537:8557,9233:9368,9687:9817,10017:10147,11027:11069,11085:11100,11115:11122,11135:11141,11338:11483,11847:12117,12275:12446,13061:13125,13154:13188,15748:15772,15795:15818,15835:15847,15877:15913,15962:15972,16484:16514,17368:17399,17523:17629,17693:17721,18613:18639,19239:19254,19574:19588,19593:19638,19794:19853,19876:19918,19975:20043,20073:20191,20344:20666,20850:21100,21168:21202,21313:21322,21338:21353,21390:21441,21462:21479,21925:21955,21989:22001,22006:22044,22069:22089)' = c(-29.999 , 29.999),    # 'IMP_bd::bd.sol | change = pctchg
  
  
  'CRB_esc::esco.hru | change = absval | unit =    c(1:6,43:52,68:96,364:382,615:625,771:776,858:887,1052:1059,1092:1099,1120:1136,1181:1199,1217:1276,1429:1445,1653:1714,1745:1749,1905:2007,2042:2058,2413:2442,2553:2623,2662:2691,2716:2900,2917:2936,2970:2999,3019:3054,3077:3078,3217:3263,3880:3934,3977:4080,4164:4256,4402:4433,4538:4634,4662:4747,4773:4786,4793:4832,5795:5845,6164:6238,6441:6453,6460:6504,6531:6566,6584:6647,6680:6706,6733:6779,6846:6895,6916:6976,6998:7008,7035:7039,7133:7136,7190:7310,7854:7862,8118:8192,8248:8258,8273:8424,8683:8713,8730:8777,9058:9232,9369:9461,9469:9488,9493:9504,9509:9539,9556:9603,10193:10275,10302:10314,10328:10353,10368:10392,10405:10496,10511:10653,10733:10765,10873:10899,10992:11026,11305:11337,11697:11721,11819:11846,12118:12122,12197:12210,12263:12274,12481:12483,12504:12510,13189:13208,13223:13237,13494:13501,13655:13667,13971:13985,14329:14346,14709:14722,14743:14769,14810:14826,14888:14901,14953:14991,15007:15059,15136:15142,15202:15220,17246:17279,17310:17343,17437:17454,18123:18142,18218:18233,18514:18535,18896:18910,19255:19276,19395:19405,20218:20245,20749:20758,20840:20849,21209:21213,21226:21235)' = c(0.001 , 0.999),        # CRB_esc::esco.hru | change = absval
  'CRB_epc::epco.hru | change = absval | unit =    c(1:6,43:52,68:96,364:382,615:625,771:776,858:887,1052:1059,1092:1099,1120:1136,1181:1199,1217:1276,1429:1445,1653:1714,1745:1749,1905:2007,2042:2058,2413:2442,2553:2623,2662:2691,2716:2900,2917:2936,2970:2999,3019:3054,3077:3078,3217:3263,3880:3934,3977:4080,4164:4256,4402:4433,4538:4634,4662:4747,4773:4786,4793:4832,5795:5845,6164:6238,6441:6453,6460:6504,6531:6566,6584:6647,6680:6706,6733:6779,6846:6895,6916:6976,6998:7008,7035:7039,7133:7136,7190:7310,7854:7862,8118:8192,8248:8258,8273:8424,8683:8713,8730:8777,9058:9232,9369:9461,9469:9488,9493:9504,9509:9539,9556:9603,10193:10275,10302:10314,10328:10353,10368:10392,10405:10496,10511:10653,10733:10765,10873:10899,10992:11026,11305:11337,11697:11721,11819:11846,12118:12122,12197:12210,12263:12274,12481:12483,12504:12510,13189:13208,13223:13237,13494:13501,13655:13667,13971:13985,14329:14346,14709:14722,14743:14769,14810:14826,14888:14901,14953:14991,15007:15059,15136:15142,15202:15220,17246:17279,17310:17343,17437:17454,18123:18142,18218:18233,18514:18535,18896:18910,19255:19276,19395:19405,20218:20245,20749:20758,20840:20849,21209:21213,21226:21235)' = c(0.001 , 0.999),        # CRB_epc::epco.hru | change = absval
  'CRB_cnn::cn2.hru | change = pctchg | unit =     c(1:6,43:52,68:96,364:382,615:625,771:776,858:887,1052:1059,1092:1099,1120:1136,1181:1199,1217:1276,1429:1445,1653:1714,1745:1749,1905:2007,2042:2058,2413:2442,2553:2623,2662:2691,2716:2900,2917:2936,2970:2999,3019:3054,3077:3078,3217:3263,3880:3934,3977:4080,4164:4256,4402:4433,4538:4634,4662:4747,4773:4786,4793:4832,5795:5845,6164:6238,6441:6453,6460:6504,6531:6566,6584:6647,6680:6706,6733:6779,6846:6895,6916:6976,6998:7008,7035:7039,7133:7136,7190:7310,7854:7862,8118:8192,8248:8258,8273:8424,8683:8713,8730:8777,9058:9232,9369:9461,9469:9488,9493:9504,9509:9539,9556:9603,10193:10275,10302:10314,10328:10353,10368:10392,10405:10496,10511:10653,10733:10765,10873:10899,10992:11026,11305:11337,11697:11721,11819:11846,12118:12122,12197:12210,12263:12274,12481:12483,12504:12510,13189:13208,13223:13237,13494:13501,13655:13667,13971:13985,14329:14346,14709:14722,14743:14769,14810:14826,14888:14901,14953:14991,15007:15059,15136:15142,15202:15220,17246:17279,17310:17343,17437:17454,18123:18142,18218:18233,18514:18535,18896:18910,19255:19276,19395:19405,20218:20245,20749:20758,20840:20849,21209:21213,21226:21235)' = c(-29.999  ,  29.999),   # CRB_cnn::cn2.hru | change = pctchg
  'CRB_awc::awc.sol | change = pctchg | unit =     c(1:6,43:52,68:96,364:382,615:625,771:776,858:887,1052:1059,1092:1099,1120:1136,1181:1199,1217:1276,1429:1445,1653:1714,1745:1749,1905:2007,2042:2058,2413:2442,2553:2623,2662:2691,2716:2900,2917:2936,2970:2999,3019:3054,3077:3078,3217:3263,3880:3934,3977:4080,4164:4256,4402:4433,4538:4634,4662:4747,4773:4786,4793:4832,5795:5845,6164:6238,6441:6453,6460:6504,6531:6566,6584:6647,6680:6706,6733:6779,6846:6895,6916:6976,6998:7008,7035:7039,7133:7136,7190:7310,7854:7862,8118:8192,8248:8258,8273:8424,8683:8713,8730:8777,9058:9232,9369:9461,9469:9488,9493:9504,9509:9539,9556:9603,10193:10275,10302:10314,10328:10353,10368:10392,10405:10496,10511:10653,10733:10765,10873:10899,10992:11026,11305:11337,11697:11721,11819:11846,12118:12122,12197:12210,12263:12274,12481:12483,12504:12510,13189:13208,13223:13237,13494:13501,13655:13667,13971:13985,14329:14346,14709:14722,14743:14769,14810:14826,14888:14901,14953:14991,15007:15059,15136:15142,15202:15220,17246:17279,17310:17343,17437:17454,18123:18142,18218:18233,18514:18535,18896:18910,19255:19276,19395:19405,20218:20245,20749:20758,20840:20849,21209:21213,21226:21235)' = c(-59.999 , 59.999),     # CRB_awc::awc.sol | change = pctchg
  'CRB_per::perco.hru | change = absval | unit =   c(1:6,43:52,68:96,364:382,615:625,771:776,858:887,1052:1059,1092:1099,1120:1136,1181:1199,1217:1276,1429:1445,1653:1714,1745:1749,1905:2007,2042:2058,2413:2442,2553:2623,2662:2691,2716:2900,2917:2936,2970:2999,3019:3054,3077:3078,3217:3263,3880:3934,3977:4080,4164:4256,4402:4433,4538:4634,4662:4747,4773:4786,4793:4832,5795:5845,6164:6238,6441:6453,6460:6504,6531:6566,6584:6647,6680:6706,6733:6779,6846:6895,6916:6976,6998:7008,7035:7039,7133:7136,7190:7310,7854:7862,8118:8192,8248:8258,8273:8424,8683:8713,8730:8777,9058:9232,9369:9461,9469:9488,9493:9504,9509:9539,9556:9603,10193:10275,10302:10314,10328:10353,10368:10392,10405:10496,10511:10653,10733:10765,10873:10899,10992:11026,11305:11337,11697:11721,11819:11846,12118:12122,12197:12210,12263:12274,12481:12483,12504:12510,13189:13208,13223:13237,13494:13501,13655:13667,13971:13985,14329:14346,14709:14722,14743:14769,14810:14826,14888:14901,14953:14991,15007:15059,15136:15142,15202:15220,17246:17279,17310:17343,17437:17454,18123:18142,18218:18233,18514:18535,18896:18910,19255:19276,19395:19405,20218:20245,20749:20758,20840:20849,21209:21213,21226:21235)' = c(0.2 , 0.999),          # CRB_per::perco.hru | change = absval
  'CRB_latq::latq_co.hru | change = abschg | unit =   c(1:6,43:52,68:96,364:382,615:625,771:776,858:887,1052:1059,1092:1099,1120:1136,1181:1199,1217:1276,1429:1445,1653:1714,1745:1749,1905:2007,2042:2058,2413:2442,2553:2623,2662:2691,2716:2900,2917:2936,2970:2999,3019:3054,3077:3078,3217:3263,3880:3934,3977:4080,4164:4256,4402:4433,4538:4634,4662:4747,4773:4786,4793:4832,5795:5845,6164:6238,6441:6453,6460:6504,6531:6566,6584:6647,6680:6706,6733:6779,6846:6895,6916:6976,6998:7008,7035:7039,7133:7136,7190:7310,7854:7862,8118:8192,8248:8258,8273:8424,8683:8713,8730:8777,9058:9232,9369:9461,9469:9488,9493:9504,9509:9539,9556:9603,10193:10275,10302:10314,10328:10353,10368:10392,10405:10496,10511:10653,10733:10765,10873:10899,10992:11026,11305:11337,11697:11721,11819:11846,12118:12122,12197:12210,12263:12274,12481:12483,12504:12510,13189:13208,13223:13237,13494:13501,13655:13667,13971:13985,14329:14346,14709:14722,14743:14769,14810:14826,14888:14901,14953:14991,15007:15059,15136:15142,15202:15220,17246:17279,17310:17343,17437:17454,18123:18142,18218:18233,18514:18535,18896:18910,19255:19276,19395:19405,20218:20245,20749:20758,20840:20849,21209:21213,21226:21235)' = c(-0.5, 0.5),         # CRB_latq::latq_co.hru | change = abschg
  'CRB_cn3::cn3_swf.hru | change = abschg | unit = c(1:6,43:52,68:96,364:382,615:625,771:776,858:887,1052:1059,1092:1099,1120:1136,1181:1199,1217:1276,1429:1445,1653:1714,1745:1749,1905:2007,2042:2058,2413:2442,2553:2623,2662:2691,2716:2900,2917:2936,2970:2999,3019:3054,3077:3078,3217:3263,3880:3934,3977:4080,4164:4256,4402:4433,4538:4634,4662:4747,4773:4786,4793:4832,5795:5845,6164:6238,6441:6453,6460:6504,6531:6566,6584:6647,6680:6706,6733:6779,6846:6895,6916:6976,6998:7008,7035:7039,7133:7136,7190:7310,7854:7862,8118:8192,8248:8258,8273:8424,8683:8713,8730:8777,9058:9232,9369:9461,9469:9488,9493:9504,9509:9539,9556:9603,10193:10275,10302:10314,10328:10353,10368:10392,10405:10496,10511:10653,10733:10765,10873:10899,10992:11026,11305:11337,11697:11721,11819:11846,12118:12122,12197:12210,12263:12274,12481:12483,12504:12510,13189:13208,13223:13237,13494:13501,13655:13667,13971:13985,14329:14346,14709:14722,14743:14769,14810:14826,14888:14901,14953:14991,15007:15059,15136:15142,15202:15220,17246:17279,17310:17343,17437:17454,18123:18142,18218:18233,18514:18535,18896:18910,19255:19276,19395:19405,20218:20245,20749:20758,20840:20849,21209:21213,21226:21235)' = c(-0.5, 0.5),            # CRB_cn3::cn3_swf.hru | change = abschg
  'CRB_zso::z.sol | change = pctchg | unit =       c(1:6,43:52,68:96,364:382,615:625,771:776,858:887,1052:1059,1092:1099,1120:1136,1181:1199,1217:1276,1429:1445,1653:1714,1745:1749,1905:2007,2042:2058,2413:2442,2553:2623,2662:2691,2716:2900,2917:2936,2970:2999,3019:3054,3077:3078,3217:3263,3880:3934,3977:4080,4164:4256,4402:4433,4538:4634,4662:4747,4773:4786,4793:4832,5795:5845,6164:6238,6441:6453,6460:6504,6531:6566,6584:6647,6680:6706,6733:6779,6846:6895,6916:6976,6998:7008,7035:7039,7133:7136,7190:7310,7854:7862,8118:8192,8248:8258,8273:8424,8683:8713,8730:8777,9058:9232,9369:9461,9469:9488,9493:9504,9509:9539,9556:9603,10193:10275,10302:10314,10328:10353,10368:10392,10405:10496,10511:10653,10733:10765,10873:10899,10992:11026,11305:11337,11697:11721,11819:11846,12118:12122,12197:12210,12263:12274,12481:12483,12504:12510,13189:13208,13223:13237,13494:13501,13655:13667,13971:13985,14329:14346,14709:14722,14743:14769,14810:14826,14888:14901,14953:14991,15007:15059,15136:15142,15202:15220,17246:17279,17310:17343,17437:17454,18123:18142,18218:18233,18514:18535,18896:18910,19255:19276,19395:19405,20218:20245,20749:20758,20840:20849,21209:21213,21226:21235)' = c(-49.999 , 49.999),     # CRB_zso::z.sol | change = pctchg
  'CRB_kso::k.sol | change = pctchg | unit =       c(1:6,43:52,68:96,364:382,615:625,771:776,858:887,1052:1059,1092:1099,1120:1136,1181:1199,1217:1276,1429:1445,1653:1714,1745:1749,1905:2007,2042:2058,2413:2442,2553:2623,2662:2691,2716:2900,2917:2936,2970:2999,3019:3054,3077:3078,3217:3263,3880:3934,3977:4080,4164:4256,4402:4433,4538:4634,4662:4747,4773:4786,4793:4832,5795:5845,6164:6238,6441:6453,6460:6504,6531:6566,6584:6647,6680:6706,6733:6779,6846:6895,6916:6976,6998:7008,7035:7039,7133:7136,7190:7310,7854:7862,8118:8192,8248:8258,8273:8424,8683:8713,8730:8777,9058:9232,9369:9461,9469:9488,9493:9504,9509:9539,9556:9603,10193:10275,10302:10314,10328:10353,10368:10392,10405:10496,10511:10653,10733:10765,10873:10899,10992:11026,11305:11337,11697:11721,11819:11846,12118:12122,12197:12210,12263:12274,12481:12483,12504:12510,13189:13208,13223:13237,13494:13501,13655:13667,13971:13985,14329:14346,14709:14722,14743:14769,14810:14826,14888:14901,14953:14991,15007:15059,15136:15142,15202:15220,17246:17279,17310:17343,17437:17454,18123:18142,18218:18233,18514:18535,18896:18910,19255:19276,19395:19405,20218:20245,20749:20758,20840:20849,21209:21213,21226:21235)' = c(-79.999 , 199.999),    # CRB_kso::k.sol | change = pctchg
  'CRB_bd::bd.sol | change = pctchg | unit =       c(1:6,43:52,68:96,364:382,615:625,771:776,858:887,1052:1059,1092:1099,1120:1136,1181:1199,1217:1276,1429:1445,1653:1714,1745:1749,1905:2007,2042:2058,2413:2442,2553:2623,2662:2691,2716:2900,2917:2936,2970:2999,3019:3054,3077:3078,3217:3263,3880:3934,3977:4080,4164:4256,4402:4433,4538:4634,4662:4747,4773:4786,4793:4832,5795:5845,6164:6238,6441:6453,6460:6504,6531:6566,6584:6647,6680:6706,6733:6779,6846:6895,6916:6976,6998:7008,7035:7039,7133:7136,7190:7310,7854:7862,8118:8192,8248:8258,8273:8424,8683:8713,8730:8777,9058:9232,9369:9461,9469:9488,9493:9504,9509:9539,9556:9603,10193:10275,10302:10314,10328:10353,10368:10392,10405:10496,10511:10653,10733:10765,10873:10899,10992:11026,11305:11337,11697:11721,11819:11846,12118:12122,12197:12210,12263:12274,12481:12483,12504:12510,13189:13208,13223:13237,13494:13501,13655:13667,13971:13985,14329:14346,14709:14722,14743:14769,14810:14826,14888:14901,14953:14991,15007:15059,15136:15142,15202:15220,17246:17279,17310:17343,17437:17454,18123:18142,18218:18233,18514:18535,18896:18910,19255:19276,19395:19405,20218:20245,20749:20758,20840:20849,21209:21213,21226:21235)' = c(-29.999 , 29.999),     # CRB_bd::bd.sol | change = pctchg
  
  
  'DTH_esc::esco.hru | change = absval | unit =    c( 230:335,538:599,677:696,717:756,945:982,1060:1091,1200:1216,1415:1420,1455:1458,1479:1528,1533:1652,1750:1788,2008:2041,2340:2346,2353:2360,2901:2916,2937:2969,3000:3018,3055:3076,3289:3298,3460:3610,3623:3651,3674:3701,3718:3814,4081:4108,4661:4661,4833:5419,5444:5794,5846:5871,5951:5962,5977:5990,6087:6163,6239:6379,6414:6440,6454:6459,6505:6530,6825:6845,6896:6915,6977:6997,7009:7034,7040:7132,7137:7189,7367:7374,7450:7457,7531:7553,7688:7717,7746:7753,7768:7853,7863:8037,8052:8068,8088:8117,8193:8247,8259:8272,8495:8506,8534:8536,8558:8682,8714:8729,8778:9057,9462:9468,9489:9492,9505:9508,9540:9555,9604:9669,9683:9686,9818:9921,9939:9961,9976:10016,10148:10192,10276:10301,10315:10327,10668:10694,10766:10872,10900:10919,10942:10965,11070:11084,11101:11114,11123:11134,11142:11304,11484:11511,11561:11616,11629:11635,11659:11696,11722:11794,12123:12196,12211:12262,12447:12480,12484:12503,12511:12534,12572:13033,13054:13060,13126:13153,13238:13281,13292:13362,13373:13493,13502:13536,13704:13723,13734:13759,13807:13833,13918:13970,13986:13992,14102:14111,14208:14224,14250:14255,14325:14328,14353:14428,14453:14536,14550:14673,14693:14708,14723:14742,14866:14887,15060:15100,15172:15172,15221:15313,15351:15400,15423:15434,15457:15496,15522:15563,15608:15636,15672:15747,15773:15794,15819:15834,15848:15876,15914:15961,15973:16103,16112:16209,16215:16245,16288:16419,16431:16440,16453:16483,16515:16610,16661:16687,16717:16774,17039:17075,17101:17141,17239:17245,17280:17286,17400:17436,17630:17692,17722:17980,18029:18080,18143:18217,18234:18254,18292:18406,18417:18427,18435:18466,18492:18498,18536:18612,18640:18750,18756:18825,18975:19238,19315:19394,19406:19573,19589:19592,19639:19793,19854:19875,19919:19974,20044:20072,20192:20217,20271:20343,20682:20696,20737:20748,20764:20773,21101:21167,21203:21208,21214:21225,21236:21312,21323:21337,21354:21389,21442:21461,21480:21505,21577:21589,21648:21924,21956:21988,22002:22005,22045:22068)' = c(0.001 , 0.999),      # DTH_esc::esco.hru | change = absval
  'DTH_epc::epco.hru | change = absval | unit =    c( 230:335,538:599,677:696,717:756,945:982,1060:1091,1200:1216,1415:1420,1455:1458,1479:1528,1533:1652,1750:1788,2008:2041,2340:2346,2353:2360,2901:2916,2937:2969,3000:3018,3055:3076,3289:3298,3460:3610,3623:3651,3674:3701,3718:3814,4081:4108,4661:4661,4833:5419,5444:5794,5846:5871,5951:5962,5977:5990,6087:6163,6239:6379,6414:6440,6454:6459,6505:6530,6825:6845,6896:6915,6977:6997,7009:7034,7040:7132,7137:7189,7367:7374,7450:7457,7531:7553,7688:7717,7746:7753,7768:7853,7863:8037,8052:8068,8088:8117,8193:8247,8259:8272,8495:8506,8534:8536,8558:8682,8714:8729,8778:9057,9462:9468,9489:9492,9505:9508,9540:9555,9604:9669,9683:9686,9818:9921,9939:9961,9976:10016,10148:10192,10276:10301,10315:10327,10668:10694,10766:10872,10900:10919,10942:10965,11070:11084,11101:11114,11123:11134,11142:11304,11484:11511,11561:11616,11629:11635,11659:11696,11722:11794,12123:12196,12211:12262,12447:12480,12484:12503,12511:12534,12572:13033,13054:13060,13126:13153,13238:13281,13292:13362,13373:13493,13502:13536,13704:13723,13734:13759,13807:13833,13918:13970,13986:13992,14102:14111,14208:14224,14250:14255,14325:14328,14353:14428,14453:14536,14550:14673,14693:14708,14723:14742,14866:14887,15060:15100,15172:15172,15221:15313,15351:15400,15423:15434,15457:15496,15522:15563,15608:15636,15672:15747,15773:15794,15819:15834,15848:15876,15914:15961,15973:16103,16112:16209,16215:16245,16288:16419,16431:16440,16453:16483,16515:16610,16661:16687,16717:16774,17039:17075,17101:17141,17239:17245,17280:17286,17400:17436,17630:17692,17722:17980,18029:18080,18143:18217,18234:18254,18292:18406,18417:18427,18435:18466,18492:18498,18536:18612,18640:18750,18756:18825,18975:19238,19315:19394,19406:19573,19589:19592,19639:19793,19854:19875,19919:19974,20044:20072,20192:20217,20271:20343,20682:20696,20737:20748,20764:20773,21101:21167,21203:21208,21214:21225,21236:21312,21323:21337,21354:21389,21442:21461,21480:21505,21577:21589,21648:21924,21956:21988,22002:22005,22045:22068)' = c(0.001 , 0.999),      # DTH_epc::epco.hru | change = absval
  'DTH_cnn::cn2.hru | change = pctchg | unit =     c( 230:335,538:599,677:696,717:756,945:982,1060:1091,1200:1216,1415:1420,1455:1458,1479:1528,1533:1652,1750:1788,2008:2041,2340:2346,2353:2360,2901:2916,2937:2969,3000:3018,3055:3076,3289:3298,3460:3610,3623:3651,3674:3701,3718:3814,4081:4108,4661:4661,4833:5419,5444:5794,5846:5871,5951:5962,5977:5990,6087:6163,6239:6379,6414:6440,6454:6459,6505:6530,6825:6845,6896:6915,6977:6997,7009:7034,7040:7132,7137:7189,7367:7374,7450:7457,7531:7553,7688:7717,7746:7753,7768:7853,7863:8037,8052:8068,8088:8117,8193:8247,8259:8272,8495:8506,8534:8536,8558:8682,8714:8729,8778:9057,9462:9468,9489:9492,9505:9508,9540:9555,9604:9669,9683:9686,9818:9921,9939:9961,9976:10016,10148:10192,10276:10301,10315:10327,10668:10694,10766:10872,10900:10919,10942:10965,11070:11084,11101:11114,11123:11134,11142:11304,11484:11511,11561:11616,11629:11635,11659:11696,11722:11794,12123:12196,12211:12262,12447:12480,12484:12503,12511:12534,12572:13033,13054:13060,13126:13153,13238:13281,13292:13362,13373:13493,13502:13536,13704:13723,13734:13759,13807:13833,13918:13970,13986:13992,14102:14111,14208:14224,14250:14255,14325:14328,14353:14428,14453:14536,14550:14673,14693:14708,14723:14742,14866:14887,15060:15100,15172:15172,15221:15313,15351:15400,15423:15434,15457:15496,15522:15563,15608:15636,15672:15747,15773:15794,15819:15834,15848:15876,15914:15961,15973:16103,16112:16209,16215:16245,16288:16419,16431:16440,16453:16483,16515:16610,16661:16687,16717:16774,17039:17075,17101:17141,17239:17245,17280:17286,17400:17436,17630:17692,17722:17980,18029:18080,18143:18217,18234:18254,18292:18406,18417:18427,18435:18466,18492:18498,18536:18612,18640:18750,18756:18825,18975:19238,19315:19394,19406:19573,19589:19592,19639:19793,19854:19875,19919:19974,20044:20072,20192:20217,20271:20343,20682:20696,20737:20748,20764:20773,21101:21167,21203:21208,21214:21225,21236:21312,21323:21337,21354:21389,21442:21461,21480:21505,21577:21589,21648:21924,21956:21988,22002:22005,22045:22068)' = c(-29.999  ,  29.999), # DTH_cnn::cn2.hru | change = pctchg
  'DTH_awc::awc.sol | change = pctchg | unit =     c( 230:335,538:599,677:696,717:756,945:982,1060:1091,1200:1216,1415:1420,1455:1458,1479:1528,1533:1652,1750:1788,2008:2041,2340:2346,2353:2360,2901:2916,2937:2969,3000:3018,3055:3076,3289:3298,3460:3610,3623:3651,3674:3701,3718:3814,4081:4108,4661:4661,4833:5419,5444:5794,5846:5871,5951:5962,5977:5990,6087:6163,6239:6379,6414:6440,6454:6459,6505:6530,6825:6845,6896:6915,6977:6997,7009:7034,7040:7132,7137:7189,7367:7374,7450:7457,7531:7553,7688:7717,7746:7753,7768:7853,7863:8037,8052:8068,8088:8117,8193:8247,8259:8272,8495:8506,8534:8536,8558:8682,8714:8729,8778:9057,9462:9468,9489:9492,9505:9508,9540:9555,9604:9669,9683:9686,9818:9921,9939:9961,9976:10016,10148:10192,10276:10301,10315:10327,10668:10694,10766:10872,10900:10919,10942:10965,11070:11084,11101:11114,11123:11134,11142:11304,11484:11511,11561:11616,11629:11635,11659:11696,11722:11794,12123:12196,12211:12262,12447:12480,12484:12503,12511:12534,12572:13033,13054:13060,13126:13153,13238:13281,13292:13362,13373:13493,13502:13536,13704:13723,13734:13759,13807:13833,13918:13970,13986:13992,14102:14111,14208:14224,14250:14255,14325:14328,14353:14428,14453:14536,14550:14673,14693:14708,14723:14742,14866:14887,15060:15100,15172:15172,15221:15313,15351:15400,15423:15434,15457:15496,15522:15563,15608:15636,15672:15747,15773:15794,15819:15834,15848:15876,15914:15961,15973:16103,16112:16209,16215:16245,16288:16419,16431:16440,16453:16483,16515:16610,16661:16687,16717:16774,17039:17075,17101:17141,17239:17245,17280:17286,17400:17436,17630:17692,17722:17980,18029:18080,18143:18217,18234:18254,18292:18406,18417:18427,18435:18466,18492:18498,18536:18612,18640:18750,18756:18825,18975:19238,19315:19394,19406:19573,19589:19592,19639:19793,19854:19875,19919:19974,20044:20072,20192:20217,20271:20343,20682:20696,20737:20748,20764:20773,21101:21167,21203:21208,21214:21225,21236:21312,21323:21337,21354:21389,21442:21461,21480:21505,21577:21589,21648:21924,21956:21988,22002:22005,22045:22068)' = c(-59.999 , 59.999),   # DTH_awc::awc.sol | change = pctchg
  'DTH_per::perco.hru | change = absval | unit =   c( 230:335,538:599,677:696,717:756,945:982,1060:1091,1200:1216,1415:1420,1455:1458,1479:1528,1533:1652,1750:1788,2008:2041,2340:2346,2353:2360,2901:2916,2937:2969,3000:3018,3055:3076,3289:3298,3460:3610,3623:3651,3674:3701,3718:3814,4081:4108,4661:4661,4833:5419,5444:5794,5846:5871,5951:5962,5977:5990,6087:6163,6239:6379,6414:6440,6454:6459,6505:6530,6825:6845,6896:6915,6977:6997,7009:7034,7040:7132,7137:7189,7367:7374,7450:7457,7531:7553,7688:7717,7746:7753,7768:7853,7863:8037,8052:8068,8088:8117,8193:8247,8259:8272,8495:8506,8534:8536,8558:8682,8714:8729,8778:9057,9462:9468,9489:9492,9505:9508,9540:9555,9604:9669,9683:9686,9818:9921,9939:9961,9976:10016,10148:10192,10276:10301,10315:10327,10668:10694,10766:10872,10900:10919,10942:10965,11070:11084,11101:11114,11123:11134,11142:11304,11484:11511,11561:11616,11629:11635,11659:11696,11722:11794,12123:12196,12211:12262,12447:12480,12484:12503,12511:12534,12572:13033,13054:13060,13126:13153,13238:13281,13292:13362,13373:13493,13502:13536,13704:13723,13734:13759,13807:13833,13918:13970,13986:13992,14102:14111,14208:14224,14250:14255,14325:14328,14353:14428,14453:14536,14550:14673,14693:14708,14723:14742,14866:14887,15060:15100,15172:15172,15221:15313,15351:15400,15423:15434,15457:15496,15522:15563,15608:15636,15672:15747,15773:15794,15819:15834,15848:15876,15914:15961,15973:16103,16112:16209,16215:16245,16288:16419,16431:16440,16453:16483,16515:16610,16661:16687,16717:16774,17039:17075,17101:17141,17239:17245,17280:17286,17400:17436,17630:17692,17722:17980,18029:18080,18143:18217,18234:18254,18292:18406,18417:18427,18435:18466,18492:18498,18536:18612,18640:18750,18756:18825,18975:19238,19315:19394,19406:19573,19589:19592,19639:19793,19854:19875,19919:19974,20044:20072,20192:20217,20271:20343,20682:20696,20737:20748,20764:20773,21101:21167,21203:21208,21214:21225,21236:21312,21323:21337,21354:21389,21442:21461,21480:21505,21577:21589,21648:21924,21956:21988,22002:22005,22045:22068)' = c(0.2 , 0.999),        # DTH_per::perco.hru | change = absval
  'DTH_latq::latq_co.hru | change = abschg | unit =   c( 230:335,538:599,677:696,717:756,945:982,1060:1091,1200:1216,1415:1420,1455:1458,1479:1528,1533:1652,1750:1788,2008:2041,2340:2346,2353:2360,2901:2916,2937:2969,3000:3018,3055:3076,3289:3298,3460:3610,3623:3651,3674:3701,3718:3814,4081:4108,4661:4661,4833:5419,5444:5794,5846:5871,5951:5962,5977:5990,6087:6163,6239:6379,6414:6440,6454:6459,6505:6530,6825:6845,6896:6915,6977:6997,7009:7034,7040:7132,7137:7189,7367:7374,7450:7457,7531:7553,7688:7717,7746:7753,7768:7853,7863:8037,8052:8068,8088:8117,8193:8247,8259:8272,8495:8506,8534:8536,8558:8682,8714:8729,8778:9057,9462:9468,9489:9492,9505:9508,9540:9555,9604:9669,9683:9686,9818:9921,9939:9961,9976:10016,10148:10192,10276:10301,10315:10327,10668:10694,10766:10872,10900:10919,10942:10965,11070:11084,11101:11114,11123:11134,11142:11304,11484:11511,11561:11616,11629:11635,11659:11696,11722:11794,12123:12196,12211:12262,12447:12480,12484:12503,12511:12534,12572:13033,13054:13060,13126:13153,13238:13281,13292:13362,13373:13493,13502:13536,13704:13723,13734:13759,13807:13833,13918:13970,13986:13992,14102:14111,14208:14224,14250:14255,14325:14328,14353:14428,14453:14536,14550:14673,14693:14708,14723:14742,14866:14887,15060:15100,15172:15172,15221:15313,15351:15400,15423:15434,15457:15496,15522:15563,15608:15636,15672:15747,15773:15794,15819:15834,15848:15876,15914:15961,15973:16103,16112:16209,16215:16245,16288:16419,16431:16440,16453:16483,16515:16610,16661:16687,16717:16774,17039:17075,17101:17141,17239:17245,17280:17286,17400:17436,17630:17692,17722:17980,18029:18080,18143:18217,18234:18254,18292:18406,18417:18427,18435:18466,18492:18498,18536:18612,18640:18750,18756:18825,18975:19238,19315:19394,19406:19573,19589:19592,19639:19793,19854:19875,19919:19974,20044:20072,20192:20217,20271:20343,20682:20696,20737:20748,20764:20773,21101:21167,21203:21208,21214:21225,21236:21312,21323:21337,21354:21389,21442:21461,21480:21505,21577:21589,21648:21924,21956:21988,22002:22005,22045:22068)' = c(-0.5, 0.5),       # DTH_latq::latq_co.hru | change = abschg
  'DTH_cn3::cn3_swf.hru | change = abschg | unit = c( 230:335,538:599,677:696,717:756,945:982,1060:1091,1200:1216,1415:1420,1455:1458,1479:1528,1533:1652,1750:1788,2008:2041,2340:2346,2353:2360,2901:2916,2937:2969,3000:3018,3055:3076,3289:3298,3460:3610,3623:3651,3674:3701,3718:3814,4081:4108,4661:4661,4833:5419,5444:5794,5846:5871,5951:5962,5977:5990,6087:6163,6239:6379,6414:6440,6454:6459,6505:6530,6825:6845,6896:6915,6977:6997,7009:7034,7040:7132,7137:7189,7367:7374,7450:7457,7531:7553,7688:7717,7746:7753,7768:7853,7863:8037,8052:8068,8088:8117,8193:8247,8259:8272,8495:8506,8534:8536,8558:8682,8714:8729,8778:9057,9462:9468,9489:9492,9505:9508,9540:9555,9604:9669,9683:9686,9818:9921,9939:9961,9976:10016,10148:10192,10276:10301,10315:10327,10668:10694,10766:10872,10900:10919,10942:10965,11070:11084,11101:11114,11123:11134,11142:11304,11484:11511,11561:11616,11629:11635,11659:11696,11722:11794,12123:12196,12211:12262,12447:12480,12484:12503,12511:12534,12572:13033,13054:13060,13126:13153,13238:13281,13292:13362,13373:13493,13502:13536,13704:13723,13734:13759,13807:13833,13918:13970,13986:13992,14102:14111,14208:14224,14250:14255,14325:14328,14353:14428,14453:14536,14550:14673,14693:14708,14723:14742,14866:14887,15060:15100,15172:15172,15221:15313,15351:15400,15423:15434,15457:15496,15522:15563,15608:15636,15672:15747,15773:15794,15819:15834,15848:15876,15914:15961,15973:16103,16112:16209,16215:16245,16288:16419,16431:16440,16453:16483,16515:16610,16661:16687,16717:16774,17039:17075,17101:17141,17239:17245,17280:17286,17400:17436,17630:17692,17722:17980,18029:18080,18143:18217,18234:18254,18292:18406,18417:18427,18435:18466,18492:18498,18536:18612,18640:18750,18756:18825,18975:19238,19315:19394,19406:19573,19589:19592,19639:19793,19854:19875,19919:19974,20044:20072,20192:20217,20271:20343,20682:20696,20737:20748,20764:20773,21101:21167,21203:21208,21214:21225,21236:21312,21323:21337,21354:21389,21442:21461,21480:21505,21577:21589,21648:21924,21956:21988,22002:22005,22045:22068)' = c(-0.5, 0.5),          # DTH_cn3::cn3_swf.hru | change = abschg
  'DTH_zso::z.sol | change = pctchg | unit =       c( 230:335,538:599,677:696,717:756,945:982,1060:1091,1200:1216,1415:1420,1455:1458,1479:1528,1533:1652,1750:1788,2008:2041,2340:2346,2353:2360,2901:2916,2937:2969,3000:3018,3055:3076,3289:3298,3460:3610,3623:3651,3674:3701,3718:3814,4081:4108,4661:4661,4833:5419,5444:5794,5846:5871,5951:5962,5977:5990,6087:6163,6239:6379,6414:6440,6454:6459,6505:6530,6825:6845,6896:6915,6977:6997,7009:7034,7040:7132,7137:7189,7367:7374,7450:7457,7531:7553,7688:7717,7746:7753,7768:7853,7863:8037,8052:8068,8088:8117,8193:8247,8259:8272,8495:8506,8534:8536,8558:8682,8714:8729,8778:9057,9462:9468,9489:9492,9505:9508,9540:9555,9604:9669,9683:9686,9818:9921,9939:9961,9976:10016,10148:10192,10276:10301,10315:10327,10668:10694,10766:10872,10900:10919,10942:10965,11070:11084,11101:11114,11123:11134,11142:11304,11484:11511,11561:11616,11629:11635,11659:11696,11722:11794,12123:12196,12211:12262,12447:12480,12484:12503,12511:12534,12572:13033,13054:13060,13126:13153,13238:13281,13292:13362,13373:13493,13502:13536,13704:13723,13734:13759,13807:13833,13918:13970,13986:13992,14102:14111,14208:14224,14250:14255,14325:14328,14353:14428,14453:14536,14550:14673,14693:14708,14723:14742,14866:14887,15060:15100,15172:15172,15221:15313,15351:15400,15423:15434,15457:15496,15522:15563,15608:15636,15672:15747,15773:15794,15819:15834,15848:15876,15914:15961,15973:16103,16112:16209,16215:16245,16288:16419,16431:16440,16453:16483,16515:16610,16661:16687,16717:16774,17039:17075,17101:17141,17239:17245,17280:17286,17400:17436,17630:17692,17722:17980,18029:18080,18143:18217,18234:18254,18292:18406,18417:18427,18435:18466,18492:18498,18536:18612,18640:18750,18756:18825,18975:19238,19315:19394,19406:19573,19589:19592,19639:19793,19854:19875,19919:19974,20044:20072,20192:20217,20271:20343,20682:20696,20737:20748,20764:20773,21101:21167,21203:21208,21214:21225,21236:21312,21323:21337,21354:21389,21442:21461,21480:21505,21577:21589,21648:21924,21956:21988,22002:22005,22045:22068)' = c(-49.999 , 49.999),   # DTH_zso::z.sol | change = pctchg
  'DTH_kso::k.sol | change = pctchg | unit =       c( 230:335,538:599,677:696,717:756,945:982,1060:1091,1200:1216,1415:1420,1455:1458,1479:1528,1533:1652,1750:1788,2008:2041,2340:2346,2353:2360,2901:2916,2937:2969,3000:3018,3055:3076,3289:3298,3460:3610,3623:3651,3674:3701,3718:3814,4081:4108,4661:4661,4833:5419,5444:5794,5846:5871,5951:5962,5977:5990,6087:6163,6239:6379,6414:6440,6454:6459,6505:6530,6825:6845,6896:6915,6977:6997,7009:7034,7040:7132,7137:7189,7367:7374,7450:7457,7531:7553,7688:7717,7746:7753,7768:7853,7863:8037,8052:8068,8088:8117,8193:8247,8259:8272,8495:8506,8534:8536,8558:8682,8714:8729,8778:9057,9462:9468,9489:9492,9505:9508,9540:9555,9604:9669,9683:9686,9818:9921,9939:9961,9976:10016,10148:10192,10276:10301,10315:10327,10668:10694,10766:10872,10900:10919,10942:10965,11070:11084,11101:11114,11123:11134,11142:11304,11484:11511,11561:11616,11629:11635,11659:11696,11722:11794,12123:12196,12211:12262,12447:12480,12484:12503,12511:12534,12572:13033,13054:13060,13126:13153,13238:13281,13292:13362,13373:13493,13502:13536,13704:13723,13734:13759,13807:13833,13918:13970,13986:13992,14102:14111,14208:14224,14250:14255,14325:14328,14353:14428,14453:14536,14550:14673,14693:14708,14723:14742,14866:14887,15060:15100,15172:15172,15221:15313,15351:15400,15423:15434,15457:15496,15522:15563,15608:15636,15672:15747,15773:15794,15819:15834,15848:15876,15914:15961,15973:16103,16112:16209,16215:16245,16288:16419,16431:16440,16453:16483,16515:16610,16661:16687,16717:16774,17039:17075,17101:17141,17239:17245,17280:17286,17400:17436,17630:17692,17722:17980,18029:18080,18143:18217,18234:18254,18292:18406,18417:18427,18435:18466,18492:18498,18536:18612,18640:18750,18756:18825,18975:19238,19315:19394,19406:19573,19589:19592,19639:19793,19854:19875,19919:19974,20044:20072,20192:20217,20271:20343,20682:20696,20737:20748,20764:20773,21101:21167,21203:21208,21214:21225,21236:21312,21323:21337,21354:21389,21442:21461,21480:21505,21577:21589,21648:21924,21956:21988,22002:22005,22045:22068)' = c(-79.999 , 199.999),  # DTH_kso::k.sol | change = pctchg
  'DTH_bd::bd.sol | change = pctchg | unit =       c( 230:335,538:599,677:696,717:756,945:982,1060:1091,1200:1216,1415:1420,1455:1458,1479:1528,1533:1652,1750:1788,2008:2041,2340:2346,2353:2360,2901:2916,2937:2969,3000:3018,3055:3076,3289:3298,3460:3610,3623:3651,3674:3701,3718:3814,4081:4108,4661:4661,4833:5419,5444:5794,5846:5871,5951:5962,5977:5990,6087:6163,6239:6379,6414:6440,6454:6459,6505:6530,6825:6845,6896:6915,6977:6997,7009:7034,7040:7132,7137:7189,7367:7374,7450:7457,7531:7553,7688:7717,7746:7753,7768:7853,7863:8037,8052:8068,8088:8117,8193:8247,8259:8272,8495:8506,8534:8536,8558:8682,8714:8729,8778:9057,9462:9468,9489:9492,9505:9508,9540:9555,9604:9669,9683:9686,9818:9921,9939:9961,9976:10016,10148:10192,10276:10301,10315:10327,10668:10694,10766:10872,10900:10919,10942:10965,11070:11084,11101:11114,11123:11134,11142:11304,11484:11511,11561:11616,11629:11635,11659:11696,11722:11794,12123:12196,12211:12262,12447:12480,12484:12503,12511:12534,12572:13033,13054:13060,13126:13153,13238:13281,13292:13362,13373:13493,13502:13536,13704:13723,13734:13759,13807:13833,13918:13970,13986:13992,14102:14111,14208:14224,14250:14255,14325:14328,14353:14428,14453:14536,14550:14673,14693:14708,14723:14742,14866:14887,15060:15100,15172:15172,15221:15313,15351:15400,15423:15434,15457:15496,15522:15563,15608:15636,15672:15747,15773:15794,15819:15834,15848:15876,15914:15961,15973:16103,16112:16209,16215:16245,16288:16419,16431:16440,16453:16483,16515:16610,16661:16687,16717:16774,17039:17075,17101:17141,17239:17245,17280:17286,17400:17436,17630:17692,17722:17980,18029:18080,18143:18217,18234:18254,18292:18406,18417:18427,18435:18466,18492:18498,18536:18612,18640:18750,18756:18825,18975:19238,19315:19394,19406:19573,19589:19592,19639:19793,19854:19875,19919:19974,20044:20072,20192:20217,20271:20343,20682:20696,20737:20748,20764:20773,21101:21167,21203:21208,21214:21225,21236:21312,21323:21337,21354:21389,21442:21461,21480:21505,21577:21589,21648:21924,21956:21988,22002:22005,22045:22068)' = c(-29.999 , 29.999),   # DTH_bd::bd.sol | change = pctchg
  
  
  'DTL_esc::esco.hru | change = absval | unit =    c(  7:42,336:363,383:431,467:492,607:614,777:857,888:944,983:1051,1100:1119,1137:1180,1715:1744,1877:1904,2385:2412,2443:2552,2624:2661,2692:2715,3079:3216,3264:3288,3611:3622,3652:3673,3702:3717,3815:3879,3935:3976,4109:4163,4257:4401,4434:4537,4635:4660,4748:4772,4787:4792,5872:5899,6380:6413,6567:6583,6648:6679,6707:6732,6780:6824,7554:7687,7718:7745,7754:7767,8038:8051,8069:8087,9670:9682,9922:9938,9962:9975,10354:10367,10393:10404,10497:10510,10654:10667,10695:10732,10920:10941,10966:10991,11512:11560,11617:11628,11636:11658,11795:11818,12535:12571,13034:13053,13209:13222,13282:13291,13363:13372,13537:13654,13668:13703,13724:13733,13760:13806,13834:13917,13993:14101,14112:14207,14225:14249,14256:14324,14347:14352,14429:14452,14537:14549,14674:14692,14770:14809,14827:14865,14902:14952,14992:15006,15101:15135,15143:15171,15173:15201,15314:15350,15401:15422,15435:15456,15497:15521,15564:15607,15637:15671,16104:16111,16210:16214,16246:16287,16420:16430,16441:16452,16611:16660,16688:16716,16775:17038,17076:17100,17142:17238,17287:17309,17344:17367,17455:17522,17981:18028,18081:18122,18255:18291,18407:18416,18428:18434,18467:18491,18499:18513,18751:18755,18826:18895,18911:18974,19277:19314,20246:20270,20667:20681,20697:20736,20759:20763,20774:20839,21506:21576,21590:21647 )' = c(0.001 , 0.999),      # DTL_esc::esco.hru | change = absval
  'DTL_epc::epco.hru | change = absval | unit =    c(  7:42,336:363,383:431,467:492,607:614,777:857,888:944,983:1051,1100:1119,1137:1180,1715:1744,1877:1904,2385:2412,2443:2552,2624:2661,2692:2715,3079:3216,3264:3288,3611:3622,3652:3673,3702:3717,3815:3879,3935:3976,4109:4163,4257:4401,4434:4537,4635:4660,4748:4772,4787:4792,5872:5899,6380:6413,6567:6583,6648:6679,6707:6732,6780:6824,7554:7687,7718:7745,7754:7767,8038:8051,8069:8087,9670:9682,9922:9938,9962:9975,10354:10367,10393:10404,10497:10510,10654:10667,10695:10732,10920:10941,10966:10991,11512:11560,11617:11628,11636:11658,11795:11818,12535:12571,13034:13053,13209:13222,13282:13291,13363:13372,13537:13654,13668:13703,13724:13733,13760:13806,13834:13917,13993:14101,14112:14207,14225:14249,14256:14324,14347:14352,14429:14452,14537:14549,14674:14692,14770:14809,14827:14865,14902:14952,14992:15006,15101:15135,15143:15171,15173:15201,15314:15350,15401:15422,15435:15456,15497:15521,15564:15607,15637:15671,16104:16111,16210:16214,16246:16287,16420:16430,16441:16452,16611:16660,16688:16716,16775:17038,17076:17100,17142:17238,17287:17309,17344:17367,17455:17522,17981:18028,18081:18122,18255:18291,18407:18416,18428:18434,18467:18491,18499:18513,18751:18755,18826:18895,18911:18974,19277:19314,20246:20270,20667:20681,20697:20736,20759:20763,20774:20839,21506:21576,21590:21647 )' = c(0.001 , 0.999),      # DTL_epc::epco.hru | change = absval
  'DTL_cnn::cn2.hru | change = pctchg | unit =     c(  7:42,336:363,383:431,467:492,607:614,777:857,888:944,983:1051,1100:1119,1137:1180,1715:1744,1877:1904,2385:2412,2443:2552,2624:2661,2692:2715,3079:3216,3264:3288,3611:3622,3652:3673,3702:3717,3815:3879,3935:3976,4109:4163,4257:4401,4434:4537,4635:4660,4748:4772,4787:4792,5872:5899,6380:6413,6567:6583,6648:6679,6707:6732,6780:6824,7554:7687,7718:7745,7754:7767,8038:8051,8069:8087,9670:9682,9922:9938,9962:9975,10354:10367,10393:10404,10497:10510,10654:10667,10695:10732,10920:10941,10966:10991,11512:11560,11617:11628,11636:11658,11795:11818,12535:12571,13034:13053,13209:13222,13282:13291,13363:13372,13537:13654,13668:13703,13724:13733,13760:13806,13834:13917,13993:14101,14112:14207,14225:14249,14256:14324,14347:14352,14429:14452,14537:14549,14674:14692,14770:14809,14827:14865,14902:14952,14992:15006,15101:15135,15143:15171,15173:15201,15314:15350,15401:15422,15435:15456,15497:15521,15564:15607,15637:15671,16104:16111,16210:16214,16246:16287,16420:16430,16441:16452,16611:16660,16688:16716,16775:17038,17076:17100,17142:17238,17287:17309,17344:17367,17455:17522,17981:18028,18081:18122,18255:18291,18407:18416,18428:18434,18467:18491,18499:18513,18751:18755,18826:18895,18911:18974,19277:19314,20246:20270,20667:20681,20697:20736,20759:20763,20774:20839,21506:21576,21590:21647 )' = c(-29.999  ,  29.999), # DTL_cnn::cn2.hru | change = pctchg
  'DTL_awc::awc.sol | change = pctchg | unit =     c(  7:42,336:363,383:431,467:492,607:614,777:857,888:944,983:1051,1100:1119,1137:1180,1715:1744,1877:1904,2385:2412,2443:2552,2624:2661,2692:2715,3079:3216,3264:3288,3611:3622,3652:3673,3702:3717,3815:3879,3935:3976,4109:4163,4257:4401,4434:4537,4635:4660,4748:4772,4787:4792,5872:5899,6380:6413,6567:6583,6648:6679,6707:6732,6780:6824,7554:7687,7718:7745,7754:7767,8038:8051,8069:8087,9670:9682,9922:9938,9962:9975,10354:10367,10393:10404,10497:10510,10654:10667,10695:10732,10920:10941,10966:10991,11512:11560,11617:11628,11636:11658,11795:11818,12535:12571,13034:13053,13209:13222,13282:13291,13363:13372,13537:13654,13668:13703,13724:13733,13760:13806,13834:13917,13993:14101,14112:14207,14225:14249,14256:14324,14347:14352,14429:14452,14537:14549,14674:14692,14770:14809,14827:14865,14902:14952,14992:15006,15101:15135,15143:15171,15173:15201,15314:15350,15401:15422,15435:15456,15497:15521,15564:15607,15637:15671,16104:16111,16210:16214,16246:16287,16420:16430,16441:16452,16611:16660,16688:16716,16775:17038,17076:17100,17142:17238,17287:17309,17344:17367,17455:17522,17981:18028,18081:18122,18255:18291,18407:18416,18428:18434,18467:18491,18499:18513,18751:18755,18826:18895,18911:18974,19277:19314,20246:20270,20667:20681,20697:20736,20759:20763,20774:20839,21506:21576,21590:21647 )' = c(-59.999 , 59.999),   # DTL_awc::awc.sol | change = pctchg
  'DTL_per::perco.hru | change = absval | unit =   c(  7:42,336:363,383:431,467:492,607:614,777:857,888:944,983:1051,1100:1119,1137:1180,1715:1744,1877:1904,2385:2412,2443:2552,2624:2661,2692:2715,3079:3216,3264:3288,3611:3622,3652:3673,3702:3717,3815:3879,3935:3976,4109:4163,4257:4401,4434:4537,4635:4660,4748:4772,4787:4792,5872:5899,6380:6413,6567:6583,6648:6679,6707:6732,6780:6824,7554:7687,7718:7745,7754:7767,8038:8051,8069:8087,9670:9682,9922:9938,9962:9975,10354:10367,10393:10404,10497:10510,10654:10667,10695:10732,10920:10941,10966:10991,11512:11560,11617:11628,11636:11658,11795:11818,12535:12571,13034:13053,13209:13222,13282:13291,13363:13372,13537:13654,13668:13703,13724:13733,13760:13806,13834:13917,13993:14101,14112:14207,14225:14249,14256:14324,14347:14352,14429:14452,14537:14549,14674:14692,14770:14809,14827:14865,14902:14952,14992:15006,15101:15135,15143:15171,15173:15201,15314:15350,15401:15422,15435:15456,15497:15521,15564:15607,15637:15671,16104:16111,16210:16214,16246:16287,16420:16430,16441:16452,16611:16660,16688:16716,16775:17038,17076:17100,17142:17238,17287:17309,17344:17367,17455:17522,17981:18028,18081:18122,18255:18291,18407:18416,18428:18434,18467:18491,18499:18513,18751:18755,18826:18895,18911:18974,19277:19314,20246:20270,20667:20681,20697:20736,20759:20763,20774:20839,21506:21576,21590:21647 )' = c(0.001 , 0.7),        # DTL_per::perco.hru | change = absval
  'DTL_latq::latq_co.hru | change = abschg | unit =   c(  7:42,336:363,383:431,467:492,607:614,777:857,888:944,983:1051,1100:1119,1137:1180,1715:1744,1877:1904,2385:2412,2443:2552,2624:2661,2692:2715,3079:3216,3264:3288,3611:3622,3652:3673,3702:3717,3815:3879,3935:3976,4109:4163,4257:4401,4434:4537,4635:4660,4748:4772,4787:4792,5872:5899,6380:6413,6567:6583,6648:6679,6707:6732,6780:6824,7554:7687,7718:7745,7754:7767,8038:8051,8069:8087,9670:9682,9922:9938,9962:9975,10354:10367,10393:10404,10497:10510,10654:10667,10695:10732,10920:10941,10966:10991,11512:11560,11617:11628,11636:11658,11795:11818,12535:12571,13034:13053,13209:13222,13282:13291,13363:13372,13537:13654,13668:13703,13724:13733,13760:13806,13834:13917,13993:14101,14112:14207,14225:14249,14256:14324,14347:14352,14429:14452,14537:14549,14674:14692,14770:14809,14827:14865,14902:14952,14992:15006,15101:15135,15143:15171,15173:15201,15314:15350,15401:15422,15435:15456,15497:15521,15564:15607,15637:15671,16104:16111,16210:16214,16246:16287,16420:16430,16441:16452,16611:16660,16688:16716,16775:17038,17076:17100,17142:17238,17287:17309,17344:17367,17455:17522,17981:18028,18081:18122,18255:18291,18407:18416,18428:18434,18467:18491,18499:18513,18751:18755,18826:18895,18911:18974,19277:19314,20246:20270,20667:20681,20697:20736,20759:20763,20774:20839,21506:21576,21590:21647 )' = c(-0.5, 0.5),       # DTL_latq::latq_co.hru | change = abschg
  'DTL_cn3::cn3_swf.hru | change = abschg | unit = c(  7:42,336:363,383:431,467:492,607:614,777:857,888:944,983:1051,1100:1119,1137:1180,1715:1744,1877:1904,2385:2412,2443:2552,2624:2661,2692:2715,3079:3216,3264:3288,3611:3622,3652:3673,3702:3717,3815:3879,3935:3976,4109:4163,4257:4401,4434:4537,4635:4660,4748:4772,4787:4792,5872:5899,6380:6413,6567:6583,6648:6679,6707:6732,6780:6824,7554:7687,7718:7745,7754:7767,8038:8051,8069:8087,9670:9682,9922:9938,9962:9975,10354:10367,10393:10404,10497:10510,10654:10667,10695:10732,10920:10941,10966:10991,11512:11560,11617:11628,11636:11658,11795:11818,12535:12571,13034:13053,13209:13222,13282:13291,13363:13372,13537:13654,13668:13703,13724:13733,13760:13806,13834:13917,13993:14101,14112:14207,14225:14249,14256:14324,14347:14352,14429:14452,14537:14549,14674:14692,14770:14809,14827:14865,14902:14952,14992:15006,15101:15135,15143:15171,15173:15201,15314:15350,15401:15422,15435:15456,15497:15521,15564:15607,15637:15671,16104:16111,16210:16214,16246:16287,16420:16430,16441:16452,16611:16660,16688:16716,16775:17038,17076:17100,17142:17238,17287:17309,17344:17367,17455:17522,17981:18028,18081:18122,18255:18291,18407:18416,18428:18434,18467:18491,18499:18513,18751:18755,18826:18895,18911:18974,19277:19314,20246:20270,20667:20681,20697:20736,20759:20763,20774:20839,21506:21576,21590:21647 )' = c(-0.5, 0.5),          # DTL_cn3::cn3_swf.hru | change = abschg
  'DTL_zso::z.sol | change = pctchg | unit =       c(  7:42,336:363,383:431,467:492,607:614,777:857,888:944,983:1051,1100:1119,1137:1180,1715:1744,1877:1904,2385:2412,2443:2552,2624:2661,2692:2715,3079:3216,3264:3288,3611:3622,3652:3673,3702:3717,3815:3879,3935:3976,4109:4163,4257:4401,4434:4537,4635:4660,4748:4772,4787:4792,5872:5899,6380:6413,6567:6583,6648:6679,6707:6732,6780:6824,7554:7687,7718:7745,7754:7767,8038:8051,8069:8087,9670:9682,9922:9938,9962:9975,10354:10367,10393:10404,10497:10510,10654:10667,10695:10732,10920:10941,10966:10991,11512:11560,11617:11628,11636:11658,11795:11818,12535:12571,13034:13053,13209:13222,13282:13291,13363:13372,13537:13654,13668:13703,13724:13733,13760:13806,13834:13917,13993:14101,14112:14207,14225:14249,14256:14324,14347:14352,14429:14452,14537:14549,14674:14692,14770:14809,14827:14865,14902:14952,14992:15006,15101:15135,15143:15171,15173:15201,15314:15350,15401:15422,15435:15456,15497:15521,15564:15607,15637:15671,16104:16111,16210:16214,16246:16287,16420:16430,16441:16452,16611:16660,16688:16716,16775:17038,17076:17100,17142:17238,17287:17309,17344:17367,17455:17522,17981:18028,18081:18122,18255:18291,18407:18416,18428:18434,18467:18491,18499:18513,18751:18755,18826:18895,18911:18974,19277:19314,20246:20270,20667:20681,20697:20736,20759:20763,20774:20839,21506:21576,21590:21647 )' = c(-49.999 , 49.999),   # DTL_zso::z.sol | change = pctchg
  'DTL_kso::k.sol | change = pctchg | unit =       c(  7:42,336:363,383:431,467:492,607:614,777:857,888:944,983:1051,1100:1119,1137:1180,1715:1744,1877:1904,2385:2412,2443:2552,2624:2661,2692:2715,3079:3216,3264:3288,3611:3622,3652:3673,3702:3717,3815:3879,3935:3976,4109:4163,4257:4401,4434:4537,4635:4660,4748:4772,4787:4792,5872:5899,6380:6413,6567:6583,6648:6679,6707:6732,6780:6824,7554:7687,7718:7745,7754:7767,8038:8051,8069:8087,9670:9682,9922:9938,9962:9975,10354:10367,10393:10404,10497:10510,10654:10667,10695:10732,10920:10941,10966:10991,11512:11560,11617:11628,11636:11658,11795:11818,12535:12571,13034:13053,13209:13222,13282:13291,13363:13372,13537:13654,13668:13703,13724:13733,13760:13806,13834:13917,13993:14101,14112:14207,14225:14249,14256:14324,14347:14352,14429:14452,14537:14549,14674:14692,14770:14809,14827:14865,14902:14952,14992:15006,15101:15135,15143:15171,15173:15201,15314:15350,15401:15422,15435:15456,15497:15521,15564:15607,15637:15671,16104:16111,16210:16214,16246:16287,16420:16430,16441:16452,16611:16660,16688:16716,16775:17038,17076:17100,17142:17238,17287:17309,17344:17367,17455:17522,17981:18028,18081:18122,18255:18291,18407:18416,18428:18434,18467:18491,18499:18513,18751:18755,18826:18895,18911:18974,19277:19314,20246:20270,20667:20681,20697:20736,20759:20763,20774:20839,21506:21576,21590:21647 )' = c(-79.999 , 199.999),  # DTL_kso::k.sol | change = pctchg
  'DTL_bd::bd.sol | change = pctchg | unit =       c(  7:42,336:363,383:431,467:492,607:614,777:857,888:944,983:1051,1100:1119,1137:1180,1715:1744,1877:1904,2385:2412,2443:2552,2624:2661,2692:2715,3079:3216,3264:3288,3611:3622,3652:3673,3702:3717,3815:3879,3935:3976,4109:4163,4257:4401,4434:4537,4635:4660,4748:4772,4787:4792,5872:5899,6380:6413,6567:6583,6648:6679,6707:6732,6780:6824,7554:7687,7718:7745,7754:7767,8038:8051,8069:8087,9670:9682,9922:9938,9962:9975,10354:10367,10393:10404,10497:10510,10654:10667,10695:10732,10920:10941,10966:10991,11512:11560,11617:11628,11636:11658,11795:11818,12535:12571,13034:13053,13209:13222,13282:13291,13363:13372,13537:13654,13668:13703,13724:13733,13760:13806,13834:13917,13993:14101,14112:14207,14225:14249,14256:14324,14347:14352,14429:14452,14537:14549,14674:14692,14770:14809,14827:14865,14902:14952,14992:15006,15101:15135,15143:15171,15173:15201,15314:15350,15401:15422,15435:15456,15497:15521,15564:15607,15637:15671,16104:16111,16210:16214,16246:16287,16420:16430,16441:16452,16611:16660,16688:16716,16775:17038,17076:17100,17142:17238,17287:17309,17344:17367,17455:17522,17981:18028,18081:18122,18255:18291,18407:18416,18428:18434,18467:18491,18499:18513,18751:18755,18826:18895,18911:18974,19277:19314,20246:20270,20667:20681,20697:20736,20759:20763,20774:20839,21506:21576,21590:21647 )' = c(-29.999 , 29.999))   # DTL_bd::bd.sol | change = pctchg

# Splitting the parameter boundary table into a list where each element is
# the boundary table for each zone
par_bound_list <- map(zones, ~ select(par_bound_zonal, starts_with(.x)))

# Extract the Sobol parameter set from the Sobol parameter object
par_sobol_tbl <- as_tibble(sobol_sample$X, .name_repair = ~ par_names)

# Apply parameter boundaries to the Sobol parameter set for each
# spatial zone individually
par_sobol <- map(par_bound_list, ~ set_par_range(par_sobol_tbl, .x)) %>%
  map2(., par_bound_list, ~ set_names(.x, names(.y))) %>%
  bind_cols(.)

# Save Sobol sample
saveRDS(sobol_sample, sample_path)

# Running SENSITIVITY ANALYSIS SWAT+ simulations
run_swatplus(project_path = tagus_path,
             output = list(ls_pcp   = define_output(file = 'lsunit_wb',
                                                    variable = 'precip',
                                                    unit = 1:1450),
                           ls_et    = define_output(file = 'lsunit_wb',
                                                    variable = 'et',
                                                    unit = 1:1450),
                           ls_pet    = define_output(file = 'lsunit_wb',
                                                     variable = 'pet',
                                                     unit = 1:1450),
                           ls_surq   = define_output(file = 'lsunit_wb',
                                                     variable = 'surq_gen',
                                                     unit = 1:1450),
                           ls_latq   = define_output(file = 'lsunit_wb',
                                                     variable = 'latq',
                                                     unit = 1:1450),
                           ls_perc   = define_output(file = 'lsunit_wb',
                                                     variable = 'perc',
                                                     unit = 1:1450),
                           ls_sw_init   = define_output(file = 'lsunit_wb',
                                                        variable = 'sw_init',
                                                        unit = 1:1450),
                           ls_sw_end   = define_output(file = 'lsunit_wb',
                                                       variable = 'sw_final',
                                                       unit = 1:1450),
                           ls_snofall   = define_output(file = 'lsunit_wb',
                                                        variable = 'snofall',
                                                        unit = 1:1450),
                           ls_snomlt   = define_output(file = 'lsunit_wb',
                                                       variable = 'snomlt',
                                                       unit = 1:1450),
                           basin_pcp = define_output(file = 'basin_wb',
                                                     variable = "precip",
                                                     unit = 1),
                           basin_et = define_output(file = 'basin_wb',
                                                    variable = 'et',
                                                    unit = 1),
                           basin_wyld = define_output(file = 'basin_wb',
                                                      variable = 'wateryld',
                                                      unit = 1),
                           basin_perco = define_output(file = 'basin_wb',
                                                       variable = 'perc',
                                                       unit = 1),
                           basin_gwflo = define_output(file = 'basin_aqu',
                                                       variable = 'flo',
                                                       unit = 1),
                           basin_aqrch = define_output(file = 'basin_aqu',
                                                       variable = 'rchrg',
                                                       unit = 1),
                           basin_aqstor = define_output(file = 'basin_aqu',
                                                        variable = 'stor',
                                                        unit = 1),
                           aqu_gwflo = define_output(file = 'aquifer',
                                                     variable = 'flo',
                                                     unit = 1:126)
             ),
             parameter = par_sobol,
             run_index = c(2113, 2114),
             start_date = 20050101,
             end_date = 20181231,
             start_date_print = 20100101,
             n_thread = 20,
             output_interval = 'y',
             save_file = 'sim_sobol',
             return_output = F,
             keep_folder = F)





#### 3. Running SOFT CALIBRATION  simulations with SWATPlus R --> Extraction of different variables of the####
#water balance at lsu and basin level, and some aquifer-related variables#


#### 3.1. Running the model by default ####

# Water balanced assessment for the regions
library(SWATplusR)

tagus_path <- "D:/Tagus_model_NEW/tagus_model_ASG/Scenarios/TxtInOut_TAGUS23/" # TxtInOut Folder 


sim_tagus_def <- run_swatplus(project_path = tagus_path, #### Default simulation
                              output = list(ls_pcp   = define_output(file = 'lsunit_wb', 
                                                                     variable = 'precip', 
                                                                     unit = 1:1450),
                                            ls_et    = define_output(file = 'lsunit_wb', 
                                                                     variable = 'et', 
                                                                     unit = 1:1450),
                                            ls_pet    = define_output(file = 'lsunit_wb', 
                                                                      variable = 'pet', 
                                                                      unit = 1:1450),
                                            ls_surq   = define_output(file = 'lsunit_wb', 
                                                                      variable = 'surq_gen', 
                                                                      unit = 1:1450),
                                            ls_latq   = define_output(file = 'lsunit_wb', 
                                                                      variable = 'latq', 
                                                                      unit = 1:1450),
                                            ls_perc   = define_output(file = 'lsunit_wb', 
                                                                      variable = 'perc', 
                                                                      unit = 1:1450),
                                            ls_sw_init   = define_output(file = 'lsunit_wb', 
                                                                         variable = 'sw_init', 
                                                                         unit = 1:1450),
                                            ls_sw_end   = define_output(file = 'lsunit_wb', 
                                                                        variable = 'sw_final', 
                                                                        unit = 1:1450),
                                            ls_snofall   = define_output(file = 'lsunit_wb', 
                                                                         variable = 'snofall', 
                                                                         unit = 1:1450),
                                            ls_snomlt   = define_output(file = 'lsunit_wb', 
                                                                        variable = 'snomlt', 
                                                                        unit = 1:1450),
                                            basin_pcp = define_output(file = 'basin_wb',
                                                                      variable = "precip",
                                                                      unit = 1), 
                                            basin_et = define_output(file = 'basin_wb',
                                                                     variable = 'et',
                                                                     unit = 1), 
                                            basin_wyld = define_output(file = 'basin_wb',
                                                                       variable = 'wateryld',
                                                                       unit = 1),
                                            basin_perco = define_output(file = 'basin_wb',
                                                                        variable = 'perc',
                                                                        unit = 1),
                                            basin_gwflo = define_output(file = 'basin_aqu',
                                                                        variable = 'flo',
                                                                        unit = 1),
                                            basin_aqrch = define_output(file = 'basin_aqu',
                                                                        variable = 'rchrg',
                                                                        unit = 1),
                                            basin_aqstor = define_output(file = 'basin_aqu',
                                                                         variable = 'stor',
                                                                         unit = 1),
                                            aqu_gwflo = define_output(file = 'aquifer',
                                                                      variable = 'flo',
                                                                      unit = 1:126),
                                            aqu_gwflo = define_output(file = 'aquifer',
                                                                      variable = 'stor',
                                                                      unit = 1:126),
                                            aqu_gwflo = define_output(file = 'aquifer',
                                                                      variable = 'rchrg',
                                                                      unit = 1:126)
                              ),
                              parameter = NULL, #### Default simulation
                              start_date = 20050101,
                              end_date = 20181231,
                              start_date_print = 20100101,
                              n_thread = 8,
                              output_interval = 'y')

# Saving the simulations
# write_rds(sim_tagus_def, "D:/Trabajo/Papers/Paper_Soft_calibration/Cal_rounds/def_modelwb_run.rds")


# Default streamflow simulation and Assessment of the aquifers behaviour during the warm-up period

channels_sim_def <- run_swatplus(project_path = tagus_path,
                                 output = list(flow_cha = define_output(file = "channel_sd", 
                                                                        variable = "flo_out",
                                                                        unit = c(561 , 750,  11, 1218, 567,  825,  564,  630,
                                                                                 532 , 962, 990, 541,  950,  149, 376, 535, 537, 1141,
                                                                                 1161, 14,  947, 184,  525,  573, 173, 111, 834,
                                                                                 452, 444, 465, 459, 929, 488, 896, 947, 862)),
                                               aquif_flo = define_output(file = "aquifer",
                                                                         variable = "flo",
                                                                         unit = c(1:126)),
                                               aquif_stor = define_output(file = "aquifer",
                                                                          variable = "stor",
                                                                          unit = c(1:126)),
                                               aquif_rchrg = define_output(file = "aquifer",
                                                                           variable = "rchrg",
                                                                           unit = c(1:126)),
                                               aquif_revap = define_output(file = "aquifer",
                                                                           variable = "revap",
                                                                           unit = c(1:126)),
                                               aquif_seep = define_output(file = "aquifer",
                                                                          variable = "seep",
                                                                          unit = c(1:126)),
                                               aquif_dwt = define_output(file = "aquifer",
                                                                         variable = "dep_wt",
                                                                         unit = c(1:126))),
                                 parameter = NULL,
                                 start_date = 20050101,
                                 end_date = 20181231,
                                 start_date_print = 20050101,
                                 n_thread = 60,
                                 output_interval = 'd')

# write_rds(channels_sim_def, "D:/Trabajo/Papers/Paper_Soft_calibration/Cal_rounds/channels_sim_def.rds")

# Analysing the default model



lsus_reg <- read.csv("Data/csv_files/lsus_configuration.csv") %>% 
  select(lsu_id, Area, region)

lsus_reg %>% group_by(region) %>% summarise(total_area_reg = sum(Area))
lsus_reg %>%  summarise(total_area_basin = sum(Area))


lsus_reg$region <- factor(lsus_reg$region, levels = c("IMP", "CRB", "DTH", "DTL"))
chars_reg <- list()
for(i in 1:length(levels(lsus_reg$region))){
  lsus <-  filter(lsus_reg, region == levels(lsus_reg$region)[i]) %>% .[,1] 
  chars <-c()
  for(n in 1:length(lsus)){ char <-  paste(lsus[n])
  chars <- paste(chars, char, sep = ",")}
  chars_reg[[i]] <- chars  
} 
names(chars_reg) <- levels(lsus_reg$region)

lsus_imp <- (chars_reg[[1]] %>% str_split(., ",") %>% .[[1]] %>% .[-1] %>% as.numeric(.))
lsus_crb <- (chars_reg[[2]] %>% str_split(., ",") %>% .[[1]] %>% .[-1] %>% as.numeric(.))
lsus_dth <- (chars_reg[[3]] %>% str_split(., ",") %>% .[[1]] %>% .[-1] %>% as.numeric(.))
lsus_dtl <- (chars_reg[[4]] %>% str_split(., ",") %>% .[[1]] %>% .[-1] %>% as.numeric(.))

rm(lsus, char, chars, i, n)

sim_tagus_def <- read_rds("Data/Simulations/default_modelwb.rds")


# WB Default results (year scale)

pcp_sel <- grep("ls_pcp", names(sim_tagus_def), value = TRUE)
pcp_list <- sim_tagus_def[pcp_sel]        #Water balance variables for the 1450 hrus: Precipitation        

et_sel <- grep("ls_et", names(sim_tagus_def), value = TRUE)
et_list <- sim_tagus_def[et_sel]        #Water balance variables for the 1450 hrus: Evapotranspiration

pet_sel <- grep("ls_pet", names(sim_tagus_def), value = TRUE)
pet_list <- sim_tagus_def[pet_sel]       #Water balance variables for the 1450 hrus: Potential evapotranspiration  

surq_sel <- grep("ls_surq", names(sim_tagus_def), value = TRUE)
surq_list <- sim_tagus_def[surq_sel]      #Water balance variables for the 1450 hrus: Surface runoff   

latq_sel <- grep("ls_latq", names(sim_tagus_def), value = TRUE)
latq_list <- sim_tagus_def[latq_sel]      #Water balance variables for the 1450 hrus: Lateral flow  

perco_sel <- grep("ls_perc", names(sim_tagus_def), value = TRUE)
perco_list <- sim_tagus_def[perco_sel]     #Water balance variables for the 1450 hrus: Percolation  

swin_sel <- grep("ls_sw_i", names(sim_tagus_def), value = TRUE)
swinit_list <- sim_tagus_def[swin_sel]   #Water balance variables for the 1450 hrus: Initial soil water 

swend_sel <- grep("ls_sw_e", names(sim_tagus_def), value = TRUE)
swend_list <- sim_tagus_def[swend_sel]   #Water balance variables for the 1450 hrus: Final soil water 

snof_sel <- grep("ls_snof", names(sim_tagus_def), value = TRUE)
snofall_list <- sim_tagus_def[snof_sel] #Water balance variables for the 1450 hrus: Snow fall  

snom_sel <- grep("ls_snom", names(sim_tagus_def), value = TRUE)
snomlt_list <- sim_tagus_def[snom_sel]  #Water balance variables for the 1450 hrus: Snow melt 


basinwb_p <- sim_tagus_def$basin_pcp         #Water balance variables for the basin: Precipitation         
basinwb_et <- sim_tagus_def$basin_et         #Water balance variables for the basin: Evapotranspiration 
basinwb_wyld <- sim_tagus_def$basin_wyld     #Water balance variables for the basin: Water yield   
basinwb_perc <- sim_tagus_def$basin_perco    #Water balance variables for the basin: Percolation   
basinwb_gwflo <- sim_tagus_def$basin_gwflo   #Water balance variables for the basin: Groundwater flow    
basinwb_rchrg <- sim_tagus_def$basin_aqrch   #Water balance variables for the basin: Aquifers recharg    
basinwb_gwstor <- sim_tagus_def$basin_aqstor #Water balance variables for the basin: Groundwater storage 


aquiflo_lists <- grep("aqu_gw", names(sim_tagus_def), value = TRUE)
aqui_flo <- sim_tagus_def[aquiflo_lists]     #Aquifer flow for the aquifers  

aquistor_lists <- grep("aqu_st", names(sim_tagus_def), value = TRUE)
aqui_stor <- sim_tagus_def[aquistor_lists]     #Aquifer storage for the aquifers  

aquirchrg_lists <- grep("aqu_rc", names(sim_tagus_def), value = TRUE)
aqui_rechrg <- sim_tagus_def[aquirchrg_lists]     #Aquifer recharge for the aquifers    



#### 3.1.1. Results compilation among regions ####

# IMPERVIOUS REGION WATER BALANCE  IMP
IMP_PCP <- pcp_list[c(lsus_imp)]
IMP_ET <- et_list[c(lsus_imp)]
IMP_PET <- pet_list[c(lsus_imp)]
IMP_SURQ <- surq_list[c(lsus_imp)]
IMP_LATQ <- latq_list[c(lsus_imp)]
IMP_PERCO <- perco_list[c(lsus_imp)]
IMP_SWINI <- swinit_list[c(lsus_imp)]
IMP_SWEND <- swend_list[c(lsus_imp)]
IMP_SNOFAL <- snofall_list[c(lsus_imp)]
IMP_SNOMLT <- snomlt_list[c(lsus_imp)]

# LSUs Variables aggregation for calculating the entire region water balance
imp_lsus_areas <- lsus_reg %>% filter(region == "IMP") %>% mutate(row = seq(1:length(.$lsu_id))) %>% mutate(Area = Area *10000) %>% tibble(.)
area_IMP_region <- lsus_reg %>% filter(region == "IMP") %>% summarise(area_tot = 10000*sum(Area))

#PRECIPITATION AGGREGATION IMP
pcp_imp_reg <- 0
for(i in 1:length(IMP_PCP)){
  pcp_lsu <- IMP_PCP[i]*(imp_lsus_areas$Area[i] / area_IMP_region$area_tot)
  pcp_imp_reg <- pcp_imp_reg + pcp_lsu}

#EVAPOTRANSPIRATION AGGREGATION IMP
et_imp_reg <- 0
for(i in 1:length(IMP_ET)){
  et_lsu <- IMP_ET[i]*(imp_lsus_areas$Area[i] / area_IMP_region$area_tot)
  et_imp_reg <- et_imp_reg + et_lsu}

#POTENTIAL EVAPOTRANSPIRATION AGGREGATION IMP
pet_imp_reg <- 0
for(i in 1:length(IMP_PET)){
  pet_lsu <- IMP_PET[i]*(imp_lsus_areas$Area[i] / area_IMP_region$area_tot)
  pet_imp_reg <- pet_imp_reg + pet_lsu}

#SURFACE RUNOFF AGGREGATION IMP
surq_imp_reg <- 0
for(i in 1:length(IMP_SURQ)){
  surq_lsu <- IMP_SURQ[i]*(imp_lsus_areas$Area[i] / area_IMP_region$area_tot)
  surq_imp_reg <- surq_imp_reg + surq_lsu}

#LATERAL FLOW AGGREGATION IMP
latq_imp_reg <- 0
for(i in 1:length(IMP_LATQ)){
  latq_lsu <- IMP_LATQ[i]*(imp_lsus_areas$Area[i] / area_IMP_region$area_tot)
  latq_imp_reg <- latq_imp_reg + latq_lsu}

#PERCOLATION AGGREGATION IMP
perc_imp_reg <- 0
for(i in 1:length(IMP_PERCO)){
  perc_lsu <- IMP_PERCO[i]*(imp_lsus_areas$Area[i] / area_IMP_region$area_tot)
  perc_imp_reg <- perc_imp_reg + perc_lsu}

#Soil Water Initial FLOW AGGREGATION IMP
swini_imp_reg <- 0
for(i in 1:length(IMP_SWINI)){
  swini_lsu <- IMP_SWINI[i]*(imp_lsus_areas$Area[i] / area_IMP_region$area_tot)
  swini_imp_reg <- swini_imp_reg + swini_lsu}

#Soil Water End AGGREGATION IMP
swend_imp_reg <- 0
for(i in 1:length(IMP_SWEND)){
  swend_lsu <- IMP_SWEND[i]*(imp_lsus_areas$Area[i] / area_IMP_region$area_tot)
  swend_imp_reg <- swend_imp_reg + swend_lsu}

#Snow Fall AGGREGATION IMP
snofall_imp_reg <- 0
for(i in 1:length(IMP_SNOFAL)){
  snofall_lsu <- IMP_SNOFAL[i]*(imp_lsus_areas$Area[i] / area_IMP_region$area_tot)
  snofall_imp_reg <- snofall_imp_reg + snofall_lsu}

#Snow Melt End AGGREGATION IMP
snomelt_imp_reg <- 0
for(i in 1:length(IMP_SNOMLT)){
  snomelt_lsu <- IMP_SNOMLT[i]*(imp_lsus_areas$Area[i] / area_IMP_region$area_tot)
  snomelt_imp_reg <- snomelt_imp_reg + snomelt_lsu}

#WATER YIELD IMP CALCULATION --> **NOTE** that PERCO = Groundwater Flow is assumed
water_yield_imp <- surq_imp_reg + latq_imp_reg + perc_imp_reg

#WATER BALANCE SUMMARY
wb_impervious_region <- tibble(P = pcp_imp_reg, ET = et_imp_reg, PET = pet_imp_reg, SURQ = surq_imp_reg, LATQ = latq_imp_reg, PERC = perc_imp_reg,
                               SWChange = (swend_imp_reg - swini_imp_reg), SNOW_Stor = (snofall_imp_reg - snomelt_imp_reg), WATRYLD = water_yield_imp)


# CARBONATE REGION WATER BALANCE CRB
CRB_PCP <- pcp_list[c(lsus_crb)]
CRB_ET <- et_list[c(lsus_crb)]
CRB_PET <- pet_list[c(lsus_crb)]
CRB_SURQ <- surq_list[c(lsus_crb)]
CRB_LATQ <- latq_list[c(lsus_crb)]
CRB_PERCO <- perco_list[c(lsus_crb)]
CRB_SWINI <- swinit_list[c(lsus_crb)]
CRB_SWEND <- swend_list[c(lsus_crb)]
CRB_SNOFAL <- snofall_list[c(lsus_crb)]
CRB_SNOMLT <- snomlt_list[c(lsus_crb)]

# LSUs Variables aggregation for calculating the entire region water balance
crb_lsus_areas <- lsus_reg %>% filter(region == "CRB") %>% mutate(row = seq(1:length(.$lsu_id))) %>% mutate(Area = Area *10000) %>% tibble(.)
area_CRB_region <- lsus_reg %>% filter(region == "CRB") %>% summarise(area_tot = 10000*sum(Area))

#PRECIPITATION AGGREGATION CRB
pcp_crb_reg <- 0
for(i in 1:length(CRB_PCP)){
  pcp_lsu <- CRB_PCP[i]*(crb_lsus_areas$Area[i] / area_CRB_region$area_tot)
  pcp_crb_reg <- pcp_crb_reg + pcp_lsu}

#EVAPOTRANSPIRATION AGGREGATION CRB
et_crb_reg <- 0
for(i in 1:length(CRB_ET)){
  et_lsu <- CRB_ET[i]*(crb_lsus_areas$Area[i] / area_CRB_region$area_tot)
  et_crb_reg <- et_crb_reg + et_lsu}

#POTENTIAL EVAPOTRANSPIRATION AGGREGATION CRB
pet_crb_reg <- 0
for(i in 1:length(CRB_PET)){
  pet_lsu <- CRB_PET[i]*(crb_lsus_areas$Area[i] / area_CRB_region$area_tot)
  pet_crb_reg <- pet_crb_reg + pet_lsu}

#SURFACE RUNOFF AGGREGATION CRB
surq_crb_reg <- 0
for(i in 1:length(CRB_SURQ)){
  surq_lsu <- CRB_SURQ[i]*(crb_lsus_areas$Area[i] / area_CRB_region$area_tot)
  surq_crb_reg <- surq_crb_reg + surq_lsu}

#LATERAL FLOW AGGREGATION CRB
latq_crb_reg <- 0
for(i in 1:length(CRB_LATQ)){
  latq_lsu <- CRB_LATQ[i]*(crb_lsus_areas$Area[i] / area_CRB_region$area_tot)
  latq_crb_reg <- latq_crb_reg + latq_lsu}

#PERCOLATION AGGREGATION CRB
perc_crb_reg <- 0
for(i in 1:length(CRB_PERCO)){
  perc_lsu <- CRB_PERCO[i]*(crb_lsus_areas$Area[i] / area_CRB_region$area_tot)
  perc_crb_reg <- perc_crb_reg + perc_lsu}

#Soil Water Initial FLOW AGGREGATION CRB
swini_crb_reg <- 0
for(i in 1:length(CRB_SWINI)){
  swini_lsu <- CRB_SWINI[i]*(crb_lsus_areas$Area[i] / area_CRB_region$area_tot)
  swini_crb_reg <- swini_crb_reg + swini_lsu}

#Soil Water End AGGREGATION CRB
swend_crb_reg <- 0
for(i in 1:length(CRB_SWEND)){
  swend_lsu <- CRB_SWEND[i]*(crb_lsus_areas$Area[i] / area_CRB_region$area_tot)
  swend_crb_reg <- swend_crb_reg + swend_lsu}

#Snow Fall AGGREGATION CRB
snofall_crb_reg <- 0
for(i in 1:length(CRB_SNOFAL)){
  snofall_lsu <- CRB_SNOFAL[i]*(crb_lsus_areas$Area[i] / area_CRB_region$area_tot)
  snofall_crb_reg <- snofall_crb_reg + snofall_lsu}

#Snow Melt End AGGREGATION CRB
snomelt_crb_reg <- 0
for(i in 1:length(CRB_SNOMLT)){
  snomelt_lsu <- CRB_SNOMLT[i]*(crb_lsus_areas$Area[i] / area_CRB_region$area_tot)
  snomelt_crb_reg <- snomelt_crb_reg + snomelt_lsu}

#WATER YIELD CRB CALCULATION
water_yield_crb <- surq_crb_reg + latq_crb_reg + perc_crb_reg

#WATER BALANCE SUMMARY
wb_carbonate_region <- tibble(P = pcp_crb_reg, ET = et_crb_reg, PET = pet_crb_reg, SURQ = surq_crb_reg, LATQ = latq_crb_reg,
                              PERC = perc_crb_reg, SWChange = (swend_crb_reg - swini_crb_reg), SNOW_Stor = (snofall_crb_reg - snomelt_crb_reg), WATRYLD = water_yield_crb)


# HIGH PERMEABILITY DETRITAL REGION WATER BALANCE  DTH
DTH_PCP <- pcp_list[c(lsus_dth)]
DTH_ET <- et_list[c(lsus_dth)]
DTH_PET <- pet_list[c(lsus_dth)]
DTH_SURQ <- surq_list[c(lsus_dth)]
DTH_LATQ <- latq_list[c(lsus_dth)]
DTH_PERCO <- perco_list[c(lsus_dth)]
DTH_SWINI <- swinit_list[c(lsus_dth)]
DTH_SWEND <- swend_list[c(lsus_dth)]
DTH_SNOFAL <- snofall_list[c(lsus_dth)]
DTH_SNOMLT <- snomlt_list[c(lsus_dth)]

# LSUs Variables aggregation for calculating the entire region water balance
dth_lsus_areas <- lsus_reg %>% filter(region == "DTH") %>% mutate(row = seq(1:length(.$lsu_id))) %>% mutate(Area = Area *10000) %>% tibble(.)
area_DTH_region <- lsus_reg %>% filter(region == "DTH") %>% summarise(area_tot = 10000*sum(Area))

#PRECIPITATION AGGREGATION DTH
pcp_dth_reg <- 0
for(i in 1:length(DTH_PCP)){
  pcp_lsu <- DTH_PCP[i]*(dth_lsus_areas$Area[i] / area_DTH_region$area_tot)
  pcp_dth_reg <- pcp_dth_reg + pcp_lsu}

#EVAPOTRANSPIRATION AGGREGATION DTH
et_dth_reg <- 0
for(i in 1:length(DTH_ET)){
  et_lsu <- DTH_ET[i]*(dth_lsus_areas$Area[i] / area_DTH_region$area_tot)
  et_dth_reg <- et_dth_reg + et_lsu}

#POTENTIAL EVAPOTRANSPIRATION AGGREGATION DTH
pet_dth_reg <- 0
for(i in 1:length(DTH_PET)){
  pet_lsu <- DTH_PET[i]*(dth_lsus_areas$Area[i] / area_DTH_region$area_tot)
  pet_dth_reg <- pet_dth_reg + pet_lsu}

#SURFACE RUNOFF AGGREGATION DTH
surq_dth_reg <- 0
for(i in 1:length(DTH_SURQ)){
  surq_lsu <- DTH_SURQ[i]*(dth_lsus_areas$Area[i] / area_DTH_region$area_tot)
  surq_dth_reg <- surq_dth_reg + surq_lsu}

#LATERAL FLOW AGGREGATION DTH
latq_dth_reg <- 0
for(i in 1:length(DTH_LATQ)){
  latq_lsu <- DTH_LATQ[i]*(dth_lsus_areas$Area[i] / area_DTH_region$area_tot)
  latq_dth_reg <- latq_dth_reg + latq_lsu}

#PERCOLATION AGGREGATION DTH
perc_dth_reg <- 0
for(i in 1:length(DTH_PERCO)){
  perc_lsu <- DTH_PERCO[i]*(dth_lsus_areas$Area[i] / area_DTH_region$area_tot)
  perc_dth_reg <- perc_dth_reg + perc_lsu}

#Soil Water Initial FLOW AGGREGATION DTH
swini_dth_reg <- 0
for(i in 1:length(DTH_SWINI)){
  swini_lsu <- DTH_SWINI[i]*(dth_lsus_areas$Area[i] / area_DTH_region$area_tot)
  swini_dth_reg <- swini_dth_reg + swini_lsu}

#Soil Water End AGGREGATION DTH
swend_dth_reg <- 0
for(i in 1:length(DTH_SWEND)){
  swend_lsu <- DTH_SWEND[i]*(dth_lsus_areas$Area[i] / area_DTH_region$area_tot)
  swend_dth_reg <- swend_dth_reg + swend_lsu}

#Snow Fall AGGREGATION DTH
snofall_dth_reg <- 0
for(i in 1:length(DTH_SNOFAL)){
  snofall_lsu <- DTH_SNOFAL[i]*(dth_lsus_areas$Area[i] / area_DTH_region$area_tot)
  snofall_dth_reg <- snofall_dth_reg + snofall_lsu}

#Snow Melt End AGGREGATION DTH
snomelt_dth_reg <- 0
for(i in 1:length(DTH_SNOMLT)){
  snomelt_lsu <- DTH_SNOMLT[i]*(dth_lsus_areas$Area[i] / area_DTH_region$area_tot)
  snomelt_dth_reg <- snomelt_dth_reg + snomelt_lsu}

#WATER YIELD DTH CALCULATION
water_yield_dth <- surq_dth_reg + latq_dth_reg + perc_dth_reg

#WATER BALANCE SUMMARY
wb_dth_region <- tibble(P = pcp_dth_reg, ET = et_dth_reg, PET = pet_dth_reg, SURQ = surq_dth_reg, LATQ = latq_dth_reg,
                        PERC = perc_dth_reg, SWChange = (swend_dth_reg - swini_dth_reg), SNOW_Stor = (snofall_dth_reg - snomelt_dth_reg), WATRYLD = water_yield_dth)


# LOW PERMEABILITY DETRITAL REGION WATER BALANCE
DTL_PCP <- pcp_list[c(lsus_dtl)]
DTL_ET <- et_list[c(lsus_dtl)]
DTL_PET <- pet_list[c(lsus_dtl)]
DTL_SURQ <- surq_list[c(lsus_dtl)]
DTL_LATQ <- latq_list[c(lsus_dtl)]
DTL_PERCO <- perco_list[c(lsus_dtl)]
DTL_SWINI <- swinit_list[c(lsus_dtl)]
DTL_SWEND <- swend_list[c(lsus_dtl)]
DTL_SNOFAL <- snofall_list[c(lsus_dtl)]
DTL_SNOMLT <- snomlt_list[c(lsus_dtl)]

# LSUs Variables aggregation for calculating the entire region water balance
dtl_lsus_areas <- lsus_reg %>% filter(region == "DTL") %>% mutate(row = seq(1:length(.$lsu_id))) %>% mutate(Area = Area *10000) %>% tibble(.)
area_DTL_region <- lsus_reg %>% filter(region == "DTL") %>% summarise(area_tot = 10000*sum(Area))

#PRECIPITATION AGGREGATION DTL
pcp_dtl_reg <- 0
for(i in 1:length(DTL_PCP)){
  pcp_lsu <- DTL_PCP[i]*(dtl_lsus_areas$Area[i] / area_DTL_region$area_tot)
  pcp_dtl_reg <- pcp_dtl_reg + pcp_lsu}

#EVAPOTRANSPIRATION AGGREGATION DTL
et_dtl_reg <- 0
for(i in 1:length(DTL_ET)){
  et_lsu <- DTL_ET[i]*(dtl_lsus_areas$Area[i] / area_DTL_region$area_tot)
  et_dtl_reg <- et_dtl_reg + et_lsu}

#POTENTIAL EVAPOTRANSPIRATION AGGREGATION DTL
pet_dtl_reg <- 0
for(i in 1:length(DTL_PET)){
  pet_lsu <- DTL_PET[i]*(dtl_lsus_areas$Area[i] / area_DTL_region$area_tot)
  pet_dtl_reg <- pet_dtl_reg + pet_lsu}

#SURFACE RUNOFF AGGREGATION DTL
surq_dtl_reg <- 0
for(i in 1:length(DTL_SURQ)){
  surq_lsu <- DTL_SURQ[i]*(dtl_lsus_areas$Area[i] / area_DTL_region$area_tot)
  surq_dtl_reg <- surq_dtl_reg + surq_lsu}

#LATERAL FLOW AGGREGATION DTL
latq_dtl_reg <- 0
for(i in 1:length(DTL_LATQ)){
  latq_lsu <- DTL_LATQ[i]*(dtl_lsus_areas$Area[i] / area_DTL_region$area_tot)
  latq_dtl_reg <- latq_dtl_reg + latq_lsu}

#PERCOLATION AGGREGATION DTL
perc_dtl_reg <- 0
for(i in 1:length(DTL_PERCO)){
  perc_lsu <- DTL_PERCO[i]*(dtl_lsus_areas$Area[i] / area_DTL_region$area_tot)
  perc_dtl_reg <- perc_dtl_reg + perc_lsu}

#Soil Water Initial FLOW AGGREGATION DTL
swini_dtl_reg <- 0
for(i in 1:length(DTL_SWINI)){
  swini_lsu <- DTL_SWINI[i]*(dtl_lsus_areas$Area[i] / area_DTL_region$area_tot)
  swini_dtl_reg <- swini_dtl_reg + swini_lsu}

#Soil Water End AGGREGATION DTL
swend_dtl_reg <- 0
for(i in 1:length(DTL_SWEND)){
  swend_lsu <- DTL_SWEND[i]*(dtl_lsus_areas$Area[i] / area_DTL_region$area_tot)
  swend_dtl_reg <- swend_dtl_reg + swend_lsu}

#Snow Fall AGGREGATION DTL
snofall_dtl_reg <- 0
for(i in 1:length(DTL_SNOFAL)){
  snofall_lsu <- DTL_SNOFAL[i]*(dtl_lsus_areas$Area[i] / area_DTL_region$area_tot)
  snofall_dtl_reg <- snofall_dtl_reg + snofall_lsu}

#Snow Melt End AGGREGATION DTL
snomelt_dtl_reg <- 0
for(i in 1:length(DTL_SNOMLT)){
  snomelt_lsu <- DTL_SNOMLT[i]*(dtl_lsus_areas$Area[i] / area_DTL_region$area_tot)
  snomelt_dtl_reg <- snomelt_dtl_reg + snomelt_lsu}

#WATER YIELD DTL CALCULATION
water_yield_dtl <- surq_dtl_reg + latq_dtl_reg + perc_dtl_reg

#WATER BALANCE SUMMARY
wb_dtl_region <- tibble(P = pcp_dtl_reg, ET = et_dtl_reg, PET = pet_dtl_reg, SURQ = surq_dtl_reg, LATQ = latq_dtl_reg,
                        PERC = perc_dtl_reg, SWChange = (swend_dtl_reg - swini_dtl_reg), SNOW_Stor = (snofall_dtl_reg - snomelt_dtl_reg), WATRYLD = water_yield_dtl)  



WBDEF_IMP <- wb_impervious_region %>% mutate(RC = WATRYLD / P, ETR = ET / P, GC = PERC / WATRYLD) %>% .[,c("P", "RC","ETR","GC")] %>% apply(., 2, mean) 
WBDEF_CRB <- wb_carbonate_region  %>% mutate(RC = WATRYLD / P, ETR = ET / P, GC = PERC / WATRYLD) %>% .[,c("P", "RC","ETR","GC")] %>% apply(., 2, mean) 
WBDEF_DTH <- wb_dth_region        %>% mutate(RC = WATRYLD / P, ETR = ET / P, GC = PERC / WATRYLD) %>% .[,c("P", "RC","ETR","GC")] %>% apply(., 2, mean) 
WBDEF_DTL <- wb_dtl_region        %>% mutate(RC = WATRYLD / P, ETR = ET / P, GC = PERC / WATRYLD) %>% .[,c("P", "RC","ETR","GC")] %>% apply(., 2, mean) 


DEF_WB_TIB <-   WBDEF_IMP %>% rbind(WBDEF_CRB) %>% rbind(., WBDEF_DTH) %>% rbind(., WBDEF_DTL) %>% as.data.frame(.) %>% tibble(.) %>% 
  mutate(Region = c("IMP", "CRB", "DTH", "DTL")) %>% .[,c(5, 1:4)] %>% 
  mutate(P = as.integer(P), RC = round(RC, 3), ETR = round(ETR, 3), GC = round(GC, 3))
colnames(DEF_WB_TIB) <- c("Region",  "Precipitation", "Runoff coefficient", "Evapotranspiration rate", "Groundwater contribution")


#### 3.1.2. Aquifers and channels default simulation ####

channels_sim_def <- readRDS("Data/Simulations/default_channels.rds")


# channels simulation

obs_list <- read_rds("Data/Simulations/observed_list.rds") # File with observed streamflow data

channels_sel <- grep("cha", names(channels_sim_def), value = TRUE)
channels <- channels_sim_def[,channels_sel] %>% cbind(date = channels_sim_def$date) %>% filter(., year(date) > 2009)

# Simulated data
#Some of the gauging stations collect the water from more than one channel
navaluenga <-     tibble(date = channels$date, sim_flow = channels$flow_cha_561 + channels$flow_cha_750)

matallana <-      tibble(date = channels$date, sim_flow = channels$flow_cha_11)

villarejo <-      tibble(date = channels$date, sim_flow = channels$flow_cha_1218)

peralejo <-       tibble(date = channels$date, sim_flow = channels$flow_cha_567+ channels$flow_cha_825)

priego_escabas <- tibble(date = channels$date, sim_flow = channels$flow_cha_564)

santa_maria_val <- tibble(date = channels$date, sim_flow = channels$flow_cha_630)

javalera <-       tibble(date = channels$date, sim_flow = channels$flow_cha_532*0.71) # The gauging station it is not at the end of the channel

huete <-          tibble(date = channels$date, sim_flow = channels$flow_cha_962+ channels$flow_cha_990 )

torote <-         tibble(date = channels$date, sim_flow = channels$flow_cha_541)

puebla_nueva <-   tibble(date = channels$date, sim_flow = channels$flow_cha_950)

ventosa <-        tibble(date = channels$date, sim_flow = channels$flow_cha_149+ channels$flow_cha_376)

peraleja <- tibble(date = channels$date, sim_flow =  channels$flow_cha_535+ channels$flow_cha_537 )

villasequilla <-  tibble(date = channels$date, sim_flow = channels$flow_cha_1141+ channels$flow_cha_1161) 

valverde <-       tibble(date = channels$date, sim_flow = channels$flow_cha_14)

malpica <-        tibble(date = channels$date, sim_flow = channels$flow_cha_947)

taravillas <-     tibble(date = channels$date, sim_flow =  channels$flow_cha_184*0.9 )# The gauging station it is not at the end of the channel

romanones <-      tibble(date = channels$date, sim_flow = channels$flow_cha_525)

priego_trabraque <- tibble(date = channels$date, sim_flow = channels$flow_cha_573*0.96 ) # The gauging station it is not at the end of the channel

bujaralo <- tibble(date = channels$date, sim_flow = channels$flow_cha_173)

utrb <- tibble(date = channels$date, sim_flow = channels$flow_cha_834)


# List wih the default simulation of the channels
sim_def_ch_list <- list(navaluenga, matallana, villarejo, peralejo, priego_escabas, santa_maria_val, javalera, huete, torote, puebla_nueva,
                        ventosa, peraleja, villasequilla, valverde, malpica, taravillas, romanones,  priego_trabraque, bujaralo) 

names(sim_def_ch_list) <- names(obs_list)

# Calculating some metrics

nses <- c()
r2_chs <- c()
rmses <- c()
pbias <- c()

for(i in 1:length(sim_def_ch_list)){
  obs <- obs_list[[i]]
  sim <- sim_def_ch_list[[i]]
  
  tib_obsimx <- obs %>% left_join(., sim, "date")
  
  nse <- NSE(tib_obsimx$sim_flow, tib_obsimx$obs_flow)
  r2 <- rsq_r2(tib_obsimx$sim_flow, tib_obsimx$obs_flow)
  rmse <- rmse(tib_obsimx$sim_flow, tib_obsimx$obs_flow)
  pbia <- pbias(tib_obsimx$sim_flow, tib_obsimx$obs_flow)
  
  
  nses <- c(nses, nse)
  r2_chs <- c(r2_chs,r2)
  rmses <- c(rmses,rmse)
  pbias <- c(pbias, pbia)
  
}

subbasins <- c("Navaluenga", "Matallana", "Villarejo de Montalban", "Peralejo de las Truchas", "Priego Escabas", "Santa Maria del Val", 
               "Jabalera", "Huete", "Torote", "La Pueblanueva", "Ventosa", "La Peraleja", "Villasequilla de Yepes", "Valverde de los Arroyos",
               "Malpica", "Taravillas", "Romanones", "Priego Trabraque", "Bujaralo")

tibble(basin = subbasins, nses, r2_chs, rmses, pbias)

def_channels_tib <- tibble(basin = subbasins, nses, r2_chs, rmses, pbias) %>% 
  mutate(iteration = 0, best_nse  = nses,  best_r2 = r2_chs, 
         best_pbias = pbias, best_rmse =rmses, median_nse = nses,
         median_r2 = r2_chs , median_pbias= pbias, median_rmse = rmses, Basin = basin)

#Aquifers: just to check that the warm up period is large enougth and reach a balance stage

floaq <- grep("aquif_flo", names(channels_sim_def), value = TRUE)
storaq <- grep("aquif_stor", names(channels_sim_def), value = TRUE)
rechrgaq <- grep("aquif_rch", names(channels_sim_def), value = TRUE)
depwtaq <- grep("aquif_d", names(channels_sim_def), value = TRUE)
revapoaq <- grep("aquif_rev", names(channels_sim_def), value = TRUE)
seepaq <- grep("aquif_se", names(channels_sim_def), value = TRUE)



floaqu_tib <- channels_sim_def[,floaq] %>% apply(., 1, max) %>% tibble(date =channels_sim_def$date, gwflo = .)
storqu_tib <- channels_sim_def[,storaq] %>% apply(., 1, min) %>% tibble(date =channels_sim_def$date, stor = .)
rchrgaqu_tib <- channels_sim_def[,rechrgaq] %>% apply(., 1, max) %>% tibble(date =channels_sim_def$date, rchrg = .)
wtaqu_tib <- channels_sim_def[,depwtaq] %>% apply(., 1, mean) %>% tibble(date =channels_sim_def$date, depwt = .)
revapaqu_tib <- channels_sim_def[,revapoaq] %>% apply(., 1, mean) %>% tibble(date =channels_sim_def$date, revap = .)
seepaqu_tib <- channels_sim_def[,seepaq] %>% apply(., 1, mean) %>% tibble(date =channels_sim_def$date, seep = .)


floaqu_tib %>% left_join(., storqu_tib, "date") %>% 
  left_join(., rchrgaqu_tib, "date") %>% 
  left_join(., wtaqu_tib, "date") %>% 
  left_join(., revapaqu_tib, "date") %>% 
  left_join(., seepaqu_tib, "date") %>% 
  ggplot(., aes(x = date))+
  geom_line(aes(y = rchrg), color = "green")+
  geom_line(aes(y = stor /1000), color = "brown")+
  geom_line(aes(y = seep), color = "red")+
  geom_line(aes(y = revap  ), color = "red")+
  geom_line(aes(y = gwflo    ), color = "steelblue")#+
  geom_line(aes(y = depwt    ), color = "yellow")
  
  # Water level and storage is constant, so the warm up period is ok



#### 4. SENSITIVITY ANALYSIS RESULTS ####


#### 4.1 Loading and aggregating simulations ####

  # Load required R packages 
  library(SWATplusR)
  
  # Paths
  # Paths to the data bases with saved simulation results (AVAILABLE IN ZENODO REPOSITORY)
  sim_path <- c('./Data/SA_DATA/sim_raw/sim_sobol0',
                './Data/SA_DATA/sim_raw/sim_sobol1')
  
  # Path to save extracted output variables
  save_path <- './Data/SA_DATA/var_extract'
  
  # Extract output variables
  # Extract and save ET
  ls_et <- load_swat_run(sim_path, variable = paste('ls_et', 1:1450, sep = '_'))
  write_rds(ls_et, paste0(save_path, '/ls_et.rds'))
  
  # Extract and save pcp (precipitation)
  ls_pcp <- load_swat_run(sim_path, variable = paste('ls_pcp', 1:1450, sep = '_'))
  write_rds(ls_pcp, paste0(save_path, '/ls_pcp.rds'))
  
  # Extract and save surq (surface runoff)
  ls_surq <- load_swat_run(sim_path, variable = paste('ls_surq', 1:1450, sep = '_'))
  write_rds(ls_surq, paste0(save_path, '/ls_surq.rds'))
  
  # Extract and save latq (lateral flow)
  ls_latq <- load_swat_run(sim_path, variable = paste('ls_latq', 1:1450, sep = '_'))
  write_rds(ls_latq, paste0(save_path, '/ls_latq.rds'))
  
  # Extract and save perc (percolation)
  ls_perc <- load_swat_run(sim_path, variable = paste('ls_perc', 1:1450, sep = '_'))
  write_rds(ls_perc, paste0(save_path, '/ls_perc.rds'))
  
  
  
  #### 4.2 Sensitivity analysis plotting ####
  
  
  # Load required R packages
  library(tidyverse)
  library(sensitivity)
  library(purrr)
  
  # Function definitions
  # Aggregate simulated time series to average annual values in a matrix where 
  # the rows are the individual simulations and the columns the land scape units.
  aggregate_sim <- function(sim_list, n_sim, n_zone) {
    sim_list %>%
      map(., ~ .x[,2:(n_sim + 1)]) %>%
      map(., ~ as.matrix(.x)) %>%
      map(., ~ apply(.x, 2, mean)) %>%
      reduce(., c) %>%
      matrix(., ncol = n_zone)
  }
  
  # Tell Sobol sensitivity values if not all simulated values are 0 or NA
  tell_if <- function(x, y) {
    if(max(y) > 0 & all(!is.na(y))) {
      tell(x, y)$S$original
    } else {
      c(0)
    }
  }
  
  # Set vector with length n and all NA if vector x is not length n
  set_na_if <- function(x, n) {
    if(length(x) != n) {
      rep(NA, n)
    } else {
      x
    }
  }
  
  # Paths
  var_path  <- './Data/SA_DATA/var_extract'
  aggr_path <- './Data/SA_DATA/var_aggregate'
  par_path  <- './Data/SA_DATA/230414_sobol_sample.rds'
  zone_path <- './Data/SA_DATA/lsus_configuration.csv'
  
  # Aggregate extracted variables to average annual values (Available in ZENODO REPOSITORY)
  et <- readRDS(paste0(var_path, '/ls_et.rds'))
  et <- aggregate_sim(et$simulation, 12000, 1450)
  saveRDS(et, paste0(aggr_path, '/et.rds'))
  
  latq <- readRDS(paste0(var_path, '/ls_latq.rds'))
  latq <- aggregate_sim(latq$simulation, 12000, 1450)
  saveRDS(latq, paste0(aggr_path, '/latq.rds'))
  
  pcp <- readRDS(paste0(var_path, '/ls_pcp.rds'))
  pcp <- aggregate_sim(pcp$simulation, 12000, 1450)
  saveRDS(pcp, paste0(aggr_path, '/pcp.rds'))
  
  perc <- readRDS(paste0(var_path, '/ls_perc.rds'))
  perc <- aggregate_sim(perc$simulation, 12000, 1450)
  saveRDS(perc, paste0(aggr_path, '/perc.rds'))
  
  surq <- readRDS(paste0(var_path, '/ls_perc.rds'))
  surq <- aggregate_sim(surq$simulation, 12000, 1450)
  saveRDS(surq, paste0(aggr_path, '/surq.rds'))
  
  
  # If start from here, load aggregated variables
  et   <- readRDS(paste0(aggr_path, '/et.rds'))
  latq <- readRDS(paste0(aggr_path, '/latq.rds'))
  surq <- readRDS(paste0(aggr_path, '/surq.rds'))
  perc <- readRDS(paste0(aggr_path, '/perc.rds'))
  pcp  <- readRDS(paste0(aggr_path, '/pcp.rds'))
  
  # Calculate ratios
  rc  <- (latq + surq + perc) / pcp
  gc  <- perc / (latq + surq + perc)
  etr <- et / pcp
  
  # Calculate Sobol indices
  # Load Sobol parameter set
  sobol_sample <- readRDS(par_path)
  
  # Calculate Sobol indices for the three ratios in all spatial units
  s_etr <- map(1:1450, ~tell_if(sobol_sample, etr[,.x]))
  s_rc <- map(1:1450, ~tell_if(sobol_sample, rc[,.x]))
  s_gc <- map(1:1450, ~tell_if(sobol_sample, gc[,.x]))
  
  par_names <- c('esco', 'epco', 'cn2', 'awc', 'perco', 'latq_co', 
                 'cn3_swf', 'z_sol', 'k_sol', 'bd_sol')
  
  # Load table with link between spatial unit and geological zone
  lsus_config <- read_csv(zone_path)
  
  # Add the geological zone label to each spatial unit
  s_etr <- s_etr %>%
    map(., ~ set_names(.x, par_names)) %>%
    map_df(., as_tibble_row) %>%
    add_column(., region = lsus_config$region,.before = 1)
  
  s_rc <- s_rc %>%
    map(., ~ set_na_if(.x, length(par_names))) %>%
    map(., ~ set_names(.x, par_names)) %>%
    map_df(., as_tibble_row) %>%
    add_column(., region = lsus_config$region,.before = 1)
  
  s_gc <- s_gc %>%
    map(., ~ set_na_if(.x, length(par_names))) %>%
    map(., ~ set_names(.x, par_names)) %>%
    map_df(., as_tibble_row) %>%
    add_column(., region = lsus_config$region,.before = 1)
  
  # Add column that indicates the ratio type
  s_gc <- mutate(s_gc, metric = 'gc')
  s_rc <- mutate(s_rc, metric = 'rc')
  s_etr <- mutate(s_etr, metric = 'etr')
  
  # Bind all tables together to one Sobol index table for plotting
  s <- bind_rows(s_rc, s_gc, s_etr) %>%
    pivot_longer(., cols = - c(region, metric))
  
  # Sensitivities for 'etr' were excluded in the final version as 
  # the information is redundant to the other two ratios,
  s <- filter(s, metric != 'etr')
  
  
  # Plotting of SA results
  # Arrange parameter order and labels for plotting
  par_levels <- c('esco', 'epco', 'cn2', 'cn3_swf', 'latq_co', 'awc', 'k_sol', 
                  'bd_sol', 'z_sol', 'perco')
  par_labels <- c('esco', 'epco', 'cn2', 'cn3_swf', 'latq_co', 'awc', 'soil_k', 
                  'soil_bd', 'soil_z', 'perco')
  
  # Prepare labels of rebrions and ratios for plotting
  s <- mutate(s, 
              region = factor(region, levels = c('IMP', 'CRB', 'DTH', 'DTL'), 
                              labels = c('Impervious region (IMP)', 'Carbonate region (CRB)',
                                         'Highly permeable detrital region (DTH)',
                                         'Low permeability detrital region (DTL)')) %>% 
                fct_rev(.),
              name   = factor(name, levels = par_levels, labels = par_labels) %>% fct_rev(.),
              metric = factor(metric, levels = c('rc', 'gc'), 
                              labels = c('Runoff coefficient (RC)', 
                                         'Groundwater contribution (GC)')))
  
  
  # Plotting of results
  gg <- ggplot(s) +
    geom_boxplot(aes(x = name, y = value, fill = region), outlier.color = 'grey20', 
                 outlier.fill = 'grey50', outlier.alpha = 0.25) +
    geom_hline(yintercept = 0, linetype = 'dotted') +
    coord_flip(ylim = c(0, 0.8)) +
    scale_fill_manual(values = c("gray57","goldenrod2","lightskyblue","firebrick3")) +
    guides(fill=guide_legend(ncol=2, reverse = TRUE)) +
    theme_bw() +
    theme(legend.position = 'bottom') +
    labs(y    = 'First order Sobol sensitivity index (-)', 
         x    = 'Parameter', 
         fill = 'Region') +
    facet_grid(cols = vars(metric))
  
  ggsave('./Tagus_SA/sobol_fosi_regions_rc_gc.png', 
         plot = gg, width = 750, height = 750, 
         units = 'px', scale = 6, dpi = 600)
  
  
  
#### 5. SOFT CALIBRATION RESULTS ####

#### 5.1. ROUND 1 ####

# This section also apply for rounds 2 and 3, but changing the parameters set (see section 2.1)

library(SWATplusR)

  
  # Example of simulation run with SWATplusR
  # TxtInOut folder
tagus_path <- "D:/Tagus_model_NEW/tagus_model_ASG/Scenarios/TxtInOut_TAGUS23/"


sim_tagus_r1 <- run_swatplus(project_path = tagus_path,
                             output = list(ls_pcp   = define_output(file = 'lsunit_wb', 
                                                                    variable = 'precip', 
                                                                    unit = 1:1450),
                                           ls_et    = define_output(file = 'lsunit_wb', 
                                                                    variable = 'et', 
                                                                    unit = 1:1450),
                                           ls_pet    = define_output(file = 'lsunit_wb', 
                                                                     variable = 'pet', 
                                                                     unit = 1:1450),
                                           ls_surq   = define_output(file = 'lsunit_wb', 
                                                                     variable = 'surq_gen', 
                                                                     unit = 1:1450),
                                           ls_latq   = define_output(file = 'lsunit_wb', 
                                                                     variable = 'latq', 
                                                                     unit = 1:1450),
                                           ls_perc   = define_output(file = 'lsunit_wb', 
                                                                     variable = 'perc', 
                                                                     unit = 1:1450),
                                           ls_sw_init   = define_output(file = 'lsunit_wb', 
                                                                        variable = 'sw_init', 
                                                                        unit = 1:1450),
                                           ls_sw_end   = define_output(file = 'lsunit_wb', 
                                                                       variable = 'sw_final', 
                                                                       unit = 1:1450),
                                           ls_snofall   = define_output(file = 'lsunit_wb', 
                                                                        variable = 'snofall', 
                                                                        unit = 1:1450),
                                           ls_snomlt   = define_output(file = 'lsunit_wb', 
                                                                       variable = 'snomlt', 
                                                                       unit = 1:1450),
                                           basin_pcp = define_output(file = 'basin_wb',
                                                                     variable = "precip",
                                                                     unit = 1), 
                                           basin_et = define_output(file = 'basin_wb',
                                                                    variable = 'et',
                                                                    unit = 1), 
                                           basin_wyld = define_output(file = 'basin_wb',
                                                                      variable = 'wateryld',
                                                                      unit = 1),
                                           basin_perco = define_output(file = 'basin_wb',
                                                                       variable = 'perc',
                                                                       unit = 1),
                                           basin_gwflo = define_output(file = 'basin_aqu',
                                                                       variable = 'flo',
                                                                       unit = 1),
                                           basin_aqrch = define_output(file = 'basin_aqu',
                                                                       variable = 'rchrg',
                                                                       unit = 1),
                                           basin_aqstor = define_output(file = 'basin_aqu',
                                                                        variable = 'stor',
                                                                        unit = 1),
                                           aqu_gwflo = define_output(file = 'aquifer',
                                                                     variable = 'flo',
                                                                     unit = 1:126),
                                           aqu_stor = define_output(file = 'aquifer',
                                                                    variable = 'stor',
                                                                    unit = 1:126),
                                           aqu_rchrg = define_output(file = 'aquifer',
                                                                     variable = 'rchrg',
                                                                     unit = 1:126)
                             ),
                             parameter = par_zonal_tag,
                             start_date = 20050101,
                             end_date = 20181231,
                             start_date_print = 20100101,
                             n_thread = 8,
                             output_interval = 'y')


 # write_rds(sim_tagus_r1, "C:/ASG/Rondas_tagus_softcal/ronda_1_lsus.rds")


#### 5.1.1. Results extraction ####

# Classification of the lsus regarding geological region

lsus_reg <- read.csv("Data/csv_files/lsus_configuration.csv") %>% 
  select(lsu_id, Area, region)

lsus_reg %>% group_by(region) %>% summarise(total_area_reg = sum(Area))
lsus_reg %>%  summarise(total_area_basin = sum(Area))


lsus_reg$region <- factor(lsus_reg$region, levels = c("IMP", "CRB", "DTH", "DTL"))
chars_reg <- list()
for(i in 1:length(levels(lsus_reg$region))){
  lsus <-  filter(lsus_reg, region == levels(lsus_reg$region)[i]) %>% .[,1] 
  chars <-c()
  for(n in 1:length(lsus)){ char <-  paste(lsus[n])
  chars <- paste(chars, char, sep = ",")}
  chars_reg[[i]] <- chars  
} 
names(chars_reg) <- levels(lsus_reg$region)

lsus_imp <- (chars_reg[[1]] %>% str_split(., ",") %>% .[[1]] %>% .[-1] %>% as.numeric(.))
lsus_crb <- (chars_reg[[2]] %>% str_split(., ",") %>% .[[1]] %>% .[-1] %>% as.numeric(.))
lsus_dth <- (chars_reg[[3]] %>% str_split(., ",") %>% .[[1]] %>% .[-1] %>% as.numeric(.))
lsus_dtl <- (chars_reg[[4]] %>% str_split(., ",") %>% .[[1]] %>% .[-1] %>% as.numeric(.))

rm(lsus, char, chars, i, n)

# Simulation Data import 

# The simulation file is available in ZENODO. Download it to continue

sim_tagus_r1 <- readRDS("Data/Simulations/ronda_1_lsus.rds")

pcp_sel <- grep("ls_pcp", names(sim_tagus_r1$simulation), value = TRUE)
pcp_list <- sim_tagus_r1$simulation[pcp_sel]        #Water balance variables for the 1450 hrus: Precipitation        

et_sel <- grep("ls_et", names(sim_tagus_r1$simulation), value = TRUE)
et_list <- sim_tagus_r1$simulation[et_sel]        #Water balance variables for the 1450 hrus: Evapotranspiration

pet_sel <- grep("ls_pet", names(sim_tagus_r1$simulation), value = TRUE)
pet_list <- sim_tagus_r1$simulation[pet_sel]       #Water balance variables for the 1450 hrus: Potential evapotranspiration  

surq_sel <- grep("ls_surq", names(sim_tagus_r1$simulation), value = TRUE)
surq_list <- sim_tagus_r1$simulation[surq_sel]      #Water balance variables for the 1450 hrus: Surface runoff   

latq_sel <- grep("ls_latq", names(sim_tagus_r1$simulation), value = TRUE)
latq_list <- sim_tagus_r1$simulation[latq_sel]      #Water balance variables for the 1450 hrus: Lateral flow  

perco_sel <- grep("ls_perc", names(sim_tagus_r1$simulation), value = TRUE)
perco_list <- sim_tagus_r1$simulation[perco_sel]     #Water balance variables for the 1450 hrus: Percolation  

swin_sel <- grep("ls_sw_i", names(sim_tagus_r1$simulation), value = TRUE)
swinit_list <- sim_tagus_r1$simulation[swin_sel]   #Water balance variables for the 1450 hrus: Initial soil water 

swend_sel <- grep("ls_sw_e", names(sim_tagus_r1$simulation), value = TRUE)
swend_list <- sim_tagus_r1$simulation[swend_sel]   #Water balance variables for the 1450 hrus: Final soil water 

snof_sel <- grep("ls_snof", names(sim_tagus_r1$simulation), value = TRUE)
snofall_list <- sim_tagus_r1$simulation[snof_sel] #Water balance variables for the 1450 hrus: Snow fall  

snom_sel <- grep("ls_snom", names(sim_tagus_r1$simulation), value = TRUE)
snomlt_list <- sim_tagus_r1$simulation[snom_sel]  #Water balance variables for the 1450 hrus: Snow melt 


basinwb_p <- sim_tagus_r1$simulation$basin_pcp         #Water balance variables for the basin: Precipitation         
basinwb_et <- sim_tagus_r1$simulation$basin_et         #Water balance variables for the basin: Evapotranspiration 
basinwb_wyld <- sim_tagus_r1$simulation$basin_wyld     #Water balance variables for the basin: Water yield   
basinwb_perc <- sim_tagus_r1$simulation$basin_perco    #Water balance variables for the basin: Percolation   
basinwb_gwflo <- sim_tagus_r1$simulation$basin_gwflo   #Water balance variables for the basin: Groundwater flow    
basinwb_rchrg <- sim_tagus_r1$simulation$basin_aqrch   #Water balance variables for the basin: Aquifers recharg    
basinwb_gwstor <- sim_tagus_r1$simulation$basin_aqstor #Water balance variables for the basin: Groundwater storage 


aquiflo_lists <- grep("aqu_gw", names(sim_tagus_r1$simulation), value = TRUE)
aqui_flo <- sim_tagus_r1$simulation[aquiflo_lists]     #Aquifer flow for the aquifers  

aquistor_lists <- grep("aqu_st", names(sim_tagus_r1$simulation), value = TRUE)
aqui_stor <- sim_tagus_r1$simulation[aquistor_lists]     #Aquifer storage for the aquifers  

aquirchrg_lists <- grep("aqu_rc", names(sim_tagus_r1$simulation), value = TRUE)
aqui_rechrg <- sim_tagus_r1$simulation[aquirchrg_lists]     #Aquifer recharge for the aquifers    


# Data compilation among regions

# IMPERVIOUS REGION WATER BALANCE  IMP
IMP_PCP <- pcp_list[c(lsus_imp)]
IMP_ET <- et_list[c(lsus_imp)]
IMP_PET <- pet_list[c(lsus_imp)]
IMP_SURQ <- surq_list[c(lsus_imp)]
IMP_LATQ <- latq_list[c(lsus_imp)]
IMP_PERCO <- perco_list[c(lsus_imp)]
IMP_SWINI <- swinit_list[c(lsus_imp)]
IMP_SWEND <- swend_list[c(lsus_imp)]
IMP_SNOFAL <- snofall_list[c(lsus_imp)]
IMP_SNOMLT <- snomlt_list[c(lsus_imp)]

# LSUs Variables aggregation for calculating the entire region water balance
imp_lsus_areas <- lsus_reg %>% filter(region == "IMP") %>% mutate(row = seq(1:length(.$lsu_id))) %>% mutate(Area = Area *10000) %>% tibble(.)
area_IMP_region <- lsus_reg %>% filter(region == "IMP") %>% summarise(area_tot = 10000*sum(Area))

#PRECIPITATION AGGREGATION IMP
pcp_imp_reg <- 0
for(i in 1:length(IMP_PCP)){
  pcp_lsu <- IMP_PCP[[i]][, -1]*(imp_lsus_areas$Area[i] / area_IMP_region$area_tot)
  pcp_imp_reg <- pcp_imp_reg + pcp_lsu}

#EVAPOTRANSPIRATION AGGREGATION IMP
et_imp_reg <- 0
for(i in 1:length(IMP_ET)){
  et_lsu <- IMP_ET[[i]][, -1]*(imp_lsus_areas$Area[i] / area_IMP_region$area_tot)
  et_imp_reg <- et_imp_reg + et_lsu}

#POTENTIAL EVAPOTRANSPIRATION AGGREGATION IMP
pet_imp_reg <- 0
for(i in 1:length(IMP_PET)){
  pet_lsu <- IMP_PET[[i]][, -1]*(imp_lsus_areas$Area[i] / area_IMP_region$area_tot)
  pet_imp_reg <- pet_imp_reg + pet_lsu}

#SURFACE RUNOFF AGGREGATION IMP
surq_imp_reg <- 0
for(i in 1:length(IMP_SURQ)){
  surq_lsu <- IMP_SURQ[[i]][, -1]*(imp_lsus_areas$Area[i] / area_IMP_region$area_tot)
  surq_imp_reg <- surq_imp_reg + surq_lsu}

#LATERAL FLOW AGGREGATION IMP
latq_imp_reg <- 0
for(i in 1:length(IMP_LATQ)){
  latq_lsu <- IMP_LATQ[[i]][, -1]*(imp_lsus_areas$Area[i] / area_IMP_region$area_tot)
  latq_imp_reg <- latq_imp_reg + latq_lsu}

#PERCOLATION AGGREGATION IMP
perc_imp_reg <- 0
for(i in 1:length(IMP_PERCO)){
  perc_lsu <- IMP_PERCO[[i]][, -1]*(imp_lsus_areas$Area[i] / area_IMP_region$area_tot)
  perc_imp_reg <- perc_imp_reg + perc_lsu}

#Soil Water Initial FLOW AGGREGATION IMP
swini_imp_reg <- 0
for(i in 1:length(IMP_SWINI)){
  swini_lsu <- IMP_SWINI[[i]][, -1]*(imp_lsus_areas$Area[i] / area_IMP_region$area_tot)
  swini_imp_reg <- swini_imp_reg + swini_lsu}

#Soil Water End AGGREGATION IMP
swend_imp_reg <- 0
for(i in 1:length(IMP_SWEND)){
  swend_lsu <- IMP_SWEND[[i]][, -1]*(imp_lsus_areas$Area[i] / area_IMP_region$area_tot)
  swend_imp_reg <- swend_imp_reg + swend_lsu}

#Snow Fall AGGREGATION IMP
snofall_imp_reg <- 0
for(i in 1:length(IMP_SNOFAL)){
  snofall_lsu <- IMP_SNOFAL[[i]][, -1]*(imp_lsus_areas$Area[i] / area_IMP_region$area_tot)
  snofall_imp_reg <- snofall_imp_reg + snofall_lsu}

#Snow Melt End AGGREGATION IMP
snomelt_imp_reg <- 0
for(i in 1:length(IMP_SNOMLT)){
  snomelt_lsu <- IMP_SNOMLT[[i]][, -1]*(imp_lsus_areas$Area[i] / area_IMP_region$area_tot)
  snomelt_imp_reg <- snomelt_imp_reg + snomelt_lsu}

#WATER YIELD IMP CALCULATION --> **NOTE** that PERCO = Groundwater Flow is assumed
water_yield_imp <- surq_imp_reg + latq_imp_reg + perc_imp_reg

#WATER BALANCE SUMMARY
wb_impervious_region <- list(P = pcp_imp_reg, ET = et_imp_reg, PET = pet_imp_reg, SURQ = surq_imp_reg, LATQ = latq_imp_reg, PERC = perc_imp_reg,
                             SWChange = (swend_imp_reg - swini_imp_reg), SNOW_Stor = (snofall_imp_reg - snomelt_imp_reg), WATRYLD = water_yield_imp)


# PARAMETER FOR THIS REGION
IMP_parameters <- list(sim_tagus_r1$parameter$values[,c(1:10)])

#CREATE LIST AND SAVE IT
list_IMP <- c(IMP_parameters, wb_impervious_region)
names(list_IMP)[1] <- c("IMP_parameters")

# write_rds(list_IMP, "Data/Results_WB/imp_region_r1.rds")


# CARBONATE REGION WATER BALANCE CRB
CRB_PCP <- pcp_list[c(lsus_crb)]
CRB_ET <- et_list[c(lsus_crb)]
CRB_PET <- pet_list[c(lsus_crb)]
CRB_SURQ <- surq_list[c(lsus_crb)]
CRB_LATQ <- latq_list[c(lsus_crb)]
CRB_PERCO <- perco_list[c(lsus_crb)]
CRB_SWINI <- swinit_list[c(lsus_crb)]
CRB_SWEND <- swend_list[c(lsus_crb)]
CRB_SNOFAL <- snofall_list[c(lsus_crb)]
CRB_SNOMLT <- snomlt_list[c(lsus_crb)]

# LSUs Variables aggregation for calculating the entire region water balance
crb_lsus_areas <- lsus_reg %>% filter(region == "CRB") %>% mutate(row = seq(1:length(.$lsu_id))) %>% mutate(Area = Area *10000) %>% tibble(.)
area_CRB_region <- lsus_reg %>% filter(region == "CRB") %>% summarise(area_tot = 10000*sum(Area))

#PRECIPITATION AGGREGATION CRB
pcp_crb_reg <- 0
for(i in 1:length(CRB_PCP)){
  pcp_lsu <- CRB_PCP[[i]][, -1]*(crb_lsus_areas$Area[i] / area_CRB_region$area_tot)
  pcp_crb_reg <- pcp_crb_reg + pcp_lsu}

#EVAPOTRANSPIRATION AGGREGATION CRB
et_crb_reg <- 0
for(i in 1:length(CRB_ET)){
  et_lsu <- CRB_ET[[i]][, -1]*(crb_lsus_areas$Area[i] / area_CRB_region$area_tot)
  et_crb_reg <- et_crb_reg + et_lsu}

#POTENTIAL EVAPOTRANSPIRATION AGGREGATION CRB
pet_crb_reg <- 0
for(i in 1:length(CRB_PET)){
  pet_lsu <- CRB_PET[[i]][, -1]*(crb_lsus_areas$Area[i] / area_CRB_region$area_tot)
  pet_crb_reg <- pet_crb_reg + pet_lsu}

#SURFACE RUNOFF AGGREGATION CRB
surq_crb_reg <- 0
for(i in 1:length(CRB_SURQ)){
  surq_lsu <- CRB_SURQ[[i]][, -1]*(crb_lsus_areas$Area[i] / area_CRB_region$area_tot)
  surq_crb_reg <- surq_crb_reg + surq_lsu}

#LATERAL FLOW AGGREGATION CRB
latq_crb_reg <- 0
for(i in 1:length(CRB_LATQ)){
  latq_lsu <- CRB_LATQ[[i]][, -1]*(crb_lsus_areas$Area[i] / area_CRB_region$area_tot)
  latq_crb_reg <- latq_crb_reg + latq_lsu}

#PERCOLATION AGGREGATION CRB
perc_crb_reg <- 0
for(i in 1:length(CRB_PERCO)){
  perc_lsu <- CRB_PERCO[[i]][, -1]*(crb_lsus_areas$Area[i] / area_CRB_region$area_tot)
  perc_crb_reg <- perc_crb_reg + perc_lsu}

#Soil Water Initial FLOW AGGREGATION CRB
swini_crb_reg <- 0
for(i in 1:length(CRB_SWINI)){
  swini_lsu <- CRB_SWINI[[i]][, -1]*(crb_lsus_areas$Area[i] / area_CRB_region$area_tot)
  swini_crb_reg <- swini_crb_reg + swini_lsu}

#Soil Water End AGGREGATION CRB
swend_crb_reg <- 0
for(i in 1:length(CRB_SWEND)){
  swend_lsu <- CRB_SWEND[[i]][, -1]*(crb_lsus_areas$Area[i] / area_CRB_region$area_tot)
  swend_crb_reg <- swend_crb_reg + swend_lsu}

#Snow Fall AGGREGATION CRB
snofall_crb_reg <- 0
for(i in 1:length(CRB_SNOFAL)){
  snofall_lsu <- CRB_SNOFAL[[i]][, -1]*(crb_lsus_areas$Area[i] / area_CRB_region$area_tot)
  snofall_crb_reg <- snofall_crb_reg + snofall_lsu}

#Snow Melt End AGGREGATION CRB
snomelt_crb_reg <- 0
for(i in 1:length(CRB_SNOMLT)){
  snomelt_lsu <- CRB_SNOMLT[[i]][, -1]*(crb_lsus_areas$Area[i] / area_CRB_region$area_tot)
  snomelt_crb_reg <- snomelt_crb_reg + snomelt_lsu}

#WATER YIELD CRB CALCULATION
water_yield_crb <- surq_crb_reg + latq_crb_reg + perc_crb_reg

#WATER BALANCE SUMMARY
wb_carbonate_region <- list(P = pcp_crb_reg, ET = et_crb_reg, PET = pet_crb_reg, SURQ = surq_crb_reg, LATQ = latq_crb_reg,
                            PERC = perc_crb_reg, SWChange = (swend_crb_reg - swini_crb_reg), SNOW_Stor = (snofall_crb_reg - snomelt_crb_reg), WATRYLD = water_yield_crb)


# PARAMETER FOR THIS REGION
CRB_parameters <- list(sim_tagus_r1$parameter$values[,c(11:20)])

#CREATE LIST AND SAVE IT

list_CRB <- c(CRB_parameters, wb_carbonate_region)
names(list_CRB)[1] <- c("CRB_parameters")

# write_rds(list_CRB, "Data/Results_WB/Round_1/crb_region_r1.rds")


#  HIGH PERMEABILITY DETRITAL REGION WATER BALANCE  DTH
DTH_PCP <- pcp_list[c(lsus_dth)]
DTH_ET <- et_list[c(lsus_dth)]
DTH_PET <- pet_list[c(lsus_dth)]
DTH_SURQ <- surq_list[c(lsus_dth)]
DTH_LATQ <- latq_list[c(lsus_dth)]
DTH_PERCO <- perco_list[c(lsus_dth)]
DTH_SWINI <- swinit_list[c(lsus_dth)]
DTH_SWEND <- swend_list[c(lsus_dth)]
DTH_SNOFAL <- snofall_list[c(lsus_dth)]
DTH_SNOMLT <- snomlt_list[c(lsus_dth)]

# LSUs Variables aggregation for calculating the entire region water balance
dth_lsus_areas <- lsus_reg %>% filter(region == "DTH") %>% mutate(row = seq(1:length(.$lsu_id))) %>% mutate(Area = Area *10000) %>% tibble(.)
area_DTH_region <- lsus_reg %>% filter(region == "DTH") %>% summarise(area_tot = 10000*sum(Area))

#PRECIPITATION AGGREGATION DTH
pcp_dth_reg <- 0
for(i in 1:length(DTH_PCP)){
  pcp_lsu <- DTH_PCP[[i]][, -1]*(dth_lsus_areas$Area[i] / area_DTH_region$area_tot)
  pcp_dth_reg <- pcp_dth_reg + pcp_lsu}

#EVAPOTRANSPIRATION AGGREGATION DTH
et_dth_reg <- 0
for(i in 1:length(DTH_ET)){
  et_lsu <- DTH_ET[[i]][, -1]*(dth_lsus_areas$Area[i] / area_DTH_region$area_tot)
  et_dth_reg <- et_dth_reg + et_lsu}

#POTENTIAL EVAPOTRANSPIRATION AGGREGATION DTH
pet_dth_reg <- 0
for(i in 1:length(DTH_PET)){
  pet_lsu <- DTH_PET[[i]][, -1]*(dth_lsus_areas$Area[i] / area_DTH_region$area_tot)
  pet_dth_reg <- pet_dth_reg + pet_lsu}

#SURFACE RUNOFF AGGREGATION DTH
surq_dth_reg <- 0
for(i in 1:length(DTH_SURQ)){
  surq_lsu <- DTH_SURQ[[i]][, -1]*(dth_lsus_areas$Area[i] / area_DTH_region$area_tot)
  surq_dth_reg <- surq_dth_reg + surq_lsu}

#LATERAL FLOW AGGREGATION DTH
latq_dth_reg <- 0
for(i in 1:length(DTH_LATQ)){
  latq_lsu <- DTH_LATQ[[i]][, -1]*(dth_lsus_areas$Area[i] / area_DTH_region$area_tot)
  latq_dth_reg <- latq_dth_reg + latq_lsu}

#PERCOLATION AGGREGATION DTH
perc_dth_reg <- 0
for(i in 1:length(DTH_PERCO)){
  perc_lsu <- DTH_PERCO[[i]][, -1]*(dth_lsus_areas$Area[i] / area_DTH_region$area_tot)
  perc_dth_reg <- perc_dth_reg + perc_lsu}

#Soil Water Initial FLOW AGGREGATION DTH
swini_dth_reg <- 0
for(i in 1:length(DTH_SWINI)){
  swini_lsu <- DTH_SWINI[[i]][, -1]*(dth_lsus_areas$Area[i] / area_DTH_region$area_tot)
  swini_dth_reg <- swini_dth_reg + swini_lsu}

#Soil Water End AGGREGATION DTH
swend_dth_reg <- 0
for(i in 1:length(DTH_SWEND)){
  swend_lsu <- DTH_SWEND[[i]][, -1]*(dth_lsus_areas$Area[i] / area_DTH_region$area_tot)
  swend_dth_reg <- swend_dth_reg + swend_lsu}

#Snow Fall AGGREGATION DTH
snofall_dth_reg <- 0
for(i in 1:length(DTH_SNOFAL)){
  snofall_lsu <- DTH_SNOFAL[[i]][, -1]*(dth_lsus_areas$Area[i] / area_DTH_region$area_tot)
  snofall_dth_reg <- snofall_dth_reg + snofall_lsu}

#Snow Melt End AGGREGATION DTH
snomelt_dth_reg <- 0
for(i in 1:length(DTH_SNOMLT)){
  snomelt_lsu <- DTH_SNOMLT[[i]][, -1]*(dth_lsus_areas$Area[i] / area_DTH_region$area_tot)
  snomelt_dth_reg <- snomelt_dth_reg + snomelt_lsu}

#WATER YIELD DTH CALCULATION
water_yield_dth <- surq_dth_reg + latq_dth_reg + perc_dth_reg

#WATER BALANCE SUMMARY
wb_dth_region <- list(P = pcp_dth_reg, ET = et_dth_reg, PET = pet_dth_reg, SURQ = surq_dth_reg, LATQ = latq_dth_reg,
                      PERC = perc_dth_reg, SWChange = (swend_dth_reg - swini_dth_reg), SNOW_Stor = (snofall_dth_reg - snomelt_dth_reg), WATRYLD = water_yield_dth)


# PARAMETER FOR THIS REGION
DTH_parameters <- list(sim_tagus_r1$parameter$values[,c(21:30)])

#CREATE LIST AND SAVE IT

list_DTH <- c(DTH_parameters, wb_dth_region)
names(list_DTH)[1] <- c("DTH_parameters")

# write_rds(list_DTH, "Data/Results_WB/Round_1/dth_region_r1.rds")


#  LOW PERMEABILITY DETRITAL REGION WATER BALANCE  DTL
DTL_PCP <- pcp_list[c(lsus_dtl)]
DTL_ET <- et_list[c(lsus_dtl)]
DTL_PET <- pet_list[c(lsus_dtl)]
DTL_SURQ <- surq_list[c(lsus_dtl)]
DTL_LATQ <- latq_list[c(lsus_dtl)]
DTL_PERCO <- perco_list[c(lsus_dtl)]
DTL_SWINI <- swinit_list[c(lsus_dtl)]
DTL_SWEND <- swend_list[c(lsus_dtl)]
DTL_SNOFAL <- snofall_list[c(lsus_dtl)]
DTL_SNOMLT <- snomlt_list[c(lsus_dtl)]

# LSUs Variables aggregation for calculating the entire region water balance
dtl_lsus_areas <- lsus_reg %>% filter(region == "DTL") %>% mutate(row = seq(1:length(.$lsu_id))) %>% mutate(Area = Area *10000) %>% tibble(.)
area_DTL_region <- lsus_reg %>% filter(region == "DTL") %>% summarise(area_tot = 10000*sum(Area))

#PRECIPITATION AGGREGATION DTL
pcp_dtl_reg <- 0
for(i in 1:length(DTL_PCP)){
  pcp_lsu <- DTL_PCP[[i]][, -1]*(dtl_lsus_areas$Area[i] / area_DTL_region$area_tot)
  pcp_dtl_reg <- pcp_dtl_reg + pcp_lsu}

#EVAPOTRANSPIRATION AGGREGATION DTL
et_dtl_reg <- 0
for(i in 1:length(DTL_ET)){
  et_lsu <- DTL_ET[[i]][, -1]*(dtl_lsus_areas$Area[i] / area_DTL_region$area_tot)
  et_dtl_reg <- et_dtl_reg + et_lsu}

#POTENTIAL EVAPOTRANSPIRATION AGGREGATION DTL
pet_dtl_reg <- 0
for(i in 1:length(DTL_PET)){
  pet_lsu <- DTL_PET[[i]][, -1]*(dtl_lsus_areas$Area[i] / area_DTL_region$area_tot)
  pet_dtl_reg <- pet_dtl_reg + pet_lsu}

#SURFACE RUNOFF AGGREGATION DTL
surq_dtl_reg <- 0
for(i in 1:length(DTL_SURQ)){
  surq_lsu <- DTL_SURQ[[i]][, -1]*(dtl_lsus_areas$Area[i] / area_DTL_region$area_tot)
  surq_dtl_reg <- surq_dtl_reg + surq_lsu}

#LATERAL FLOW AGGREGATION DTL
latq_dtl_reg <- 0
for(i in 1:length(DTL_LATQ)){
  latq_lsu <- DTL_LATQ[[i]][, -1]*(dtl_lsus_areas$Area[i] / area_DTL_region$area_tot)
  latq_dtl_reg <- latq_dtl_reg + latq_lsu}

#PERCOLATION AGGREGATION DTL
perc_dtl_reg <- 0
for(i in 1:length(DTL_PERCO)){
  perc_lsu <- DTL_PERCO[[i]][, -1]*(dtl_lsus_areas$Area[i] / area_DTL_region$area_tot)
  perc_dtl_reg <- perc_dtl_reg + perc_lsu}

#Soil Water Initial FLOW AGGREGATION DTL
swini_dtl_reg <- 0
for(i in 1:length(DTL_SWINI)){
  swini_lsu <- DTL_SWINI[[i]][, -1]*(dtl_lsus_areas$Area[i] / area_DTL_region$area_tot)
  swini_dtl_reg <- swini_dtl_reg + swini_lsu}

#Soil Water End AGGREGATION DTL
swend_dtl_reg <- 0
for(i in 1:length(DTL_SWEND)){
  swend_lsu <- DTL_SWEND[[i]][, -1]*(dtl_lsus_areas$Area[i] / area_DTL_region$area_tot)
  swend_dtl_reg <- swend_dtl_reg + swend_lsu}

#Snow Fall AGGREGATION DTL
snofall_dtl_reg <- 0
for(i in 1:length(DTL_SNOFAL)){
  snofall_lsu <- DTL_SNOFAL[[i]][, -1]*(dtl_lsus_areas$Area[i] / area_DTL_region$area_tot)
  snofall_dtl_reg <- snofall_dtl_reg + snofall_lsu}

#Snow Melt End AGGREGATION DTL
snomelt_dtl_reg <- 0
for(i in 1:length(DTL_SNOMLT)){
  snomelt_lsu <- DTL_SNOMLT[[i]][, -1]*(dtl_lsus_areas$Area[i] / area_DTL_region$area_tot)
  snomelt_dtl_reg <- snomelt_dtl_reg + snomelt_lsu}

#WATER YIELD DTL CALCULATION
water_yield_dtl <- surq_dtl_reg + latq_dtl_reg + perc_dtl_reg

#WATER BALANCE SUMMARY
wb_dtl_region <- list(P = pcp_dtl_reg, ET = et_dtl_reg, PET = pet_dtl_reg, SURQ = surq_dtl_reg, LATQ = latq_dtl_reg,
                      PERC = perc_dtl_reg, SWChange = (swend_dtl_reg - swini_dtl_reg), SNOW_Stor = (snofall_dtl_reg - snomelt_dtl_reg), WATRYLD = water_yield_dtl)  


# PARAMETER FOR THIS REGION
DTL_parameters <- list(sim_tagus_r1$parameter$values[,c(31:40)])

#CREATE LIST AND SAVE IT

list_DTL <- c(DTL_parameters, wb_dtl_region)
names(list_DTL)[1] <- c("DTL_parameters")

# write_rds(list_DTL, "Data/Results_WB/Round_1/dtl_region_r1.rds")



#### 5.1.2. Results region level: PARAMETERS EFFECT ON RUNOFF AND BASEFLOW RATES ####

# Dotty plot function
plot_dotty <- function(par, crit, crit_label = 'crit', n_col = 4) {
  dotty_tbl <- par %>% 
    mutate(crit = crit) %>% 
    pivot_longer(., cols = -crit, names_to = 'parameter')
  
  ggplot(data = dotty_tbl) +
    geom_point(aes(x = value, y = crit)) + geom_smooth(aes(x = value, y = crit))+
    facet_wrap(. ~ parameter, ncol = 4, scales = "free_x") +
    labs(x = 'Change of parameter value', y = crit_label) +
    theme_bw()
}

# Impervious region

IMP_reg <- read_rds("Data/Results_WB/Round_3/imp_region_r3.rds")
par_IMP  <- IMP_reg[[1]]


# Precipitation

imp_pcp <- IMP_reg$P
imp_pcp_plot <- lapply(imp_pcp, mean) %>% unlist(.) %>% plot_dotty(par_IMP, ., "PCP")


# Water yield

imp_wyld <- (IMP_reg$SURQ + IMP_reg$LATQ + IMP_reg$PERC)
imp_wyld_plot <-  lapply(imp_wyld, mean) %>% unlist(.) %>% plot_dotty(par_IMP, ., "Water Yield")


# Water yield - Precipitation rate

imp_wyld_rt <- imp_wyld / imp_pcp
imp_wyld_rt_plot <- lapply(imp_wyld_rt, mean) %>% unlist(.) %>% plot_dotty(par_IMP, ., "Rate WYLD/P")


# Percolation

imp_perco <- IMP_reg$PERC
imp_perco_plot <- lapply(imp_perco, mean) %>% unlist(.) %>%  plot_dotty(par_IMP, ., "Percolation")


# Percolation - Water yield rate (Baseflow rate)

imp_baseflow_rt <- (IMP_reg$PERC / imp_wyld)
imp_baseflow_rt_plot <- lapply(imp_baseflow_rt, mean) %>% unlist(.) %>%  plot_dotty(par_IMP, ., "Percolation / Water yield")


# Evapotranspiration

imp_et <- IMP_reg$ET
imp_et_plot <- lapply(imp_et, mean) %>% unlist(.) %>% plot_dotty(par_IMP, ., "Evapotranspiration")


# Evapotranspiration - Precipitation rate

imp_et_rate <- imp_et / imp_pcp 
imp_et_rate_plot <- lapply(imp_et_rate, mean) %>% unlist(.) %>% plot_dotty(par_IMP, ., "Evapotranspiration rate")



# Carbonate region

CRB_reg <- read_rds("Data/Results_WB/Round_3/crb_region_r3.rds")
par_CRB  <- CRB_reg[[1]]


# Precipitation

crb_pcp <- CRB_reg$P
crb_pcp_plot <- lapply(crb_pcp, mean) %>% unlist(.) %>% plot_dotty(par_CRB, ., "PCP")


# Water yield

crb_wyld <- (CRB_reg$SURQ + CRB_reg$LATQ + CRB_reg$PERC)
crb_wyld_plot <-  lapply(crb_wyld, mean) %>% unlist(.) %>% plot_dotty(par_CRB, ., "Water Yield")


# Water yield - Precipitation rate

crb_wyld_rt <- crb_wyld / crb_pcp
crb_wyld_rt_plot <- lapply(crb_wyld_rt, mean) %>% unlist(.) %>% plot_dotty(par_CRB, ., "Rate WYLD/P")


# Percolation

crb_perco <- CRB_reg$PERC
crb_perco_plot <- lapply(crb_perco, mean) %>% unlist(.) %>%  plot_dotty(par_CRB, ., "Percolation")


# Percolation - Water yield rate (Baseflow rate)

crb_baseflow_rt <- (CRB_reg$PERC / crb_wyld)
crb_baseflow_rt_plot <- lapply(crb_baseflow_rt, mean) %>% unlist(.) %>%  plot_dotty(par_CRB, ., "Percolation / Water yield")


# Evapotranspiration

crb_et <- CRB_reg$ET
crb_et_plot <- lapply(crb_et, mean) %>% unlist(.) %>% plot_dotty(par_CRB, ., "Evapotranspiration")


# Evapotranspiration - Precipitation rate

crb_et_rate <- crb_et / crb_pcp 
crb_et_rate_plot <- lapply(crb_et_rate, mean) %>% unlist(.) %>% plot_dotty(par_CRB, ., "Evapotranspiration rate")


#  High permeability detrital region

DTH_reg <- read_rds("Data/Results_WB/Round_3/dth_region_r3.rds")
par_DTH  <- DTH_reg[[1]]


# Precipitation

dth_pcp <- DTH_reg$P
dth_pcp_plot <- lapply(dth_pcp, mean) %>% unlist(.) %>% plot_dotty(par_DTH, ., "PCP")


# Water yield

dth_wyld <- (DTH_reg$SURQ + DTH_reg$LATQ + DTH_reg$PERC)
dth_wyld_plot <-  lapply(dth_wyld, mean) %>% unlist(.) %>% plot_dotty(par_DTH, ., "Water Yield")


# Water yield - Precipitation rate

dth_wyld_rt <- dth_wyld / dth_pcp
dth_wyld_rt_plot <- lapply(dth_wyld_rt, mean) %>% unlist(.) %>% plot_dotty(par_DTH, ., "Rate WYLD/P")


# Percolation

dth_perco <- DTH_reg$PERC
dth_perco_plot <- lapply(dth_perco, mean) %>% unlist(.) %>%  plot_dotty(par_DTH, ., "Percolation")


# Percolation - Water yield rate (Baseflow rate)

dth_baseflow_rt <- (DTH_reg$PERC / dth_wyld)
dth_baseflow_rt_plot <- lapply(dth_baseflow_rt, mean) %>% unlist(.) %>%  plot_dotty(par_DTH, ., "Percolation / Water yield")


# Evapotranspiration

dth_et <- DTH_reg$ET
dth_et_plot <- lapply(dth_et, mean) %>% unlist(.) %>% plot_dotty(par_DTH, ., "Evapotranspiration")


# Evapotranspiration - Precipitation rate

dth_et_rate <- dth_et / dth_pcp 
dth_et_rate_plot <- lapply(dth_et_rate, mean) %>% unlist(.) %>% plot_dotty(par_DTH, ., "Evapotranspiration rate")



# Low permeability detrital region (DTL

DTL_reg <- read_rds("Data/Results_WB/Round_3/dtl_region_r3.rds")
par_DTL  <- DTL_reg[[1]]


# Precipitation

dtl_pcp <- DTL_reg$P
dtl_pcp_plot <- lapply(dtl_pcp, mean) %>% unlist(.) %>% plot_dotty(par_DTL, ., "PCP")


# Water yield

dtl_wyld <- (DTL_reg$SURQ + DTL_reg$LATQ + DTL_reg$PERC)
dtl_wyld_plot <-  lapply(dtl_wyld, mean) %>% unlist(.) %>% plot_dotty(par_DTL, ., "Water Yield")


# Water yield - Precipitation rate

dtl_wyld_rt <- dtl_wyld / dtl_pcp
dtl_wyld_rt_plot <- lapply(dtl_wyld_rt, mean) %>% unlist(.) %>% plot_dotty(par_DTL, ., "Rate WYLD/P")

# Percolation

dtl_perco <- DTL_reg$PERC
dtl_perco_plot <- lapply(dtl_perco, mean) %>% unlist(.) %>%  plot_dotty(par_DTL, ., "Percolation")


# Percolation - Water yield rate (Baseflow rate)

dtl_baseflow_rt <- (DTL_reg$PERC / dtl_wyld)
dtl_baseflow_rt_plot <- lapply(dtl_baseflow_rt, mean) %>% unlist(.) %>%  plot_dotty(par_DTL, ., "Percolation / Water yield")


# Evapotranspiration

dtl_et <- DTL_reg$ET
dtl_et_plot <- lapply(dtl_et, mean) %>% unlist(.) %>% plot_dotty(par_DTL, ., "Evapotranspiration")


# Evapotranspiration - Precipitation rate

dtl_et_rate <- dtl_et / dtl_pcp 
dtl_et_rate_plot <- lapply(dtl_et_rate, mean) %>% unlist(.) %>% plot_dotty(par_DTL, ., "Evapotranspiration rate")



#### 5.2 . Channels simulation evaluation and PLOTS ####

# Extracting streamflow simulations for each of the iterations

channels_sim_r1 <- run_swatplus(project_path = tagus_path,
                                 output = list(flow_cha = define_output(file = "channel_sd", 
                                                                        variable = "flo_out",
                                                                        unit = c(561 , 750,  11, 1218, 567,  825,  564,  630,
                                                                                 532 , 962, 990, 541,  950,  149, 376, 535, 537, 1141,
                                                                                 1161, 14,  947, 184,  525,  573, 173, 111, 834,
                                                                                 452, 444, 465, 459, 929, 488, 896, 947, 862))),
                                 parameter = par_bound_zonal_r1,
                                 start_date = 20050101,
                                 end_date = 20181231,
                                 start_date_print = 20100101,
                                 n_thread = 60,
                                 output_interval = 'd')

# write_rds(channels_sim_r1, "C:/ASG/Rondas_tagus_softcal/channels_sim_r1.rds")


# A file was created with the channel simulation for the 3 iterations: channels_all_ordered.rds.
# Available on ZENODO, dowload it to continue


# Simulated data
#Some of the gauging stations collect the water from more than one channel.
# Thus, streamflow data was synthesized and saved in a new file as it follows:

# File with raw  simulations, DOWNLOAD FROM ZENODO

chanels <- read_rds("Data/Simulations/channels_all_ordered.rds")


navaluenga <- tibble(date = chanels$simulation$flow_cha_561$date, chanels$simulation$flow_cha_561[,-1]+ chanels$simulation$flow_cha_750[,-1] )

matallana <-  chanels$simulation$flow_cha_11

villarejo <-  chanels$simulation$flow_cha_1218

peralejo <- tibble(date = chanels$simulation$flow_cha_567$date, chanels$simulation$flow_cha_567[,-1]+ chanels$simulation$flow_cha_825[,-1] )

priego_escabas <- chanels$simulation$flow_cha_564

santa_maria_val <- chanels$simulation$flow_cha_630

javalera <- tibble(date = chanels$simulation$flow_cha_532$date, chanels$simulation$flow_cha_532[,-1]*0.71) # The gauging station it is not at the end of the channel

huete <- tibble(date = chanels$simulation$flow_cha_962$date, chanels$simulation$flow_cha_962[,-1]+ chanels$simulation$flow_cha_990[,-1] )

torote <- chanels$simulation$flow_cha_541

puebla_nueva <-  chanels$simulation$flow_cha_950

ventosa <- tibble(date = chanels$simulation$flow_cha_149$date, chanels$simulation$flow_cha_149[,-1]+ chanels$simulation$flow_cha_376[,-1] )

peraleja <- tibble(date = chanels$simulation$flow_cha_535$date, chanels$simulation$flow_cha_535[,-1]+ chanels$simulation$flow_cha_537[,-1] )

villasequilla <- tibble(date = chanels$simulation$flow_cha_1141$date, chanels$simulation$flow_cha_1141[,-1]+ chanels$simulation$flow_cha_1161[,-1] ) # The gauging station it is not at the end of the channel

valverde <- chanels$simulation$flow_cha_14

malpica <- chanels$simulation$flow_cha_947

taravillas <- tibble(date = chanels$simulation$flow_cha_184$date, chanels$simulation$flow_cha_184[,-1]*0.9 )

romanones <- chanels$simulation$flow_cha_525

priego_trabraque <- tibble(date = chanels$simulation$flow_cha_573$date, chanels$simulation$flow_cha_573[,-1]*0.96 ) # The gauging station it is not at the end of the channel

bujaralo <- chanels$simulation$flow_cha_173

utrb <- chanels$simulation$flow_cha_834


# A list is created and saved for each subbasin
sim_cha_list <- list(navaluenga, matallana, villarejo, peralejo, priego_escabas, santa_maria_val, javalera, huete, torote, puebla_nueva,
                     ventosa, peraleja, villasequilla, valverde, malpica, taravillas, romanones,  priego_trabraque, bujaralo,  utrb) 


# write_rds(sim_cha_list, "Data/Simulations/simulated_list.rds") # Create this file and save it


# A file with observed data was created and saved:

# Observed data for all the gauging stations

obs_flo <- read_rds("Data/Simulations/observed_list.rds")



# Simulated data created

sim_cha_list <- read_rds("Data/Simulations/simulated_list.rds") %>% .[-20]
obs_flo <- read_rds("Data/Simulations/observed_list.rds")


namesim <- names(obs_flo) %>% tibble(.) %>% mutate(namessim = str_sub(., 6,50)) %>% .[,2]

names(sim_cha_list) <- namesim$namessim

# Checking the observed data      
subbasins <- c("Navaluenga", "Matallana", "Villarejo Montalban", "Peralejo Truchas", "Priego Escabas", "Santa Maria del Val", 
               "Jabalera", "Huete", "Torote", "La Pueblanueva", "Ventosa", "La Peraleja", "Villasequilla de Yepes", "Valverde Arroyos",
               "Malpica", "Taravillas", "Romanones", "Priego Trabraque", "Bujaralo")


dats <- c()
for(i in 1:length(obs_flo)){
  dat <-  tibble(obs_flo[[i]][[3]])
  names(dat) <-  c("obs_flow")
  dat <- dat %>% mutate(basin = as.factor(subbasins[i]))
  dats <- rbind(dats, dat)}

obs_plot <- ggplot(dats, aes(x = basin, y = obs_flow ))+ geom_boxplot( )+ facet_wrap(facets = "basin", scales = "free")



# Calculating metrics for all the simulations and for all the rivers 

library(hydroGOF)
rsq_r2 <-  function(x, y , na.rm = TRUE) cor(x, y, use="complete.obs")^2  # Function to calculate R squared


##Loop until line 241


tibs <- list()
stat_list <- list()
nse <- c()
r2_ch <- c()
pbia <- c()
rmse <- c()
nse_mns <- c()
r2_mns <- c()
pbia_mns <- c()
rmse_mns <- c()

nse_bsts <- c()
r2_bsts <- c()
pbia_bsts <- c()
rmse_bsts <- c()



for(i in 1:length(obs_flo)){
  
  sim <- sim_cha_list[[i]]
  obs <- obs_flo[[i]][,c(2,3)]
  
  tibb<- sim %>% left_join(., y = obs, by = "date")%>% mutate(observed = obs_flow) %>% .[,c(1, 3003, 2:3001)]   #Quitamos autom?ticamente para el calculo aquellos d?as que no hay obs por fecha
  tibs[[i]] <- tibb  # Creamos una lista que guarde los 19 conjuntos de 1000 sims + el observado
  
  nses <- c()
  pbias <- c()
  r2_chs <- c()
  rmses <- c()
  for(n in 1:3000){
    nse <- NSE(tibs[[i]][,2+n], tibs[[i]][,2])
    r2_ch <-rsq_r2(tibs[[i]][,2+n], tibs[[i]][,2], na.rm = TRUE)
    pbia <- pbias(tibs[[i]][,2+n], tibs[[i]][,2])
    rmse <- rmse(tibs[[i]][,2+n], tibs[[i]][,2])
    nses <- c(nses, nse)
    r2_chs <- c(r2_chs,r2_ch)
    pbias <- c(pbias, pbia)
    rmses <- c(rmses,rmse)
  }
  
  # mean values to compare with  Default
  nse_mn <- mean(nses)
  r2_mn <- mean(r2_chs)
  pbia_mn <- mean(pbias)
  rmse_mn <- mean(rmses)
  
  nse_mns <- c(nse_mns, nse_mn)
  r2_mns <- c(r2_mns, r2_mn)
  pbia_mns <- c(pbia_mns, pbia_mn)
  rmse_mns <- c(rmse_mns, rmse_mn)
  #
  #bests values to compare with  Default
  nse_bst <- max(nses)
  r2_bst <- max(r2_chs)
  pbia_bst <- min(abs(pbias))
  rmse_bst <- min(rmses)
  
  nse_bsts <- c(nse_bsts, nse_bst)
  r2_bsts <- c(r2_bsts, r2_bst)
  pbia_bsts <- c(pbia_bsts, pbia_bst)
  rmse_bsts <- c(rmse_bsts, rmse_bst)
  
  
  stats <- tibble(run = rep(seq(1,1000, 1), 3),nses, r2_chs, pbias, rmses, iteration = c(rep(1, 1000), rep(2,1000), rep(3,1000)))
  
  stat_list[[i]] <- stats
  
}


#write_rds(stat_list, "Data/Simulations/streamflow_metrics_allsims.rds")


#### VIOLIN PLOTS OF METRICS FOR ALL THE SUBBASINS


stat_list <- read_rds("Data/Simulations/streamflow_metrics_allsims.rds")

plot_l <- list()
for(i in 1:length(stat_list)){
  
  stats <- stat_list[[i]]
  stat_violin <-  stats %>% .[2:6] %>% 
    rename(NSE = nses, "R²" = r2_chs , PBIAS = pbias, RMSE = rmses, Iteration = iteration) %>% 
    pivot_longer(., cols = starts_with(c("r", "n", "p")))  
  
  pllot <- ggplot(stat_violin, aes(y = value, x = Iteration, group = Iteration, fill = Iteration))+geom_violin()+ facet_wrap(facets = vars(name), scales = "free")+
    ggtitle(paste("Subbasin ", i, ": ", subbasins[i]))+ 
    theme_bw()+theme(text = element_text(face = "bold", size = 21),legend.position = "no",
                     axis.title.y = element_blank(), axis.title.x = element_blank(), plot.title = element_text(size = 20))
  plot_l[[i]] <- pllot
  
  #ggsave(plot = pllot, filename =  paste("metrics",i,subbasins[i], sep = "_", ".jpg"),width = 12 , height = 8,
  
  #      path = "C:/Users/Alejandro/Desktop/final_plots_hidrogramas/metrics", device = "jpg")
  
}           


imp_subb <- plot_l[[1]] + plot_l[[2]] + plot_l[[3]]
crb_subb <- plot_l[[4]] + plot_l[[5]] + plot_l[[6]]
dth_subb <- plot_l[[7]] + plot_l[[8]] + plot_l[[9]] + plot_l[[10]]
dtl_subb <- plot_l[[11]] + plot_l[[12]] + plot_l[[13]]
mix_sub1 <- (plot_l[[14]] + plot_l[[15]] + plot_l[[16]] ) 
mix_sub2 <- ( plot_l[[17]] + plot_l[[18]]+ plot_l[[19]])


sum_tab_stats <- c()

for( i in 1:length(subbasins)){
  bas_stats <- stat_list[[i]] %>% group_by(iteration) %>% 
    summarise(best_nse = max(nses),
              best_r2 = max(r2_chs),
              best_pbias = min(abs(pbias )),
              best_rmse = min(rmses),
              
              median_nse = median(nses),
              median_r2 = median(r2_chs),
              median_pbias = median(pbias ),
              median_rmse = median(rmses)) %>% cbind(Basin = paste(subbasins[i]))
  
  
  sum_tab_stats <- sum_tab_stats %>% rbind(bas_stats)
  
}


### Comparison of metrics with defautl simulation

# Default channel simulation

# Aquifers and channels default

channels_sim_def <- readRDS("Data/Simulations/default_channels.rds")


# channels simulation

obs_list <- read_rds("Data/Simulations/observed_list.rds")

channels_sel <- grep("cha", names(channels_sim_def), value = TRUE)
channels <- channels_sim_def[,channels_sel] %>% cbind(date = channels_sim_def$date) %>% filter(., year(date) > 2009)

# Simulated data
#Some of the gauging stations collect the water from more than one channel
navaluenga <-     tibble(date = channels$date, sim_flow = channels$flow_cha_561 + channels$flow_cha_750)

matallana <-      tibble(date = channels$date, sim_flow = channels$flow_cha_11)

villarejo <-      tibble(date = channels$date, sim_flow = channels$flow_cha_1218)

peralejo <-       tibble(date = channels$date, sim_flow = channels$flow_cha_567+ channels$flow_cha_825)

priego_escabas <- tibble(date = channels$date, sim_flow = channels$flow_cha_564)

santa_maria_val <- tibble(date = channels$date, sim_flow = channels$flow_cha_630)

javalera <-       tibble(date = channels$date, sim_flow = channels$flow_cha_532*0.71) # The gauging station it is not at the end of the channel

huete <-          tibble(date = channels$date, sim_flow = channels$flow_cha_962+ channels$flow_cha_990 )

torote <-         tibble(date = channels$date, sim_flow = channels$flow_cha_541)

puebla_nueva <-   tibble(date = channels$date, sim_flow = channels$flow_cha_950)

ventosa <-        tibble(date = channels$date, sim_flow = channels$flow_cha_149+ channels$flow_cha_376)

peraleja <- tibble(date = channels$date, sim_flow =  channels$flow_cha_535+ channels$flow_cha_537 )

villasequilla <-  tibble(date = channels$date, sim_flow = channels$flow_cha_1141+ channels$flow_cha_1161) 

valverde <-       tibble(date = channels$date, sim_flow = channels$flow_cha_14)

malpica <-        tibble(date = channels$date, sim_flow = channels$flow_cha_947)

taravillas <-     tibble(date = channels$date, sim_flow =  channels$flow_cha_184*0.9 )# The gauging station it is not at the end of the channel

romanones <-      tibble(date = channels$date, sim_flow = channels$flow_cha_525)

priego_trabraque <- tibble(date = channels$date, sim_flow = channels$flow_cha_573*0.96 ) # The gauging station it is not at the end of the channel

bujaralo <- tibble(date = channels$date, sim_flow = channels$flow_cha_173)

utrb <- tibble(date = channels$date, sim_flow = channels$flow_cha_834)


# List wih the default simulation of the channels
sim_def_ch_list <- list(navaluenga, matallana, villarejo, peralejo, priego_escabas, santa_maria_val, javalera, huete, torote, puebla_nueva,
                        ventosa, peraleja, villasequilla, valverde, malpica, taravillas, romanones,  priego_trabraque, bujaralo) 

names(sim_def_ch_list) <- names(obs_list)

# Calculating some metrics

nses <- c()
r2_chs <- c()
rmses <- c()
pbias <- c()

for(i in 1:length(sim_def_ch_list)){
  obs <- obs_list[[i]]
  sim <- sim_def_ch_list[[i]]
  
  tib_obsimx <- obs %>% left_join(., sim, "date")
  
  nse <- NSE(tib_obsimx$sim_flow, tib_obsimx$obs_flow)
  r2 <- rsq_r2(tib_obsimx$sim_flow, tib_obsimx$obs_flow)
  rmse <- rmse(tib_obsimx$sim_flow, tib_obsimx$obs_flow)
  pbia <- pbias(tib_obsimx$sim_flow, tib_obsimx$obs_flow)
  
  
  nses <- c(nses, nse)
  r2_chs <- c(r2_chs,r2)
  rmses <- c(rmses,rmse)
  pbias <- c(pbias, pbia)
  
}

subbasins <- c("Navaluenga", "Matallana", "Villarejo de Montalban", "Peralejo de las Truchas", "Priego Escabas", "Santa Maria del Val", 
               "Jabalera", "Huete", "Torote", "La Pueblanueva", "Ventosa", "La Peraleja", "Villasequilla de Yepes", "Valverde de los Arroyos",
               "Malpica", "Taravillas", "Romanones", "Priego Trabraque", "Bujaralo")

tibble(basin = subbasins, nses, r2_chs, rmses, pbias)

def_channels_tib <- tibble(basin = subbasins, nses, r2_chs, rmses, pbias) %>% 
  mutate(iteration = 0, best_nse  = nses,  best_r2 = r2_chs, 
         best_pbias = pbias, best_rmse =rmses, median_nse = nses,
         median_r2 = r2_chs , median_pbias= pbias, median_rmse = rmses, Basin = basin)


def_channels_tib <- def_channels_tib[,-c(1:5)]  


# Basins regions

subbasins <- c("Navaluenga", "Matallana", "Villarejo de Montalban", "Peralejo de las Truchas", "Priego Escabas", "Santa Maria del Val", 
               "Jabalera", "Huete", "Torote", "La Pueblanueva", "Ventosa", "La Peraleja", "Villasequilla de Yepes", "Valverde de los Arroyos",
               "Malpica", "Taravillas", "Romanones", "Priego Trabraque", "Bujaralo")




tib_basinregion <- tibble(subbasins, region = c("IMP","IMP","IMP","CRB","CRB","CRB","DTH","DTH","DTH",
                                                "DTH","DTL","DTL", "DTL","MIX","MIX","MIX","MIX","MIX", "MIX"))

# Metrics subbasins

subbasins <- factor(subbasins, levels = c("Navaluenga", "Matallana", "Villarejo de Montalban", "Peralejo de las Truchas", "Priego Escabas", "Santa Maria del Val", 
                                          "Jabalera", "Huete", "Torote", "La Pueblanueva", "Ventosa", "La Peraleja", "Villasequilla de Yepes", "Valverde de los Arroyos",
                                          "Malpica", "Taravillas", "Romanones", "Priego Trabraque", "Bujaralo"))
# Saving file

sum_tab_stats %>% rbind(def_channels_tib) #%>% 
 # write.csv("Data/csv_files/sum_tab_stats.csv", row.names = F, quote = F)

sum_tab_stats <- read.csv("Data/csv_files/sum_tab_stats.csv")

sum_tab_stats %>% 
  mutate(Basin = factor(Basin, levels = c("Navaluenga","Matallana","Villarejo Montalban","Peralejo Truchas","Priego Escabas","Santa Maria del Val","Jabalera" ,              
                                          "Huete","Torote","La Pueblanueva","Ventosa","La Peraleja","Villasequilla de Yepes",  "Valverde Arroyos" ,      
                                          "Malpica","Taravillas","Romanones","Priego Trabraque","Bujaralo"))) %>%    arrange(., Basin, iteration) %>% 
  .[,c(10,1, 2:9)] %>% mutate(best_nse = round(best_nse, 2), 
                              best_r2 = round(best_r2, 2), 
                              best_pbias = round(best_pbias , 2),
                              best_rmse = round(best_rmse , 2),
                              median_nse = round(median_nse, 2), 
                              median_r2 = round(median_r2, 2), 
                              median_pbias = round(median_pbias , 2),
                              median_rmse = round(median_rmse , 2))  )%>% 
  rename("Iteration" = "iteration", 
         "Best NSE" = "best_nse",
         "Best R²" = "best_r2",
         "Best PBIAS" = "best_pbias",
         "Best RMSE" = "best_rmse",
         "Median NSE" = "median_nse",
         "Median R²" = "median_r2", 
         "Median PBIAS" = "median_pbias", 
         "Median RMSE" = "median_rmse") %>% 
  left_join(., tib_basinregion, c("Basin" = "subbasins")) %>% 
  rename(Region = region)# %>% 
  #write.csv(x = ., file = "Data/csv_files/streamf_simu_metrics.csv", quote =  F, row.names = F)



# Best and median values comparisson among iterations and default simulation

# Streamflow metric saved




bests <- sum_tab_stats %>%#(def_channels_tib) %>% 
  mutate(best_pbias = abs(best_pbias), median_pbias = abs(median_pbias))%>%
  .[,c(10,1,2:5)] %>% pivot_longer(., -c(Basin, iteration), values_to = "Best_values", names_to = "Metric") %>% 
  mutate(as.numeric(iteration)) %>% mutate(Metric = str_remove(Metric, "best_")) %>% 
  left_join(., tib_basinregion, c("Basin" = "subbasins")) %>% 
  mutate(region = factor(region, levels = c("IMP", "CRB", "DTH", "DTL", "MIX"))) %>% group_by(region, iteration, Metric) %>%
  summarise(mean_bests = mean(Best_values))


medians <- sum_tab_stats %>% rbind(def_channels_tib) %>%  mutate(best_pbias = abs(best_pbias), median_pbias = abs(median_pbias)) %>% .[,c(10,1,6:9)]%>% pivot_longer(., -c(Basin, iteration), values_to = "Median_values", names_to = "Metric") %>% 
  mutate(iteration = as.numeric(iteration)) %>% mutate(Metric = str_remove(Metric, "median_")) %>% 
  left_join(., tib_basinregion, c("Basin" = "subbasins")) %>% 
  mutate(region = factor(region, levels = c("IMP", "CRB", "DTH", "DTL", "MIX"))) %>% group_by(region, iteration, Metric) %>% summarise(mean_medians = mean(Median_values))



vect <- c("nse" = "NSE", "r2" = "R²", "pbias" = "PBIAS", "rmse" = "RMSE")


plot_str_sim <- medians %>% left_join(., bests, c("region", "iteration", "Metric")) %>% 
  rename('Median values' = 'mean_medians', 'Best values' = 'mean_bests') %>% 
  pivot_longer(., c('Median values', 'Best values'), names_to = "Statistic") %>% rename(Region = region) %>% 
  ggplot(., aes(x = iteration, y = value, color = Region)) + 
  geom_point(size = 4, aes(shape = Statistic))+  geom_line(linewidth = 1.2, aes(linetype = Statistic))+scale_color_manual(values = c("red", "skyblue", "orange", "grey", "purple"))+
  facet_wrap(facets = "Metric", scales = "free", labeller = labeller(Metric = vect))+theme_bw()+
  scale_x_continuous(labels = c("Initial model", "Iteration 1", "Iteration 2", "Iteration 3"))+
  scale_linetype_manual(values = c(2,1))+ guides(color = guide_legend(override.aes = list(size = 0, linewidth = 3)), 
                                                 shape = guide_legend(override.aes = list(size = 5, linewidth = 0)))+
  theme(axis.title.x = element_blank(), axis.title.y = element_blank())+theme(text = element_text(size = 20),
                                                                              axis.text.x = element_text(size = 15), 
                                                                              legend.text = element_text(size = 18),
                                                                              legend.title = element_text(size = 18))


plot_str_sim



plot_nse_sim <- medians %>% left_join(., bests, c("region", "iteration", "Metric")) %>% 
  filter(Metric == "nse") %>% 
  rename('Median values' = 'mean_medians', 'Best values' = 'mean_bests') %>% 
  pivot_longer(., c('Median values', 'Best values'), names_to = "Statistic") %>% rename(Region = region) %>% 
  ggplot(., aes(x = iteration, y = value, color = Region)) + 
  geom_point(size = 4, aes(shape = Statistic))+  geom_line(linewidth = 1.2, aes(linetype = Statistic))+scale_color_manual(values = c("red", "skyblue", "orange", "grey", "purple"))+
  facet_wrap(facets = "Region", scales = "free", labeller = labeller(Metric = vect))+
  theme_bw()+
  scale_x_continuous(labels = c("Initial model", "Iteration 1", "Iteration 2", "Iteration 3"))+
  scale_linetype_manual(values = c(2,1))+ guides(color = guide_legend(override.aes = list(size = 0, linewidth = 3)), 
                                                 shape = guide_legend(override.aes = list(size = 5, linewidth = 0)))+
  theme(axis.title.x = element_blank(), axis.title.y = element_blank())+theme(text = element_text(size = 20),
                                                                              axis.text.x = element_text(size = 18), 
                                                                              legend.text = element_text(size = 21),
                                                                              legend.title = element_text(size = 21))+
  theme(legend.position = c(0.83, 0.25))



#### 5.3 Parameters evolution plots ####

pars_scal <- read_table("Data/csv_files/par_tab.txt")



pars_scal <- pars_scal %>% rename(region = Region, round = Round, parameter = Parameter)


imppar_plot <- pars_scal %>% mutate(round = as.integer(round),
                                    region = factor(region, levels = c("IMP", "CRB", "DTH", "DTL"))) %>% 
  filter(., region == "IMP") %>% 
  ggplot(aes(x = round))+
  geom_ribbon(aes(ymin = min, ymax = max), alpha = 0.5, fill = "firebrick3") +
  #scale_fill_manual(values = c("red", "blue", "orange", "grey")) +
  scale_x_continuous(breaks = c(1,2,3), labels = c("1", "2", "3"))+
  xlab("Iteration")+  
  facet_wrap(facets = "parameter", scales = "free", ncol = 5)+
  theme_bw()+theme(text = element_text(size = 26), title = element_text(size = 20))+ggtitle("Impervious region (IMP)")

crbpar_plot <- pars_scal %>% mutate(round = as.integer(round),
                                    region = factor(region, levels = c("IMP", "CRB", "DTH", "DTL"))) %>% 
  filter(., region == "CRB") %>% 
  ggplot(aes(x = round))+
  geom_ribbon(aes(ymin = min, ymax = max), alpha = 0.5, fill = "lightskyblue") +
  #scale_fill_manual(values = c("red", "blue", "orange", "grey")) +
  scale_x_continuous(breaks = c(1,2,3), labels = c("1", "2", "3"))+
  xlab("Iteration")+  
  facet_wrap(facets = "parameter", scales = "free", ncol = 5)+
  theme_bw()+theme(text = element_text(size = 26), title = element_text(size = 20))+ggtitle("Carbonate region (CRB)")

dthpar_plot <- pars_scal %>% mutate(round = as.integer(round),
                                    region = factor(region, levels = c("IMP", "CRB", "DTH", "DTL"))) %>% 
  filter(., region == "DTH") %>% 
  ggplot(aes(x = round))+
  geom_ribbon(aes(ymin = min, ymax = max), alpha = 0.5, fill = "goldenrod2") +
  #scale_fill_manual(values = c("red", "blue", "orange", "grey")) +
  scale_x_continuous(breaks = c(1,2,3), labels = c("1", "2", "3"))+
  xlab("Iteration")+  
  facet_wrap(facets = "parameter", scales = "free", ncol = 5)+ 
  theme_bw()+theme(text = element_text(size = 26), title = element_text(size = 20))+ggtitle("High permeability detrital region (DTH)")

dtlpar_plot <- pars_scal %>% mutate(round = as.integer(round),
                                    region = factor(region, levels = c("IMP", "CRB", "DTH", "DTL"))) %>% 
  filter(., region == "DTL") %>% 
  ggplot(aes(x = round))+
  geom_ribbon(aes(ymin = min, ymax = max), alpha = 0.5, fill = "gray57") +
  #scale_fill_manual(values = c("red", "blue", "orange", "grey")) +
  scale_x_continuous(breaks = c(1,2,3), labels = c("1", "2", "3"))+
  xlab("Iteration")+  
  facet_wrap(facets = "parameter", scales = "free", ncol = 5)+
  theme_bw()+theme(text = element_text(size = 26), title = element_text(size = 20))+ggtitle("Low permeability detrital region (DTL)")



par_all_plot <- (imppar_plot + crbpar_plot) / (dthpar_plot + dtlpar_plot)



#### 5.4 Runoff ocefficient and Baseflow contribution evolution ####

# Files created with the data of each simulation

wyld_evolution <- read.csv("Data/csv_files/wyld_evolution_comp.csv")
bflow_evolution <- read.csv("Data/csv_files/bsfl_evolution_comp.csv")



wylds_comp <- wyld_evolution %>% 
  mutate(round = case_when(round == "Round 1" ~ "Iteration 1",
                           round== "Round 2" ~ "Iteration 2",
                           round == "Round 3" ~ "Iteration 3")) %>% 
  pivot_longer(., -c(run, round)) %>% 
  mutate(name = factor(name, levels = c("imp_wyldrate", "crb_wyldrate", "dth_wyldrate", "dtl_wyldrate"),
                       labels = c("Impervious region (IMP)", "Carbonate region (CRB)", "High permeability detrital region (DTH)", "Low permeability detrital region (DTL)"))) %>% 
  mutate(min_wy = case_when(name == 'Impervious region (IMP)' ~ 0.25,
                            name == 'Carbonate region (CRB)' ~ 0.25,
                            name == 'High permeability detrital region (DTH)' ~ 0.04,
                            name == 'Low permeability detrital region (DTL)' ~ 0.01),
         max_wy = case_when(name == 'Impervious region (IMP)' ~ 0.35,
                            name == 'Carbonate region (CRB)' ~ 0.40,
                            name == 'High permeability detrital region (DTH)' ~ 0.10,
                            name == 'Low permeability detrital region (DTL)' ~ 0.04)) %>% 
  ggplot()+
  geom_violin(aes(x = round, y = value, fill = name))+
  scale_fill_manual(values = c("firebrick3","lightskyblue","goldenrod2","gray57"))+
  ylab("Runoff coefficient (perco + surq_gen + latq_gen) / precip")+
  geom_rect(aes(xmin = 0, xmax = 4, ymin = min_wy, ymax = max_wy), 
            color = "chartreuse4", fill = "transparent", linetype = 2, linewidth = 1)+
  facet_wrap(facets = "name", scales = "free")+
  labs(fill = "Geological region")+
  theme_bw()+
  theme(axis.title.x = element_blank(), text = element_text(size = 30), legend.position = "d")



bflow_comp <- bflow_evolution %>% 
  mutate(round = case_when(round == "Round 1" ~ "Iteration 1",
                           round== "Round 2" ~ "Iteration 2",
                           round == "Round 3" ~ "Iteration 3")) %>% 
  pivot_longer(., -c(run, round)) %>% 
  mutate(name = factor(name, levels = c("imp_bsflrate", "crb_bsflrate", "dth_bsflrate", "dtl_bsflrate"),
                       labels = c("Impervious region (IMP)", "Carbonate region (CRB)", 
                                  "High permeability detrital region (DTH)", "Low permeability detrital region (DTL)"))) %>% 
  mutate(min_gc = case_when(name == 'Impervious region (IMP)' ~ 0.10,
                            name == 'Carbonate region (CRB)' ~ 0.30,
                            name == 'High permeability detrital region (DTH)' ~ 0.25,
                            name == 'Low permeability detrital region (DTL)' ~ 0.10),
         max_gc = case_when(name == 'Impervious region (IMP)' ~ 0.20,
                            name == 'Carbonate region (CRB)' ~ 0.60,
                            name == 'High permeability detrital region (DTH)' ~ 0.45,
                            name == 'Low permeability detrital region (DTL)' ~ 0.20)) %>% 
  ggplot()+
  geom_violin(aes(x = round, y = value, fill = name))+
  scale_fill_manual(values = c("firebrick3","lightskyblue","goldenrod2","gray57"))+
  ylab("Groundwater contribution ( perco / (perco + surq_gen + latq_gen) )")+
  geom_rect(aes(xmin = 0, xmax = 4, ymin = min_gc, ymax = max_gc), 
            color = "chartreuse4", fill = "transparent", linetype = 2, linewidth = 1)+
  facet_wrap(facets = "name", scales = "free")+
  labs(fill = "Geological region")+
  theme_bw()+
  theme(axis.title.x = element_blank(), text = element_text(size = 30), title = element_text(size = 28), legend.position = "d")



